2023-02-12 06:03:05.365294: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.365373: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.365380: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   3.3s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t dp gap: 0.1975
  3.46% | time:   1.3s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_v acc: 0.607 (0.613, 0.602) | warm_v dp gap: 0.1414
  6.57% | time:   0.9s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_t acc: 0.682 (0.659, 0.705) | warm_t dp gap: 0.3048
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_v acc: 0.619 (0.621, 0.618) | warm_v dp gap: 0.2799
Epoch 1
 10.03% | time:   1.1s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_t acc: 0.670 (0.651, 0.689) | warm_t dp gap: 0.3093
 10.03% | time:   0.2s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_v acc: 0.640 (0.621, 0.659) | warm_v dp gap: 0.2552
 13.15% | time:   1.0s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_t acc: 0.674 (0.657, 0.691) | warm_t dp gap: 0.3176
 13.15% | time:   0.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_v acc: 0.652 (0.621, 0.683) | warm_v dp gap: 0.2470
Epoch 2
 16.61% | time:   1.2s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_t acc: 0.673 (0.655, 0.691) | warm_t dp gap: 0.3239
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_v acc: 0.648 (0.629, 0.667) | warm_v dp gap: 0.2388
 19.72% | time:   1.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_t acc: 0.673 (0.653, 0.693) | warm_t dp gap: 0.3242
 19.72% | time:   0.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2305
Epoch 3
 23.18% | time:   1.1s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_t acc: 0.668 (0.647, 0.689) | warm_t dp gap: 0.3183
 23.18% | time:   0.2s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_v acc: 0.648 (0.645, 0.650) | warm_v dp gap: 0.2224
 26.30% | time:   1.1s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_t acc: 0.666 (0.647, 0.685) | warm_t dp gap: 0.3223
 26.30% | time:   0.2s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
Epoch 4
 30.10% | time:   1.1s (  0.2m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_t acc: 0.665 (0.643, 0.687) | warm_t dp gap: 0.3039
 30.10% | time:   0.2s (  0.2m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
 33.22% | time:   1.2s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_t acc: 0.665 (0.643, 0.687) | warm_t dp gap: 0.3039
 33.22% | time:   0.2s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
Epoch 5
 36.68% | time:   1.1s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |test acc: 0.667 (0.647, 0.687) | test dp gap: 0.3119
 36.68% | time:   0.2s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |val acc: 0.648 (0.645, 0.650) | val dp gap: 0.2063
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 2] Acc of expected label: 0.670625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 553 labels. Ratio: 0.9493670886075949
 39.79% | time:   3.3s (  0.3m) | step:    115 | train acc: 0.692 | train loss: 0.467 |test acc: 0.663 (0.641, 0.685) | test dp gap: 0.3042
 39.79% | time:   0.2s (  0.3m) | step:    115 | train acc: 0.692 | train loss: 0.467 |val acc: 0.640 (0.653, 0.626) | val dp gap: 0.1737
begin calculating influence
[Strategy 2] Acc of expected label: 0.6515625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
535 labeled samples and 4402 unlabeled samples. Total: 4937
Use 535 samples. Get 571 labels. Ratio: 0.9369527145359019
Epoch 6
 43.25% | time:   2.4s (  0.4m) | step:    125 | train acc: 0.703 | train loss: 0.557 |test acc: 0.691 (0.655, 0.727) | test dp gap: 0.3271
 43.25% | time:   0.2s (  0.4m) | step:    125 | train acc: 0.703 | train loss: 0.557 |val acc: 0.644 (0.637, 0.650) | val dp gap: 0.2798
begin calculating influence
[Strategy 2] Acc of expected label: 0.671875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
567 labeled samples and 4370 unlabeled samples. Total: 4937
Use 567 samples. Get 642 labels. Ratio: 0.883177570093458
 46.37% | time:   2.2s (  0.4m) | step:    134 | train acc: 0.781 | train loss: 0.535 |test acc: 0.690 (0.655, 0.725) | test dp gap: 0.3088
 46.37% | time:   0.1s (  0.4m) | step:    134 | train acc: 0.781 | train loss: 0.535 |val acc: 0.619 (0.637, 0.602) | val dp gap: 0.2635
begin calculating influence
[Strategy 2] Acc of expected label: 0.67625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
599 labeled samples and 4338 unlabeled samples. Total: 4937
Use 599 samples. Get 700 labels. Ratio: 0.8557142857142858
Epoch 7
 49.83% | time:   2.3s (  0.5m) | step:    144 | train acc: 0.723 | train loss: 0.572 |test acc: 0.692 (0.665, 0.719) | test dp gap: 0.2795
 49.83% | time:   0.2s (  0.5m) | step:    144 | train acc: 0.723 | train loss: 0.572 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.2396
begin calculating influence
[Strategy 2] Acc of expected label: 0.678125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
631 labeled samples and 4306 unlabeled samples. Total: 4937
Use 631 samples. Get 761 labels. Ratio: 0.8291721419185283
 52.94% | time:   2.2s (  0.5m) | step:    153 | train acc: 0.801 | train loss: 0.542 |test acc: 0.679 (0.655, 0.703) | test dp gap: 0.2820
 52.94% | time:   0.1s (  0.5m) | step:    153 | train acc: 0.801 | train loss: 0.542 |val acc: 0.628 (0.645, 0.610) | val dp gap: 0.2476
begin calculating influence
[Strategy 2] Acc of expected label: 0.6640625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
663 labeled samples and 4274 unlabeled samples. Total: 4937
Use 663 samples. Get 845 labels. Ratio: 0.7846153846153846
Epoch 8
 56.75% | time:   2.2s (  0.5m) | step:    164 | train acc: 0.801 | train loss: 0.546 |test acc: 0.676 (0.657, 0.695) | test dp gap: 0.2722
 56.75% | time:   0.2s (  0.5m) | step:    164 | train acc: 0.801 | train loss: 0.546 |val acc: 0.619 (0.645, 0.593) | val dp gap: 0.2312
begin calculating influence
[Strategy 2] Acc of expected label: 0.6540625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
694 labeled samples and 4243 unlabeled samples. Total: 4937
Use 694 samples. Get 914 labels. Ratio: 0.7592997811816192
 59.86% | time:   2.1s (  0.6m) | step:    173 | train acc: 0.793 | train loss: 0.542 |test acc: 0.677 (0.655, 0.699) | test dp gap: 0.2819
 59.86% | time:   0.2s (  0.6m) | step:    173 | train acc: 0.793 | train loss: 0.542 |val acc: 0.619 (0.645, 0.593) | val dp gap: 0.2476
begin calculating influence
[Strategy 2] Acc of expected label: 0.645625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
715 labeled samples and 4222 unlabeled samples. Total: 4937
Use 715 samples. Get 977 labels. Ratio: 0.7318321392016377
Epoch 9
 63.32% | time:   2.4s (  0.6m) | step:    183 | train acc: 0.809 | train loss: 0.519 |test acc: 0.682 (0.661, 0.703) | test dp gap: 0.2758
 63.32% | time:   0.1s (  0.6m) | step:    183 | train acc: 0.809 | train loss: 0.519 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.2395
begin calculating influence
[Strategy 2] Acc of expected label: 0.650625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
738 labeled samples and 4199 unlabeled samples. Total: 4937
Use 738 samples. Get 1022 labels. Ratio: 0.7221135029354208
 66.44% | time:   2.2s (  0.7m) | step:    192 | train acc: 0.789 | train loss: 0.529 |test acc: 0.673 (0.667, 0.679) | test dp gap: 0.2661
 66.44% | time:   0.2s (  0.7m) | step:    192 | train acc: 0.789 | train loss: 0.529 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.2231
begin calculating influence
[Strategy 2] Acc of expected label: 0.64375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
749 labeled samples and 4188 unlabeled samples. Total: 4937
Use 749 samples. Get 1048 labels. Ratio: 0.7146946564885496
Epoch 10
 69.90% | time:   1.9s (  0.7m) | step:    202 | train acc: 0.789 | train loss: 0.514 |test acc: 0.677 (0.673, 0.681) | test dp gap: 0.2700
 69.90% | time:   0.2s (  0.7m) | step:    202 | train acc: 0.789 | train loss: 0.514 |val acc: 0.615 (0.621, 0.610) | val dp gap: 0.2071
begin calculating influence
[Strategy 2] Acc of expected label: 0.641875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
766 labeled samples and 4171 unlabeled samples. Total: 4937
Use 766 samples. Get 1093 labels. Ratio: 0.7008234217749314
 73.01% | time:   2.3s (  0.7m) | step:    211 | train acc: 0.758 | train loss: 0.548 |test acc: 0.678 (0.669, 0.687) | test dp gap: 0.2679
 73.01% | time:   0.2s (  0.7m) | step:    211 | train acc: 0.758 | train loss: 0.548 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.2073
begin calculating influence
[Strategy 2] Acc of expected label: 0.631875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
782 labeled samples and 4155 unlabeled samples. Total: 4937
Use 782 samples. Get 1124 labels. Ratio: 0.6957295373665481
Epoch 11
 76.82% | time:   2.2s (  0.8m) | step:    222 | train acc: 0.809 | train loss: 0.491 |test acc: 0.676 (0.661, 0.691) | test dp gap: 0.2603
 76.82% | time:   0.2s (  0.8m) | step:    222 | train acc: 0.809 | train loss: 0.491 |val acc: 0.607 (0.637, 0.577) | val dp gap: 0.2232
begin calculating influence
[Strategy 2] Acc of expected label: 0.6334375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
792 labeled samples and 4145 unlabeled samples. Total: 4937
Use 792 samples. Get 1149 labels. Ratio: 0.6892950391644909
 79.93% | time:   2.0s (  0.8m) | step:    231 | train acc: 0.758 | train loss: 0.532 |test acc: 0.675 (0.665, 0.685) | test dp gap: 0.2539
 79.93% | time:   0.2s (  0.8m) | step:    231 | train acc: 0.758 | train loss: 0.532 |val acc: 0.591 (0.613, 0.569) | val dp gap: 0.1911
begin calculating influence
[Strategy 2] Acc of expected label: 0.631875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
796 labeled samples and 4141 unlabeled samples. Total: 4937
Use 796 samples. Get 1156 labels. Ratio: 0.6885813148788927
Epoch 12
 83.39% | time:   2.1s (  0.9m) | step:    241 | train acc: 0.793 | train loss: 0.490 |test acc: 0.674 (0.659, 0.689) | test dp gap: 0.2639
 83.39% | time:   0.2s (  0.9m) | step:    241 | train acc: 0.793 | train loss: 0.490 |val acc: 0.607 (0.629, 0.585) | val dp gap: 0.1751
begin calculating influence
[Strategy 2] Acc of expected label: 0.63125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
800 labeled samples and 4137 unlabeled samples. Total: 4937
Use 800 samples. Get 1165 labels. Ratio: 0.6866952789699571
 86.51% | time:   2.0s (  0.9m) | step:    250 | train acc: 0.812 | train loss: 0.490 |test acc: 0.678 (0.661, 0.695) | test dp gap: 0.2680
 86.51% | time:   0.2s (  0.9m) | step:    250 | train acc: 0.812 | train loss: 0.490 |val acc: 0.599 (0.621, 0.577) | val dp gap: 0.1750
begin calculating influence
[Strategy 2] Acc of expected label: 0.636875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
805 labeled samples and 4132 unlabeled samples. Total: 4937
Use 805 samples. Get 1174 labels. Ratio: 0.6856899488926746
Epoch 13
 89.97% | time:   2.2s (  0.9m) | step:    260 | train acc: 0.820 | train loss: 0.446 |test acc: 0.670 (0.659, 0.681) | test dp gap: 0.2642
 89.97% | time:   0.2s (  0.9m) | step:    260 | train acc: 0.820 | train loss: 0.446 |val acc: 0.587 (0.605, 0.569) | val dp gap: 0.1991
begin calculating influence
[Strategy 2] Acc of expected label: 0.63625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
815 labeled samples and 4122 unlabeled samples. Total: 4937
Use 815 samples. Get 1196 labels. Ratio: 0.681438127090301
 93.08% | time:   2.0s (  1.0m) | step:    269 | train acc: 0.785 | train loss: 0.476 |test acc: 0.676 (0.663, 0.689) | test dp gap: 0.2675
 93.08% | time:   0.2s (  1.0m) | step:    269 | train acc: 0.785 | train loss: 0.476 |val acc: 0.603 (0.629, 0.577) | val dp gap: 0.1671
begin calculating influence
[Strategy 2] Acc of expected label: 0.62625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
837 labeled samples and 4100 unlabeled samples. Total: 4937
Use 837 samples. Get 1240 labels. Ratio: 0.675
Epoch 14
 96.54% | time:   1.9s (  1.0m) | step:    279 | train acc: 0.750 | train loss: 0.542 |test acc: 0.676 (0.661, 0.691) | test dp gap: 0.2841
 96.54% | time:   0.2s (  1.0m) | step:    279 | train acc: 0.750 | train loss: 0.542 |val acc: 0.595 (0.613, 0.577) | val dp gap: 0.1668
begin calculating influence
[Strategy 2] Acc of expected label: 0.620625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
845 labeled samples and 4092 unlabeled samples. Total: 4937
Use 845 samples. Get 1258 labels. Ratio: 0.6717011128775835
 99.65% | time:   1.6s (  1.0m) | step:    288 | train acc: 0.766 | train loss: 0.503 |test acc: 0.677 (0.659, 0.695) | test dp gap: 0.2741
 99.65% | time:   0.2s (  1.0m) | step:    288 | train acc: 0.766 | train loss: 0.503 |val acc: 0.595 (0.621, 0.569) | val dp gap: 0.1667
begin calculating influence
[Strategy 2] Acc of expected label: 0.6303125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
853 labeled samples and 4084 unlabeled samples. Total: 4937
Use 853 samples. Get 1268 labels. Ratio: 0.6727129337539433
