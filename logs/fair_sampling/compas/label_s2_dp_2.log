2023-02-08 23:09:05.527790: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.527871: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.527878: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.9s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test dp gap: 0.1658
begin calculating influence
selected layers: [Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 2] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   3.3s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val dp gap: 0.1993
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   2.0s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test dp gap: 0.1836
begin calculating influence
[Strategy 2] Acc of expected label: 0.61875
calculating influence -- done
  9.90% | time:   1.2s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val dp gap: 0.1412
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   1.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test dp gap: 0.2182
begin calculating influence
[Strategy 2] Acc of expected label: 0.6203125
calculating influence -- done
 15.10% | time:   1.0s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val dp gap: 0.2303
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.6s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test dp gap: 0.2485
begin calculating influence
[Strategy 2] Acc of expected label: 0.6240625
calculating influence -- done
 19.79% | time:   1.3s (  0.3m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val dp gap: 0.2142
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.9s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test dp gap: 0.2595
begin calculating influence
[Strategy 2] Acc of expected label: 0.62625
calculating influence -- done
 25.00% | time:   1.3s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val dp gap: 0.1895
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.5s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test dp gap: 0.2465
begin calculating influence
[Strategy 2] Acc of expected label: 0.6246875
calculating influence -- done
 29.69% | time:   1.0s (  0.4m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val dp gap: 0.2141
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
541 labeled samples and 4396 unlabeled samples. Total: 4937
Use 541 samples. Get 531 labels. Ratio: 1.0188323917137476
Epoch 3
 34.90% | time:   2.4s (  0.4m) | step:     67 | train acc: 0.703 | train loss: 0.610 |test acc: 0.629 (0.627, 0.631) | test dp gap: 0.2529
begin calculating influence
[Strategy 2] Acc of expected label: 0.6265625
calculating influence -- done
 34.90% | time:   1.1s (  0.4m) | step:     67 | train acc: 0.703 | train loss: 0.610 |val acc: 0.611 (0.653, 0.569) | val dp gap: 0.1978
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
541 labeled samples and 4396 unlabeled samples. Total: 4937
Use 541 samples. Get 531 labels. Ratio: 1.0188323917137476
 39.58% | time:   1.5s (  0.4m) | step:     76 | train acc: 0.738 | train loss: 0.589 |test acc: 0.672 (0.657, 0.687) | test dp gap: 0.2654
begin calculating influence
[Strategy 2] Acc of expected label: 0.6465625
calculating influence -- done
 39.58% | time:   1.2s (  0.5m) | step:     76 | train acc: 0.738 | train loss: 0.589 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.2470
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
543 labeled samples and 4394 unlabeled samples. Total: 4937
Use 543 samples. Get 536 labels. Ratio: 1.0130597014925373
Epoch 4
 45.31% | time:   2.5s (  0.5m) | step:     87 | train acc: 0.719 | train loss: 0.621 |test acc: 0.672 (0.659, 0.685) | test dp gap: 0.2653
begin calculating influence
[Strategy 2] Acc of expected label: 0.6496875
calculating influence -- done
 45.31% | time:   1.2s (  0.5m) | step:     87 | train acc: 0.719 | train loss: 0.621 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2551
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 540 labels. Ratio: 1.0074074074074073
 50.00% | time:   2.2s (  0.6m) | step:     96 | train acc: 0.762 | train loss: 0.565 |test acc: 0.666 (0.653, 0.679) | test dp gap: 0.2696
begin calculating influence
[Strategy 2] Acc of expected label: 0.653125
calculating influence -- done
 50.00% | time:   1.0s (  0.6m) | step:     96 | train acc: 0.762 | train loss: 0.565 |val acc: 0.619 (0.653, 0.585) | val dp gap: 0.2307
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 540 labels. Ratio: 1.0074074074074073
Epoch 5
 55.21% | time:   1.7s (  0.6m) | step:    106 | train acc: 0.703 | train loss: 0.626 |test acc: 0.635 (0.631, 0.639) | test dp gap: 0.2241
begin calculating influence
[Strategy 2] Acc of expected label: 0.6278125
calculating influence -- done
 55.21% | time:   1.2s (  0.6m) | step:    106 | train acc: 0.703 | train loss: 0.626 |val acc: 0.611 (0.645, 0.577) | val dp gap: 0.1980
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 540 labels. Ratio: 1.0074074074074073
 59.90% | time:   1.5s (  0.7m) | step:    115 | train acc: 0.695 | train loss: 0.607 |test acc: 0.666 (0.655, 0.677) | test dp gap: 0.2532
begin calculating influence
[Strategy 2] Acc of expected label: 0.6565625
calculating influence -- done
 59.90% | time:   1.2s (  0.7m) | step:    115 | train acc: 0.695 | train loss: 0.607 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.2470
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
547 labeled samples and 4390 unlabeled samples. Total: 4937
Use 547 samples. Get 548 labels. Ratio: 0.9981751824817519
Epoch 6
 65.10% | time:   2.6s (  0.7m) | step:    125 | train acc: 0.746 | train loss: 0.579 |test acc: 0.664 (0.653, 0.675) | test dp gap: 0.2572
begin calculating influence
[Strategy 2] Acc of expected label: 0.646875
calculating influence -- done
 65.10% | time:   1.1s (  0.7m) | step:    125 | train acc: 0.746 | train loss: 0.579 |val acc: 0.636 (0.669, 0.602) | val dp gap: 0.2309
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
551 labeled samples and 4386 unlabeled samples. Total: 4937
Use 551 samples. Get 569 labels. Ratio: 0.968365553602812
 69.79% | time:   2.4s (  0.8m) | step:    134 | train acc: 0.680 | train loss: 0.605 |test acc: 0.630 (0.631, 0.629) | test dp gap: 0.2259
begin calculating influence
[Strategy 2] Acc of expected label: 0.614375
calculating influence -- done
 69.79% | time:   1.1s (  0.8m) | step:    134 | train acc: 0.680 | train loss: 0.605 |val acc: 0.623 (0.653, 0.593) | val dp gap: 0.1901
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
558 labeled samples and 4379 unlabeled samples. Total: 4937
Use 558 samples. Get 586 labels. Ratio: 0.9522184300341296
Epoch 7
 75.00% | time:   2.6s (  0.8m) | step:    144 | train acc: 0.703 | train loss: 0.589 |test acc: 0.626 (0.622, 0.629) | test dp gap: 0.2140
begin calculating influence
[Strategy 2] Acc of expected label: 0.6078125
calculating influence -- done
 75.00% | time:   1.4s (  0.9m) | step:    144 | train acc: 0.703 | train loss: 0.589 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.1736
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 588 labels. Ratio: 0.9506802721088435
 79.69% | time:   2.3s (  0.9m) | step:    153 | train acc: 0.707 | train loss: 0.605 |test acc: 0.657 (0.651, 0.663) | test dp gap: 0.2549
begin calculating influence
[Strategy 2] Acc of expected label: 0.6496875
calculating influence -- done
 79.69% | time:   0.9s (  0.9m) | step:    153 | train acc: 0.707 | train loss: 0.605 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2229
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
560 labeled samples and 4377 unlabeled samples. Total: 4937
Use 560 samples. Get 592 labels. Ratio: 0.9459459459459459
Epoch 8
 85.42% | time:   1.9s (  0.9m) | step:    164 | train acc: 0.645 | train loss: 0.646 |test acc: 0.628 (0.627, 0.629) | test dp gap: 0.2099
begin calculating influence
[Strategy 2] Acc of expected label: 0.6121875
calculating influence -- done
 85.42% | time:   0.9s (  1.0m) | step:    164 | train acc: 0.645 | train loss: 0.646 |val acc: 0.611 (0.629, 0.593) | val dp gap: 0.1655
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
560 labeled samples and 4377 unlabeled samples. Total: 4937
Use 560 samples. Get 593 labels. Ratio: 0.9443507588532883
 90.10% | time:   1.2s (  1.0m) | step:    173 | train acc: 0.656 | train loss: 0.596 |test acc: 0.660 (0.653, 0.667) | test dp gap: 0.2530
begin calculating influence
[Strategy 2] Acc of expected label: 0.6515625
calculating influence -- done
 90.10% | time:   0.8s (  1.0m) | step:    173 | train acc: 0.656 | train loss: 0.596 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2229
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
560 labeled samples and 4377 unlabeled samples. Total: 4937
Use 560 samples. Get 593 labels. Ratio: 0.9443507588532883
Epoch 9
 95.31% | time:   1.0s (  1.0m) | step:    183 | train acc: 0.730 | train loss: 0.619 |test acc: 0.657 (0.651, 0.663) | test dp gap: 0.2549
begin calculating influence
[Strategy 2] Acc of expected label: 0.646875
calculating influence -- done
 95.31% | time:   0.5s (  1.0m) | step:    183 | train acc: 0.730 | train loss: 0.619 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2229
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
592 labeled samples and 4345 unlabeled samples. Total: 4937
Use 592 samples. Get 595 labels. Ratio: 0.9949579831932773
100.00% | time:   1.1s (  1.0m) | step:    192 | train acc: 0.656 | train loss: 0.614 |test acc: 0.609 (0.622, 0.596) | test dp gap: 0.2109
begin calculating influence
[Strategy 2] Acc of expected label: 0.5996875
calculating influence -- done
100.00% | time:   0.6s (  1.1m) | step:    192 | train acc: 0.656 | train loss: 0.614 |val acc: 0.607 (0.645, 0.569) | val dp gap: 0.1084
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
592 labeled samples and 4345 unlabeled samples. Total: 4937
Use 592 samples. Get 595 labels. Ratio: 0.9949579831932773
