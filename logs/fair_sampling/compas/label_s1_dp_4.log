2023-02-12 06:03:05.450684: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.450765: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.450773: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   3.5s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t dp gap: 0.1975
  3.46% | time:   1.2s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_v acc: 0.607 (0.613, 0.602) | warm_v dp gap: 0.1414
  6.57% | time:   1.1s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_t acc: 0.682 (0.659, 0.705) | warm_t dp gap: 0.3048
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_v acc: 0.619 (0.621, 0.618) | warm_v dp gap: 0.2799
Epoch 1
 10.03% | time:   1.0s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_t acc: 0.670 (0.651, 0.689) | warm_t dp gap: 0.3093
 10.03% | time:   0.2s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_v acc: 0.640 (0.621, 0.659) | warm_v dp gap: 0.2552
 13.15% | time:   1.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_t acc: 0.674 (0.657, 0.691) | warm_t dp gap: 0.3176
 13.15% | time:   0.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_v acc: 0.652 (0.621, 0.683) | warm_v dp gap: 0.2470
Epoch 2
 16.61% | time:   1.1s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_t acc: 0.673 (0.655, 0.691) | warm_t dp gap: 0.3239
 16.61% | time:   0.1s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_v acc: 0.648 (0.629, 0.667) | warm_v dp gap: 0.2388
 19.72% | time:   1.1s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_t acc: 0.673 (0.653, 0.693) | warm_t dp gap: 0.3242
 19.72% | time:   0.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2305
Epoch 3
 23.18% | time:   1.1s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_t acc: 0.668 (0.647, 0.689) | warm_t dp gap: 0.3183
 23.18% | time:   0.2s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_v acc: 0.648 (0.645, 0.650) | warm_v dp gap: 0.2224
 26.30% | time:   1.0s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_t acc: 0.666 (0.647, 0.685) | warm_t dp gap: 0.3223
 26.30% | time:   0.2s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
Epoch 4
 30.10% | time:   1.0s (  0.2m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_t acc: 0.665 (0.643, 0.687) | warm_t dp gap: 0.3039
 30.10% | time:   0.2s (  0.3m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
 33.22% | time:   0.9s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_t acc: 0.665 (0.643, 0.687) | warm_t dp gap: 0.3039
 33.22% | time:   0.2s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_v acc: 0.644 (0.645, 0.642) | warm_v dp gap: 0.2144
Epoch 5
 36.68% | time:   1.0s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |test acc: 0.667 (0.647, 0.687) | test dp gap: 0.3119
 36.68% | time:   0.2s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |val acc: 0.648 (0.645, 0.650) | val dp gap: 0.2063
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 525 labels. Ratio: 1.0
 39.79% | time:   3.4s (  0.3m) | step:    115 | train acc: 0.769 | train loss: 0.461 |test acc: 0.659 (0.643, 0.675) | test dp gap: 0.3085
 39.79% | time:   0.1s (  0.3m) | step:    115 | train acc: 0.769 | train loss: 0.461 |val acc: 0.644 (0.653, 0.634) | val dp gap: 0.1817
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
557 labeled samples and 4380 unlabeled samples. Total: 4937
Use 557 samples. Get 557 labels. Ratio: 1.0
Epoch 6
 43.25% | time:   2.4s (  0.4m) | step:    125 | train acc: 0.676 | train loss: 0.597 |test acc: 0.668 (0.645, 0.691) | test dp gap: 0.3098
 43.25% | time:   0.1s (  0.4m) | step:    125 | train acc: 0.676 | train loss: 0.597 |val acc: 0.656 (0.653, 0.659) | val dp gap: 0.2550
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
589 labeled samples and 4348 unlabeled samples. Total: 4937
Use 589 samples. Get 589 labels. Ratio: 1.0
 46.37% | time:   2.2s (  0.4m) | step:    134 | train acc: 0.691 | train loss: 0.561 |test acc: 0.673 (0.645, 0.701) | test dp gap: 0.3075
 46.37% | time:   0.2s (  0.4m) | step:    134 | train acc: 0.691 | train loss: 0.561 |val acc: 0.660 (0.645, 0.675) | val dp gap: 0.2632
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 621 labels. Ratio: 1.0
Epoch 7
 49.83% | time:   2.2s (  0.5m) | step:    144 | train acc: 0.691 | train loss: 0.592 |test acc: 0.682 (0.647, 0.717) | test dp gap: 0.3255
 49.83% | time:   0.2s (  0.5m) | step:    144 | train acc: 0.691 | train loss: 0.592 |val acc: 0.652 (0.637, 0.667) | val dp gap: 0.2632
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
653 labeled samples and 4284 unlabeled samples. Total: 4937
Use 653 samples. Get 653 labels. Ratio: 1.0
 52.94% | time:   2.1s (  0.5m) | step:    153 | train acc: 0.637 | train loss: 0.640 |test acc: 0.679 (0.645, 0.713) | test dp gap: 0.3236
 52.94% | time:   0.2s (  0.5m) | step:    153 | train acc: 0.637 | train loss: 0.640 |val acc: 0.652 (0.653, 0.650) | val dp gap: 0.2631
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
685 labeled samples and 4252 unlabeled samples. Total: 4937
Use 685 samples. Get 685 labels. Ratio: 1.0
Epoch 8
 56.75% | time:   2.2s (  0.5m) | step:    164 | train acc: 0.621 | train loss: 0.620 |test acc: 0.678 (0.645, 0.711) | test dp gap: 0.3255
 56.75% | time:   0.2s (  0.5m) | step:    164 | train acc: 0.621 | train loss: 0.620 |val acc: 0.660 (0.669, 0.650) | val dp gap: 0.2795
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
717 labeled samples and 4220 unlabeled samples. Total: 4937
Use 717 samples. Get 717 labels. Ratio: 1.0
 59.86% | time:   2.1s (  0.6m) | step:    173 | train acc: 0.660 | train loss: 0.619 |test acc: 0.680 (0.645, 0.715) | test dp gap: 0.3172
 59.86% | time:   0.2s (  0.6m) | step:    173 | train acc: 0.660 | train loss: 0.619 |val acc: 0.660 (0.677, 0.642) | val dp gap: 0.2796
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
749 labeled samples and 4188 unlabeled samples. Total: 4937
Use 749 samples. Get 749 labels. Ratio: 1.0
Epoch 9
 63.32% | time:   1.8s (  0.6m) | step:    183 | train acc: 0.672 | train loss: 0.622 |test acc: 0.681 (0.649, 0.713) | test dp gap: 0.3231
 63.32% | time:   0.2s (  0.6m) | step:    183 | train acc: 0.672 | train loss: 0.622 |val acc: 0.644 (0.645, 0.642) | val dp gap: 0.2473
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
781 labeled samples and 4156 unlabeled samples. Total: 4937
Use 781 samples. Get 781 labels. Ratio: 1.0
 66.44% | time:   1.5s (  0.6m) | step:    192 | train acc: 0.656 | train loss: 0.582 |test acc: 0.682 (0.649, 0.715) | test dp gap: 0.3251
 66.44% | time:   0.2s (  0.6m) | step:    192 | train acc: 0.656 | train loss: 0.582 |val acc: 0.636 (0.653, 0.618) | val dp gap: 0.2636
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
813 labeled samples and 4124 unlabeled samples. Total: 4937
Use 813 samples. Get 813 labels. Ratio: 1.0
Epoch 10
 69.90% | time:   1.6s (  0.7m) | step:    202 | train acc: 0.648 | train loss: 0.611 |test acc: 0.679 (0.647, 0.711) | test dp gap: 0.3236
 69.90% | time:   0.2s (  0.7m) | step:    202 | train acc: 0.648 | train loss: 0.611 |val acc: 0.656 (0.661, 0.650) | val dp gap: 0.2389
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
845 labeled samples and 4092 unlabeled samples. Total: 4937
Use 845 samples. Get 845 labels. Ratio: 1.0
 73.01% | time:   1.5s (  0.7m) | step:    211 | train acc: 0.727 | train loss: 0.559 |test acc: 0.682 (0.653, 0.711) | test dp gap: 0.3253
 73.01% | time:   0.2s (  0.7m) | step:    211 | train acc: 0.727 | train loss: 0.559 |val acc: 0.644 (0.645, 0.642) | val dp gap: 0.2472
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
877 labeled samples and 4060 unlabeled samples. Total: 4937
Use 877 samples. Get 877 labels. Ratio: 1.0
Epoch 11
 76.82% | time:   1.6s (  0.7m) | step:    222 | train acc: 0.691 | train loss: 0.574 |test acc: 0.685 (0.653, 0.717) | test dp gap: 0.3191
 76.82% | time:   0.2s (  0.7m) | step:    222 | train acc: 0.691 | train loss: 0.574 |val acc: 0.648 (0.653, 0.642) | val dp gap: 0.2392
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
909 labeled samples and 4028 unlabeled samples. Total: 4937
Use 909 samples. Get 909 labels. Ratio: 1.0
 79.93% | time:   1.4s (  0.8m) | step:    231 | train acc: 0.688 | train loss: 0.563 |test acc: 0.684 (0.653, 0.715) | test dp gap: 0.3212
 79.93% | time:   0.2s (  0.8m) | step:    231 | train acc: 0.688 | train loss: 0.563 |val acc: 0.652 (0.661, 0.642) | val dp gap: 0.2149
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
941 labeled samples and 3996 unlabeled samples. Total: 4937
Use 941 samples. Get 941 labels. Ratio: 1.0
Epoch 12
 83.39% | time:   1.8s (  0.8m) | step:    241 | train acc: 0.684 | train loss: 0.598 |test acc: 0.687 (0.655, 0.719) | test dp gap: 0.3193
 83.39% | time:   0.1s (  0.8m) | step:    241 | train acc: 0.684 | train loss: 0.598 |val acc: 0.640 (0.653, 0.626) | val dp gap: 0.2229
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
973 labeled samples and 3964 unlabeled samples. Total: 4937
Use 973 samples. Get 973 labels. Ratio: 1.0
 86.51% | time:   1.5s (  0.8m) | step:    250 | train acc: 0.652 | train loss: 0.645 |test acc: 0.688 (0.659, 0.717) | test dp gap: 0.3252
 86.51% | time:   0.2s (  0.8m) | step:    250 | train acc: 0.652 | train loss: 0.645 |val acc: 0.640 (0.661, 0.618) | val dp gap: 0.2231
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
1005 labeled samples and 3932 unlabeled samples. Total: 4937
Use 1005 samples. Get 1005 labels. Ratio: 1.0
Epoch 13
 89.97% | time:   1.8s (  0.9m) | step:    260 | train acc: 0.676 | train loss: 0.606 |test acc: 0.687 (0.659, 0.715) | test dp gap: 0.3112
 89.97% | time:   0.2s (  0.9m) | step:    260 | train acc: 0.676 | train loss: 0.606 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2067
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
1037 labeled samples and 3900 unlabeled samples. Total: 4937
Use 1037 samples. Get 1037 labels. Ratio: 1.0
 93.08% | time:   1.4s (  0.9m) | step:    269 | train acc: 0.652 | train loss: 0.616 |test acc: 0.681 (0.651, 0.711) | test dp gap: 0.3199
 93.08% | time:   0.2s (  0.9m) | step:    269 | train acc: 0.652 | train loss: 0.616 |val acc: 0.640 (0.653, 0.626) | val dp gap: 0.2225
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
1069 labeled samples and 3868 unlabeled samples. Total: 4937
Use 1069 samples. Get 1069 labels. Ratio: 1.0
Epoch 14
 96.54% | time:   1.5s (  0.9m) | step:    279 | train acc: 0.711 | train loss: 0.626 |test acc: 0.689 (0.653, 0.725) | test dp gap: 0.3311
 96.54% | time:   0.2s (  0.9m) | step:    279 | train acc: 0.711 | train loss: 0.626 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.2150
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
1101 labeled samples and 3836 unlabeled samples. Total: 4937
Use 1101 samples. Get 1101 labels. Ratio: 1.0
 99.65% | time:   1.4s (  0.9m) | step:    288 | train acc: 0.684 | train loss: 0.564 |test acc: 0.698 (0.665, 0.731) | test dp gap: 0.3205
 99.65% | time:   0.2s (  0.9m) | step:    288 | train acc: 0.684 | train loss: 0.564 |val acc: 0.628 (0.629, 0.626) | val dp gap: 0.2153
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
1133 labeled samples and 3804 unlabeled samples. Total: 4937
Use 1133 samples. Get 1133 labels. Ratio: 1.0
