2023-02-08 22:45:53.533115: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 22:45:53.533170: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 22:45:53.533177: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  2.60% | time:   3.6s (  0.1m) | step:      5 | train acc: 0.465 | train loss: 0.750 |test acc: 0.464 (0.533, 0.396) | test eod gap: 0.1196
begin calculating influence
selected layers: [Traced<ShapedArray(float32[32])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[6,32])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[32,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.454375
calculating influence -- done
  2.60% | time:   3.0s (  0.1m) | step:      5 | train acc: 0.465 | train loss: 0.750 |val acc: 0.437 (0.460, 0.415) | val eod gap: 0.0625
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  5.21% | time:   1.8s (  0.1m) | step:     10 | train acc: 0.590 | train loss: 0.690 |test acc: 0.533 (0.584, 0.484) | test eod gap: 0.0743
begin calculating influence
[Strategy 5] Acc of expected label: 0.5
calculating influence -- done
  5.21% | time:   0.8s (  0.2m) | step:     10 | train acc: 0.590 | train loss: 0.690 |val acc: 0.482 (0.532, 0.431) | val eod gap: 0.0721
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
557 labeled samples and 4380 unlabeled samples. Total: 4937
Use 557 samples. Get 497 labels. Ratio: 1.1207243460764587
  7.81% | time:   1.6s (  0.2m) | step:     15 | train acc: 0.556 | train loss: 0.676 |test acc: 0.598 (0.598, 0.598) | test eod gap: 0.0485
begin calculating influence
[Strategy 5] Acc of expected label: 0.579375
calculating influence -- done
  7.81% | time:   1.0s (  0.2m) | step:     15 | train acc: 0.556 | train loss: 0.676 |val acc: 0.510 (0.540, 0.480) | val eod gap: 0.0969
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
589 labeled samples and 4348 unlabeled samples. Total: 4937
Use 589 samples. Get 547 labels. Ratio: 1.076782449725777
  9.90% | time:   1.9s (  0.2m) | step:     19 | train acc: 0.637 | train loss: 0.668 |test acc: 0.646 (0.604, 0.687) | test eod gap: 0.1708
begin calculating influence
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
  9.90% | time:   0.9s (  0.2m) | step:     19 | train acc: 0.637 | train loss: 0.668 |val acc: 0.551 (0.548, 0.553) | val eod gap: 0.1390
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 1
 12.50% | time:   1.9s (  0.3m) | step:     24 | train acc: 0.652 | train loss: 0.650 |test acc: 0.652 (0.616, 0.687) | test eod gap: 0.1602
begin calculating influence
[Strategy 5] Acc of expected label: 0.615
calculating influence -- done
 12.50% | time:   1.0s (  0.3m) | step:     24 | train acc: 0.652 | train loss: 0.650 |val acc: 0.551 (0.524, 0.577) | val eod gap: 0.1215
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 15.10% | time:   1.3s (  0.3m) | step:     29 | train acc: 0.688 | train loss: 0.613 |test acc: 0.647 (0.610, 0.683) | test eod gap: 0.1560
begin calculating influence
[Strategy 5] Acc of expected label: 0.6171875
calculating influence -- done
 15.10% | time:   1.0s (  0.3m) | step:     29 | train acc: 0.688 | train loss: 0.613 |val acc: 0.555 (0.532, 0.577) | val eod gap: 0.1461
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 17.71% | time:   1.0s (  0.3m) | step:     34 | train acc: 0.679 | train loss: 0.602 |test acc: 0.647 (0.612, 0.681) | test eod gap: 0.1566
begin calculating influence
[Strategy 5] Acc of expected label: 0.61375
calculating influence -- done
 17.71% | time:   1.1s (  0.4m) | step:     34 | train acc: 0.679 | train loss: 0.602 |val acc: 0.555 (0.532, 0.577) | val eod gap: 0.1461
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 19.79% | time:   1.3s (  0.4m) | step:     38 | train acc: 0.648 | train loss: 0.641 |test acc: 0.647 (0.612, 0.681) | test eod gap: 0.1566
begin calculating influence
[Strategy 5] Acc of expected label: 0.620625
calculating influence -- done
 19.79% | time:   1.1s (  0.4m) | step:     38 | train acc: 0.648 | train loss: 0.641 |val acc: 0.555 (0.532, 0.577) | val eod gap: 0.1461
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 2
 22.40% | time:   1.3s (  0.4m) | step:     43 | train acc: 0.707 | train loss: 0.603 |test acc: 0.648 (0.612, 0.683) | test eod gap: 0.1539
begin calculating influence
[Strategy 5] Acc of expected label: 0.610625
calculating influence -- done
 22.40% | time:   1.1s (  0.4m) | step:     43 | train acc: 0.707 | train loss: 0.603 |val acc: 0.559 (0.532, 0.585) | val eod gap: 0.1366
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 25.00% | time:   1.4s (  0.5m) | step:     48 | train acc: 0.648 | train loss: 0.635 |test acc: 0.649 (0.616, 0.681) | test eod gap: 0.1511
begin calculating influence
[Strategy 5] Acc of expected label: 0.628125
calculating influence -- done
 25.00% | time:   1.1s (  0.5m) | step:     48 | train acc: 0.648 | train loss: 0.635 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 27.60% | time:   1.0s (  0.5m) | step:     53 | train acc: 0.725 | train loss: 0.573 |test acc: 0.648 (0.614, 0.681) | test eod gap: 0.1533
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
 27.60% | time:   1.1s (  0.5m) | step:     53 | train acc: 0.725 | train loss: 0.573 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 29.69% | time:   1.2s (  0.5m) | step:     57 | train acc: 0.688 | train loss: 0.609 |test acc: 0.652 (0.618, 0.685) | test eod gap: 0.1517
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
 29.69% | time:   1.2s (  0.6m) | step:     57 | train acc: 0.688 | train loss: 0.609 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 3
 32.29% | time:   1.2s (  0.6m) | step:     62 | train acc: 0.676 | train loss: 0.614 |test acc: 0.653 (0.618, 0.687) | test eod gap: 0.1533
begin calculating influence
[Strategy 5] Acc of expected label: 0.623125
calculating influence -- done
 32.29% | time:   1.2s (  0.6m) | step:     62 | train acc: 0.676 | train loss: 0.614 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 34.90% | time:   1.3s (  0.6m) | step:     67 | train acc: 0.645 | train loss: 0.629 |test acc: 0.653 (0.618, 0.687) | test eod gap: 0.1533
begin calculating influence
[Strategy 5] Acc of expected label: 0.6190625
calculating influence -- done
 34.90% | time:   1.1s (  0.6m) | step:     67 | train acc: 0.645 | train loss: 0.629 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 37.50% | time:   1.2s (  0.7m) | step:     72 | train acc: 0.706 | train loss: 0.589 |test acc: 0.653 (0.618, 0.687) | test eod gap: 0.1533
begin calculating influence
[Strategy 5] Acc of expected label: 0.6203125
calculating influence -- done
 37.50% | time:   1.0s (  0.7m) | step:     72 | train acc: 0.706 | train loss: 0.589 |val acc: 0.555 (0.540, 0.569) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 39.58% | time:   1.2s (  0.7m) | step:     76 | train acc: 0.672 | train loss: 0.611 |test acc: 0.654 (0.620, 0.687) | test eod gap: 0.1552
begin calculating influence
[Strategy 5] Acc of expected label: 0.623125
calculating influence -- done
 39.58% | time:   1.0s (  0.7m) | step:     76 | train acc: 0.672 | train loss: 0.611 |val acc: 0.559 (0.548, 0.569) | val eod gap: 0.1213
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 4
 42.71% | time:   1.2s (  0.7m) | step:     82 | train acc: 0.664 | train loss: 0.614 |test acc: 0.654 (0.620, 0.687) | test eod gap: 0.1552
begin calculating influence
[Strategy 5] Acc of expected label: 0.625625
calculating influence -- done
 42.71% | time:   1.2s (  0.8m) | step:     82 | train acc: 0.664 | train loss: 0.614 |val acc: 0.559 (0.548, 0.569) | val eod gap: 0.1213
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 45.31% | time:   1.3s (  0.8m) | step:     87 | train acc: 0.707 | train loss: 0.599 |test acc: 0.654 (0.620, 0.687) | test eod gap: 0.1552
begin calculating influence
[Strategy 5] Acc of expected label: 0.6159375
calculating influence -- done
 45.31% | time:   1.1s (  0.8m) | step:     87 | train acc: 0.707 | train loss: 0.599 |val acc: 0.559 (0.548, 0.569) | val eod gap: 0.1213
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 47.92% | time:   1.0s (  0.8m) | step:     92 | train acc: 0.697 | train loss: 0.598 |test acc: 0.654 (0.620, 0.687) | test eod gap: 0.1552
begin calculating influence
[Strategy 5] Acc of expected label: 0.6196875
calculating influence -- done
 47.92% | time:   1.2s (  0.8m) | step:     92 | train acc: 0.697 | train loss: 0.598 |val acc: 0.559 (0.548, 0.569) | val eod gap: 0.1213
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 50.00% | time:   1.3s (  0.9m) | step:     96 | train acc: 0.684 | train loss: 0.609 |test acc: 0.655 (0.622, 0.687) | test eod gap: 0.1613
begin calculating influence
[Strategy 5] Acc of expected label: 0.6228125
calculating influence -- done
 50.00% | time:   1.1s (  0.9m) | step:     96 | train acc: 0.684 | train loss: 0.609 |val acc: 0.563 (0.556, 0.569) | val eod gap: 0.1289
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 5
 52.60% | time:   1.4s (  0.9m) | step:    101 | train acc: 0.668 | train loss: 0.615 |test acc: 0.663 (0.635, 0.691) | test eod gap: 0.1543
begin calculating influence
[Strategy 5] Acc of expected label: 0.6253125
calculating influence -- done
 52.60% | time:   0.9s (  0.9m) | step:    101 | train acc: 0.668 | train loss: 0.615 |val acc: 0.563 (0.548, 0.577) | val eod gap: 0.1439
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 55.21% | time:   1.3s (  0.9m) | step:    106 | train acc: 0.641 | train loss: 0.630 |test acc: 0.663 (0.635, 0.691) | test eod gap: 0.1543
begin calculating influence
[Strategy 5] Acc of expected label: 0.635625
calculating influence -- done
 55.21% | time:   1.1s (  1.0m) | step:    106 | train acc: 0.641 | train loss: 0.630 |val acc: 0.563 (0.548, 0.577) | val eod gap: 0.1439
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 57.81% | time:   1.0s (  1.0m) | step:    111 | train acc: 0.679 | train loss: 0.610 |test acc: 0.663 (0.635, 0.691) | test eod gap: 0.1543
begin calculating influence
[Strategy 5] Acc of expected label: 0.6315625
calculating influence -- done
 57.81% | time:   1.1s (  1.0m) | step:    111 | train acc: 0.679 | train loss: 0.610 |val acc: 0.563 (0.548, 0.577) | val eod gap: 0.1439
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 59.90% | time:   1.3s (  1.0m) | step:    115 | train acc: 0.680 | train loss: 0.612 |test acc: 0.662 (0.635, 0.689) | test eod gap: 0.1571
begin calculating influence
[Strategy 5] Acc of expected label: 0.631875
calculating influence -- done
 59.90% | time:   1.2s (  1.0m) | step:    115 | train acc: 0.680 | train loss: 0.612 |val acc: 0.563 (0.548, 0.577) | val eod gap: 0.1439
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
Epoch 6
 62.50% | time:   1.2s (  1.0m) | step:    120 | train acc: 0.668 | train loss: 0.618 |test acc: 0.666 (0.639, 0.693) | test eod gap: 0.1596
begin calculating influence
[Strategy 5] Acc of expected label: 0.6275
calculating influence -- done
 62.50% | time:   1.2s (  1.1m) | step:    120 | train acc: 0.668 | train loss: 0.618 |val acc: 0.567 (0.548, 0.585) | val eod gap: 0.1179
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 65.10% | time:   1.1s (  1.1m) | step:    125 | train acc: 0.688 | train loss: 0.604 |test acc: 0.662 (0.635, 0.689) | test eod gap: 0.1571
begin calculating influence
[Strategy 5] Acc of expected label: 0.6275
calculating influence -- done
 65.10% | time:   1.0s (  1.1m) | step:    125 | train acc: 0.688 | train loss: 0.604 |val acc: 0.563 (0.548, 0.577) | val eod gap: 0.1439
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 67.71% | time:   0.9s (  1.1m) | step:    130 | train acc: 0.624 | train loss: 0.660 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.63625
calculating influence -- done
 67.71% | time:   1.0s (  1.1m) | step:    130 | train acc: 0.624 | train loss: 0.660 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 610 labels. Ratio: 1.018032786885246
 69.79% | time:   1.2s (  1.2m) | step:    134 | train acc: 0.699 | train loss: 0.602 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.645
calculating influence -- done
 69.79% | time:   1.3s (  1.2m) | step:    134 | train acc: 0.699 | train loss: 0.602 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
Epoch 7
 72.40% | time:   1.3s (  1.2m) | step:    139 | train acc: 0.645 | train loss: 0.628 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.641875
calculating influence -- done
 72.40% | time:   1.1s (  1.2m) | step:    139 | train acc: 0.645 | train loss: 0.628 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
 75.00% | time:   1.2s (  1.2m) | step:    144 | train acc: 0.684 | train loss: 0.602 |test acc: 0.668 (0.641, 0.695) | test eod gap: 0.1754
begin calculating influence
[Strategy 5] Acc of expected label: 0.6371875
calculating influence -- done
 75.00% | time:   1.2s (  1.3m) | step:    144 | train acc: 0.684 | train loss: 0.602 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
 77.60% | time:   1.1s (  1.3m) | step:    149 | train acc: 0.725 | train loss: 0.578 |test acc: 0.668 (0.641, 0.695) | test eod gap: 0.1754
begin calculating influence
[Strategy 5] Acc of expected label: 0.6396875
calculating influence -- done
 77.60% | time:   1.1s (  1.3m) | step:    149 | train acc: 0.725 | train loss: 0.578 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
 79.69% | time:   1.3s (  1.3m) | step:    153 | train acc: 0.711 | train loss: 0.587 |test acc: 0.668 (0.641, 0.695) | test eod gap: 0.1754
begin calculating influence
[Strategy 5] Acc of expected label: 0.6365625
calculating influence -- done
 79.69% | time:   1.1s (  1.3m) | step:    153 | train acc: 0.711 | train loss: 0.587 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
Epoch 8
 82.81% | time:   1.2s (  1.4m) | step:    159 | train acc: 0.727 | train loss: 0.588 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.6375
calculating influence -- done
 82.81% | time:   1.0s (  1.4m) | step:    159 | train acc: 0.727 | train loss: 0.588 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 611 labels. Ratio: 1.0163666121112929
 85.42% | time:   1.0s (  1.4m) | step:    164 | train acc: 0.633 | train loss: 0.631 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.635625
calculating influence -- done
 85.42% | time:   1.0s (  1.4m) | step:    164 | train acc: 0.633 | train loss: 0.631 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 612 labels. Ratio: 1.0147058823529411
 88.02% | time:   0.6s (  1.4m) | step:    169 | train acc: 0.725 | train loss: 0.585 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.640625
calculating influence -- done
 88.02% | time:   0.8s (  1.4m) | step:    169 | train acc: 0.725 | train loss: 0.585 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 612 labels. Ratio: 1.0147058823529411
 90.10% | time:   0.9s (  1.4m) | step:    173 | train acc: 0.707 | train loss: 0.596 |test acc: 0.672 (0.645, 0.699) | test eod gap: 0.1695
begin calculating influence
[Strategy 5] Acc of expected label: 0.6375
calculating influence -- done
 90.10% | time:   1.0s (  1.5m) | step:    173 | train acc: 0.707 | train loss: 0.596 |val acc: 0.579 (0.573, 0.585) | val eod gap: 0.1240
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 612 labels. Ratio: 1.0147058823529411
Epoch 9
 92.71% | time:   0.8s (  1.5m) | step:    178 | train acc: 0.695 | train loss: 0.587 |test acc: 0.673 (0.653, 0.693) | test eod gap: 0.1805
begin calculating influence
[Strategy 5] Acc of expected label: 0.65375
calculating influence -- done
 92.71% | time:   0.9s (  1.5m) | step:    178 | train acc: 0.695 | train loss: 0.587 |val acc: 0.587 (0.589, 0.585) | val eod gap: 0.1392
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 612 labels. Ratio: 1.0147058823529411
 95.31% | time:   0.9s (  1.5m) | step:    183 | train acc: 0.723 | train loss: 0.591 |test acc: 0.673 (0.653, 0.693) | test eod gap: 0.1805
begin calculating influence
[Strategy 5] Acc of expected label: 0.6465625
calculating influence -- done
 95.31% | time:   1.0s (  1.5m) | step:    183 | train acc: 0.723 | train loss: 0.591 |val acc: 0.587 (0.589, 0.585) | val eod gap: 0.1392
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
622 labeled samples and 4315 unlabeled samples. Total: 4937
Use 622 samples. Get 616 labels. Ratio: 1.0097402597402598
 97.92% | time:   1.7s (  1.5m) | step:    188 | train acc: 0.727 | train loss: 0.575 |test acc: 0.673 (0.653, 0.693) | test eod gap: 0.1805
begin calculating influence
[Strategy 5] Acc of expected label: 0.655
calculating influence -- done
 97.92% | time:   0.8s (  1.6m) | step:    188 | train acc: 0.727 | train loss: 0.575 |val acc: 0.587 (0.589, 0.585) | val eod gap: 0.1392
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
622 labeled samples and 4315 unlabeled samples. Total: 4937
Use 622 samples. Get 617 labels. Ratio: 1.0081037277147489
100.00% | time:   1.1s (  1.6m) | step:    192 | train acc: 0.688 | train loss: 0.612 |test acc: 0.673 (0.653, 0.693) | test eod gap: 0.1805
begin calculating influence
[Strategy 5] Acc of expected label: 0.64625
calculating influence -- done
100.00% | time:   0.7s (  1.6m) | step:    192 | train acc: 0.688 | train loss: 0.612 |val acc: 0.587 (0.589, 0.585) | val eod gap: 0.1392
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
622 labeled samples and 4315 unlabeled samples. Total: 4937
Use 622 samples. Get 617 labels. Ratio: 1.0081037277147489
