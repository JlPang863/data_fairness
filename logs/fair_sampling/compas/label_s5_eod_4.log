2023-02-12 05:48:34.391110: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.391188: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.391197: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
246 labeled samples and 4691 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   4.1s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_t acc: 0.585 (0.610, 0.560) | warm_t eod gap: 0.1419
  3.46% | time:   1.3s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_v acc: 0.599 (0.573, 0.626) | warm_v eod gap: 0.1013
  6.57% | time:   1.8s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_t acc: 0.675 (0.649, 0.701) | warm_t eod gap: 0.2527
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_v acc: 0.648 (0.637, 0.659) | warm_v eod gap: 0.2270
Epoch 1
 10.03% | time:   1.9s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_t acc: 0.669 (0.657, 0.681) | warm_t eod gap: 0.2699
 10.03% | time:   0.2s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_v acc: 0.644 (0.613, 0.675) | warm_v eod gap: 0.2178
 13.15% | time:   1.7s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eod gap: 0.2714
 13.15% | time:   0.2s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eod gap: 0.2017
Epoch 2
 16.61% | time:   2.1s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_t acc: 0.658 (0.649, 0.667) | warm_t eod gap: 0.2609
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eod gap: 0.2013
 19.72% | time:   1.6s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_t acc: 0.651 (0.641, 0.661) | warm_t eod gap: 0.2562
 19.72% | time:   0.2s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_v acc: 0.640 (0.629, 0.650) | warm_v eod gap: 0.1946
Epoch 3
 23.18% | time:   2.1s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_t acc: 0.648 (0.637, 0.659) | warm_t eod gap: 0.2464
 23.18% | time:   0.2s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_v acc: 0.644 (0.637, 0.650) | warm_v eod gap: 0.2022
 26.30% | time:   2.0s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_t acc: 0.655 (0.637, 0.673) | warm_t eod gap: 0.2661
 26.30% | time:   0.2s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eod gap: 0.1878
Epoch 4
 30.10% | time:   2.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_t acc: 0.657 (0.639, 0.675) | warm_t eod gap: 0.2701
 30.10% | time:   0.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eod gap: 0.1878
 33.22% | time:   1.8s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_t acc: 0.654 (0.637, 0.671) | warm_t eod gap: 0.2696
 33.22% | time:   0.2s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_v acc: 0.640 (0.637, 0.642) | warm_v eod gap: 0.1792
Epoch 5
 36.68% | time:   2.2s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |test acc: 0.655 (0.637, 0.673) | test eod gap: 0.2712
 36.68% | time:   0.2s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val eod gap: 0.1792
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
276 labeled samples and 4661 unlabeled samples. Total: 4937
Use 276 samples. Get 303 labels. Ratio: 0.9108910891089109
 39.79% | time:   3.5s (  0.5m) | step:    115 | train acc: 0.742 | train loss: 0.559 |test acc: 0.667 (0.651, 0.683) | test eod gap: 0.2570
 39.79% | time:   0.2s (  0.5m) | step:    115 | train acc: 0.742 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val eod gap: 0.1645
begin calculating influence
[Strategy 5] Acc of expected label: 0.6696875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
308 labeled samples and 4629 unlabeled samples. Total: 4937
Use 308 samples. Get 373 labels. Ratio: 0.8257372654155496
Epoch 6
 43.25% | time:   2.5s (  0.5m) | step:    125 | train acc: 0.750 | train loss: 0.508 |test acc: 0.666 (0.643, 0.689) | test eod gap: 0.2515
 43.25% | time:   0.1s (  0.6m) | step:    125 | train acc: 0.750 | train loss: 0.508 |val acc: 0.595 (0.581, 0.610) | val eod gap: 0.1666
begin calculating influence
[Strategy 5] Acc of expected label: 0.669375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
337 labeled samples and 4600 unlabeled samples. Total: 4937
Use 337 samples. Get 427 labels. Ratio: 0.7892271662763466
 46.37% | time:   2.3s (  0.6m) | step:    134 | train acc: 0.805 | train loss: 0.517 |test acc: 0.658 (0.647, 0.669) | test eod gap: 0.2312
 46.37% | time:   0.2s (  0.6m) | step:    134 | train acc: 0.805 | train loss: 0.517 |val acc: 0.599 (0.605, 0.593) | val eod gap: 0.1739
begin calculating influence
[Strategy 5] Acc of expected label: 0.6634375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
369 labeled samples and 4568 unlabeled samples. Total: 4937
Use 369 samples. Get 495 labels. Ratio: 0.7454545454545455
Epoch 7
 49.83% | time:   2.3s (  0.6m) | step:    144 | train acc: 0.823 | train loss: 0.486 |test acc: 0.665 (0.645, 0.685) | test eod gap: 0.2176
 49.83% | time:   0.2s (  0.6m) | step:    144 | train acc: 0.823 | train loss: 0.486 |val acc: 0.607 (0.621, 0.593) | val eod gap: 0.1898
begin calculating influence
[Strategy 5] Acc of expected label: 0.64375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
401 labeled samples and 4536 unlabeled samples. Total: 4937
Use 401 samples. Get 569 labels. Ratio: 0.7047451669595782
 52.94% | time:   2.2s (  0.7m) | step:    153 | train acc: 0.816 | train loss: 0.487 |test acc: 0.647 (0.629, 0.665) | test eod gap: 0.1923
 52.94% | time:   0.2s (  0.7m) | step:    153 | train acc: 0.816 | train loss: 0.487 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.1822
begin calculating influence
[Strategy 5] Acc of expected label: 0.631875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
433 labeled samples and 4504 unlabeled samples. Total: 4937
Use 433 samples. Get 643 labels. Ratio: 0.6734059097978227
Epoch 8
 56.75% | time:   2.2s (  0.7m) | step:    164 | train acc: 0.825 | train loss: 0.485 |test acc: 0.633 (0.610, 0.655) | test eod gap: 0.1809
 56.75% | time:   0.2s (  0.7m) | step:    164 | train acc: 0.825 | train loss: 0.485 |val acc: 0.599 (0.605, 0.593) | val eod gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.62125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
463 labeled samples and 4474 unlabeled samples. Total: 4937
Use 463 samples. Get 712 labels. Ratio: 0.6502808988764045
 59.86% | time:   2.3s (  0.8m) | step:    173 | train acc: 0.852 | train loss: 0.432 |test acc: 0.618 (0.602, 0.635) | test eod gap: 0.1688
 59.86% | time:   0.1s (  0.8m) | step:    173 | train acc: 0.852 | train loss: 0.432 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.2142
begin calculating influence
[Strategy 5] Acc of expected label: 0.6153125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
473 labeled samples and 4464 unlabeled samples. Total: 4937
Use 473 samples. Get 734 labels. Ratio: 0.6444141689373297
Epoch 9
 63.32% | time:   2.5s (  0.8m) | step:    183 | train acc: 0.843 | train loss: 0.449 |test acc: 0.617 (0.604, 0.631) | test eod gap: 0.1719
 63.32% | time:   0.3s (  0.8m) | step:    183 | train acc: 0.843 | train loss: 0.449 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.2142
begin calculating influence
[Strategy 5] Acc of expected label: 0.6059375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
476 labeled samples and 4461 unlabeled samples. Total: 4937
Use 476 samples. Get 744 labels. Ratio: 0.6397849462365591
 66.44% | time:   2.3s (  0.8m) | step:    192 | train acc: 0.836 | train loss: 0.439 |test acc: 0.626 (0.608, 0.643) | test eod gap: 0.1774
 66.44% | time:   0.3s (  0.8m) | step:    192 | train acc: 0.836 | train loss: 0.439 |val acc: 0.607 (0.621, 0.593) | val eod gap: 0.2056
begin calculating influence
[Strategy 5] Acc of expected label: 0.6121875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
486 labeled samples and 4451 unlabeled samples. Total: 4937
Use 486 samples. Get 763 labels. Ratio: 0.6369593709043251
Epoch 10
 69.90% | time:   2.5s (  0.9m) | step:    202 | train acc: 0.857 | train loss: 0.435 |test acc: 0.617 (0.604, 0.631) | test eod gap: 0.1712
 69.90% | time:   0.2s (  0.9m) | step:    202 | train acc: 0.857 | train loss: 0.435 |val acc: 0.607 (0.613, 0.602) | val eod gap: 0.1716
begin calculating influence
[Strategy 5] Acc of expected label: 0.6096875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 798 labels. Ratio: 0.6215538847117794
 73.01% | time:   2.3s (  0.9m) | step:    211 | train acc: 0.840 | train loss: 0.441 |test acc: 0.624 (0.608, 0.641) | test eod gap: 0.1672
 73.01% | time:   0.2s (  0.9m) | step:    211 | train acc: 0.840 | train loss: 0.441 |val acc: 0.615 (0.629, 0.602) | val eod gap: 0.1544
begin calculating influence
[Strategy 5] Acc of expected label: 0.615
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
512 labeled samples and 4425 unlabeled samples. Total: 4937
Use 512 samples. Get 824 labels. Ratio: 0.6213592233009708
Epoch 11
 76.82% | time:   2.0s (  1.0m) | step:    222 | train acc: 0.875 | train loss: 0.409 |test acc: 0.622 (0.602, 0.643) | test eod gap: 0.1622
 76.82% | time:   0.2s (  1.0m) | step:    222 | train acc: 0.875 | train loss: 0.409 |val acc: 0.611 (0.613, 0.610) | val eod gap: 0.1622
begin calculating influence
[Strategy 5] Acc of expected label: 0.6096875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
512 labeled samples and 4425 unlabeled samples. Total: 4937
Use 512 samples. Get 826 labels. Ratio: 0.6198547215496368
 79.93% | time:   2.2s (  1.0m) | step:    231 | train acc: 0.840 | train loss: 0.416 |test acc: 0.619 (0.608, 0.631) | test eod gap: 0.1667
 79.93% | time:   0.2s (  1.0m) | step:    231 | train acc: 0.840 | train loss: 0.416 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.1641
begin calculating influence
[Strategy 5] Acc of expected label: 0.59625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
515 labeled samples and 4422 unlabeled samples. Total: 4937
Use 515 samples. Get 835 labels. Ratio: 0.6167664670658682
Epoch 12
 83.39% | time:   2.3s (  1.0m) | step:    241 | train acc: 0.836 | train loss: 0.401 |test acc: 0.604 (0.598, 0.610) | test eod gap: 0.1651
 83.39% | time:   0.2s (  1.0m) | step:    241 | train acc: 0.836 | train loss: 0.401 |val acc: 0.591 (0.597, 0.585) | val eod gap: 0.1580
begin calculating influence
[Strategy 5] Acc of expected label: 0.5946875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
529 labeled samples and 4408 unlabeled samples. Total: 4937
Use 529 samples. Get 882 labels. Ratio: 0.5997732426303855
 86.51% | time:   2.0s (  1.1m) | step:    250 | train acc: 0.848 | train loss: 0.424 |test acc: 0.606 (0.602, 0.610) | test eod gap: 0.1698
 86.51% | time:   0.1s (  1.1m) | step:    250 | train acc: 0.848 | train loss: 0.424 |val acc: 0.591 (0.597, 0.585) | val eod gap: 0.1580
begin calculating influence
[Strategy 5] Acc of expected label: 0.5925
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
534 labeled samples and 4403 unlabeled samples. Total: 4937
Use 534 samples. Get 894 labels. Ratio: 0.5973154362416108
Epoch 13
 89.97% | time:   2.2s (  1.1m) | step:    260 | train acc: 0.828 | train loss: 0.450 |test acc: 0.633 (0.616, 0.649) | test eod gap: 0.1698
 89.97% | time:   0.2s (  1.1m) | step:    260 | train acc: 0.828 | train loss: 0.450 |val acc: 0.619 (0.621, 0.618) | val eod gap: 0.1445
begin calculating influence
[Strategy 5] Acc of expected label: 0.6171875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 950 labels. Ratio: 0.5957894736842105
 93.08% | time:   2.0s (  1.2m) | step:    269 | train acc: 0.832 | train loss: 0.427 |test acc: 0.613 (0.600, 0.627) | test eod gap: 0.1769
 93.08% | time:   0.1s (  1.2m) | step:    269 | train acc: 0.832 | train loss: 0.427 |val acc: 0.591 (0.597, 0.585) | val eod gap: 0.1580
begin calculating influence
[Strategy 5] Acc of expected label: 0.6046875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
570 labeled samples and 4367 unlabeled samples. Total: 4937
Use 570 samples. Get 963 labels. Ratio: 0.5919003115264797
Epoch 14
 96.54% | time:   2.0s (  1.2m) | step:    279 | train acc: 0.859 | train loss: 0.417 |test acc: 0.614 (0.604, 0.624) | test eod gap: 0.1698
 96.54% | time:   0.2s (  1.2m) | step:    279 | train acc: 0.859 | train loss: 0.417 |val acc: 0.591 (0.605, 0.577) | val eod gap: 0.1584
begin calculating influence
[Strategy 5] Acc of expected label: 0.5903125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
580 labeled samples and 4357 unlabeled samples. Total: 4937
Use 580 samples. Get 991 labels. Ratio: 0.5852674066599395
 99.65% | time:   1.9s (  1.2m) | step:    288 | train acc: 0.863 | train loss: 0.422 |test acc: 0.619 (0.614, 0.624) | test eod gap: 0.1775
 99.65% | time:   0.2s (  1.2m) | step:    288 | train acc: 0.863 | train loss: 0.422 |val acc: 0.599 (0.613, 0.585) | val eod gap: 0.1408
begin calculating influence
[Strategy 5] Acc of expected label: 0.6025
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
582 labeled samples and 4355 unlabeled samples. Total: 4937
Use 582 samples. Get 994 labels. Ratio: 0.5855130784708249
