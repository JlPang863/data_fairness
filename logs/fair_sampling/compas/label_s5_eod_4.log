2023-02-12 04:09:22.578666: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.578745: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.578752: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   7.6s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t eod gap: 0.1636
  6.57% | time:   1.4s (  0.2m) | step:     19 | train acc: 0.715 | train loss: 0.581 |warm_t acc: 0.683 (0.659, 0.707) | warm_t eod gap: 0.2569
Epoch 1
 10.03% | time:   1.2s (  0.2m) | step:     29 | train acc: 0.646 | train loss: 0.624 |warm_t acc: 0.673 (0.651, 0.695) | warm_t eod gap: 0.2718
 13.15% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.664 | train loss: 0.593 |warm_t acc: 0.674 (0.657, 0.691) | warm_t eod gap: 0.2697
Epoch 2
 16.61% | time:   1.3s (  0.2m) | step:     48 | train acc: 0.688 | train loss: 0.603 |warm_t acc: 0.673 (0.655, 0.691) | warm_t eod gap: 0.2749
 19.72% | time:   1.2s (  0.2m) | step:     57 | train acc: 0.676 | train loss: 0.605 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eod gap: 0.2762
Epoch 3
 23.18% | time:   1.1s (  0.3m) | step:     67 | train acc: 0.654 | train loss: 0.599 |warm_t acc: 0.667 (0.649, 0.685) | warm_t eod gap: 0.2799
 26.30% | time:   1.1s (  0.3m) | step:     76 | train acc: 0.676 | train loss: 0.609 |warm_t acc: 0.667 (0.649, 0.685) | warm_t eod gap: 0.2715
Epoch 4
 30.10% | time:   1.3s (  0.3m) | step:     87 | train acc: 0.641 | train loss: 0.621 |warm_t acc: 0.664 (0.643, 0.685) | warm_t eod gap: 0.2654
 33.22% | time:   1.3s (  0.3m) | step:     96 | train acc: 0.672 | train loss: 0.579 |warm_t acc: 0.668 (0.645, 0.691) | warm_t eod gap: 0.2646
Epoch 5
 36.68% | time:   1.2s (  0.3m) | step:    106 | train acc: 0.675 | train loss: 0.574 |test acc: 0.669 (0.645, 0.693) | test eod gap: 0.2662
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6625
calculating influence -- done
 36.68% | time:   4.2s (  0.4m) | step:    106 | train acc: 0.675 | train loss: 0.574 |val acc: 0.648 (0.645, 0.650) | val eod gap: 0.1943
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
523 labeled samples and 4414 unlabeled samples. Total: 4937
Use 523 samples. Get 551 labels. Ratio: 0.9491833030852994
 39.79% | time:   2.0s (  0.4m) | step:    115 | train acc: 0.818 | train loss: 0.517 |test acc: 0.659 (0.643, 0.675) | test eod gap: 0.2529
begin calculating influence
[Strategy 5] Acc of expected label: 0.6590625
calculating influence -- done
 39.79% | time:   1.2s (  0.5m) | step:    115 | train acc: 0.818 | train loss: 0.517 |val acc: 0.648 (0.645, 0.650) | val eod gap: 0.1611
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
529 labeled samples and 4408 unlabeled samples. Total: 4937
Use 529 samples. Get 566 labels. Ratio: 0.9346289752650176
Epoch 6
 43.25% | time:   2.2s (  0.5m) | step:    125 | train acc: 0.734 | train loss: 0.537 |test acc: 0.663 (0.643, 0.683) | test eod gap: 0.2571
begin calculating influence
[Strategy 5] Acc of expected label: 0.655
calculating influence -- done
 43.25% | time:   1.1s (  0.5m) | step:    125 | train acc: 0.734 | train loss: 0.537 |val acc: 0.656 (0.645, 0.667) | val eod gap: 0.2090
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
556 labeled samples and 4381 unlabeled samples. Total: 4937
Use 556 samples. Get 621 labels. Ratio: 0.895330112721417
 46.37% | time:   1.8s (  0.5m) | step:    134 | train acc: 0.719 | train loss: 0.578 |test acc: 0.690 (0.665, 0.715) | test eod gap: 0.2539
begin calculating influence
[Strategy 5] Acc of expected label: 0.6778125
calculating influence -- done
 46.37% | time:   1.3s (  0.6m) | step:    134 | train acc: 0.719 | train loss: 0.578 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.2268
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
588 labeled samples and 4349 unlabeled samples. Total: 4937
Use 588 samples. Get 675 labels. Ratio: 0.8711111111111111
Epoch 7
 49.83% | time:   2.2s (  0.6m) | step:    144 | train acc: 0.766 | train loss: 0.547 |test acc: 0.682 (0.659, 0.705) | test eod gap: 0.2502
begin calculating influence
[Strategy 5] Acc of expected label: 0.664375
calculating influence -- done
 49.83% | time:   1.2s (  0.6m) | step:    144 | train acc: 0.766 | train loss: 0.547 |val acc: 0.648 (0.653, 0.642) | val eod gap: 0.1966
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
620 labeled samples and 4317 unlabeled samples. Total: 4937
Use 620 samples. Get 745 labels. Ratio: 0.8322147651006712
 52.94% | time:   2.0s (  0.7m) | step:    153 | train acc: 0.715 | train loss: 0.568 |test acc: 0.681 (0.655, 0.707) | test eod gap: 0.2344
begin calculating influence
[Strategy 5] Acc of expected label: 0.66125
calculating influence -- done
 52.94% | time:   1.3s (  0.7m) | step:    153 | train acc: 0.715 | train loss: 0.568 |val acc: 0.636 (0.653, 0.618) | val eod gap: 0.1586
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
637 labeled samples and 4300 unlabeled samples. Total: 4937
Use 637 samples. Get 780 labels. Ratio: 0.8166666666666667
Epoch 8
 56.75% | time:   2.2s (  0.7m) | step:    164 | train acc: 0.730 | train loss: 0.559 |test acc: 0.684 (0.663, 0.705) | test eod gap: 0.2388
begin calculating influence
[Strategy 5] Acc of expected label: 0.65125
calculating influence -- done
 56.75% | time:   1.4s (  0.7m) | step:    164 | train acc: 0.730 | train loss: 0.559 |val acc: 0.628 (0.653, 0.602) | val eod gap: 0.1944
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
669 labeled samples and 4268 unlabeled samples. Total: 4937
Use 669 samples. Get 878 labels. Ratio: 0.7619589977220956
 59.86% | time:   2.0s (  0.8m) | step:    173 | train acc: 0.723 | train loss: 0.579 |test acc: 0.678 (0.663, 0.693) | test eod gap: 0.2331
begin calculating influence
[Strategy 5] Acc of expected label: 0.6621875
calculating influence -- done
 59.86% | time:   1.2s (  0.8m) | step:    173 | train acc: 0.723 | train loss: 0.579 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1970
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
689 labeled samples and 4248 unlabeled samples. Total: 4937
Use 689 samples. Get 915 labels. Ratio: 0.7530054644808744
Epoch 9
 63.32% | time:   2.1s (  0.8m) | step:    183 | train acc: 0.789 | train loss: 0.514 |test acc: 0.677 (0.663, 0.691) | test eod gap: 0.2222
begin calculating influence
[Strategy 5] Acc of expected label: 0.6428125
calculating influence -- done
 63.32% | time:   1.2s (  0.8m) | step:    183 | train acc: 0.789 | train loss: 0.514 |val acc: 0.611 (0.629, 0.593) | val eod gap: 0.1796
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
713 labeled samples and 4224 unlabeled samples. Total: 4937
Use 713 samples. Get 970 labels. Ratio: 0.7350515463917526
 66.44% | time:   2.2s (  0.9m) | step:    192 | train acc: 0.766 | train loss: 0.525 |test acc: 0.678 (0.657, 0.699) | test eod gap: 0.2197
begin calculating influence
[Strategy 5] Acc of expected label: 0.6496875
calculating influence -- done
 66.44% | time:   1.2s (  0.9m) | step:    192 | train acc: 0.766 | train loss: 0.525 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.1487
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
728 labeled samples and 4209 unlabeled samples. Total: 4937
Use 728 samples. Get 1007 labels. Ratio: 0.7229394240317776
Epoch 10
 69.90% | time:   1.9s (  0.9m) | step:    202 | train acc: 0.789 | train loss: 0.491 |test acc: 0.672 (0.659, 0.685) | test eod gap: 0.2113
begin calculating influence
[Strategy 5] Acc of expected label: 0.6334375
calculating influence -- done
 69.90% | time:   1.3s (  1.0m) | step:    202 | train acc: 0.789 | train loss: 0.491 |val acc: 0.611 (0.629, 0.593) | val eod gap: 0.1480
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
759 labeled samples and 4178 unlabeled samples. Total: 4937
Use 759 samples. Get 1068 labels. Ratio: 0.7106741573033708
 73.01% | time:   1.7s (  1.0m) | step:    211 | train acc: 0.809 | train loss: 0.487 |test acc: 0.666 (0.665, 0.667) | test eod gap: 0.2071
begin calculating influence
[Strategy 5] Acc of expected label: 0.635625
calculating influence -- done
 73.01% | time:   1.3s (  1.0m) | step:    211 | train acc: 0.809 | train loss: 0.487 |val acc: 0.595 (0.613, 0.577) | val eod gap: 0.1506
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
780 labeled samples and 4157 unlabeled samples. Total: 4937
Use 780 samples. Get 1106 labels. Ratio: 0.705244122965642
Epoch 11
 76.82% | time:   2.0s (  1.0m) | step:    222 | train acc: 0.797 | train loss: 0.493 |test acc: 0.666 (0.663, 0.669) | test eod gap: 0.2024
begin calculating influence
[Strategy 5] Acc of expected label: 0.635
calculating influence -- done
 76.82% | time:   1.2s (  1.1m) | step:    222 | train acc: 0.797 | train loss: 0.493 |val acc: 0.603 (0.621, 0.585) | val eod gap: 0.1491
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
785 labeled samples and 4152 unlabeled samples. Total: 4937
Use 785 samples. Get 1118 labels. Ratio: 0.7021466905187835
 79.93% | time:   1.0s (  1.1m) | step:    231 | train acc: 0.793 | train loss: 0.495 |test acc: 0.669 (0.661, 0.677) | test eod gap: 0.1988
begin calculating influence
[Strategy 5] Acc of expected label: 0.6309375
calculating influence -- done
 79.93% | time:   1.3s (  1.1m) | step:    231 | train acc: 0.793 | train loss: 0.495 |val acc: 0.599 (0.613, 0.585) | val eod gap: 0.1585
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
812 labeled samples and 4125 unlabeled samples. Total: 4937
Use 812 samples. Get 1179 labels. Ratio: 0.6887192536047498
Epoch 12
 83.39% | time:   1.1s (  1.1m) | step:    241 | train acc: 0.820 | train loss: 0.501 |test acc: 0.664 (0.655, 0.673) | test eod gap: 0.1799
begin calculating influence
[Strategy 5] Acc of expected label: 0.6390625
calculating influence -- done
 83.39% | time:   1.1s (  1.1m) | step:    241 | train acc: 0.820 | train loss: 0.501 |val acc: 0.603 (0.621, 0.585) | val eod gap: 0.1653
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
816 labeled samples and 4121 unlabeled samples. Total: 4937
Use 816 samples. Get 1193 labels. Ratio: 0.6839899413243923
 86.51% | time:   1.7s (  1.2m) | step:    250 | train acc: 0.793 | train loss: 0.514 |test acc: 0.664 (0.657, 0.671) | test eod gap: 0.1843
begin calculating influence
[Strategy 5] Acc of expected label: 0.6325
calculating influence -- done
 86.51% | time:   1.3s (  1.2m) | step:    250 | train acc: 0.793 | train loss: 0.514 |val acc: 0.591 (0.605, 0.577) | val eod gap: 0.1596
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
821 labeled samples and 4116 unlabeled samples. Total: 4937
Use 821 samples. Get 1207 labels. Ratio: 0.68019884009942
Epoch 13
 89.97% | time:   1.9s (  1.2m) | step:    260 | train acc: 0.809 | train loss: 0.497 |test acc: 0.664 (0.643, 0.685) | test eod gap: 0.2050
begin calculating influence
[Strategy 5] Acc of expected label: 0.6253125
calculating influence -- done
 89.97% | time:   1.2s (  1.2m) | step:    260 | train acc: 0.809 | train loss: 0.497 |val acc: 0.591 (0.605, 0.577) | val eod gap: 0.1777
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
853 labeled samples and 4084 unlabeled samples. Total: 4937
Use 853 samples. Get 1281 labels. Ratio: 0.6658860265417642
 93.08% | time:   1.6s (  1.3m) | step:    269 | train acc: 0.875 | train loss: 0.427 |test acc: 0.669 (0.645, 0.693) | test eod gap: 0.2001
begin calculating influence
[Strategy 5] Acc of expected label: 0.6240625
calculating influence -- done
 93.08% | time:   1.1s (  1.3m) | step:    269 | train acc: 0.875 | train loss: 0.427 |val acc: 0.583 (0.605, 0.561) | val eod gap: 0.1630
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
872 labeled samples and 4065 unlabeled samples. Total: 4937
Use 872 samples. Get 1320 labels. Ratio: 0.6606060606060606
Epoch 14
 96.54% | time:   1.9s (  1.3m) | step:    279 | train acc: 0.828 | train loss: 0.478 |test acc: 0.662 (0.655, 0.669) | test eod gap: 0.1806
begin calculating influence
[Strategy 5] Acc of expected label: 0.6234375
calculating influence -- done
 96.54% | time:   1.1s (  1.3m) | step:    279 | train acc: 0.828 | train loss: 0.478 |val acc: 0.583 (0.597, 0.569) | val eod gap: 0.1449
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
879 labeled samples and 4058 unlabeled samples. Total: 4937
Use 879 samples. Get 1339 labels. Ratio: 0.6564600448095593
 99.65% | time:   1.6s (  1.4m) | step:    288 | train acc: 0.820 | train loss: 0.470 |test acc: 0.669 (0.645, 0.693) | test eod gap: 0.1907
begin calculating influence
[Strategy 5] Acc of expected label: 0.621875
calculating influence -- done
 99.65% | time:   1.1s (  1.4m) | step:    288 | train acc: 0.820 | train loss: 0.470 |val acc: 0.579 (0.597, 0.561) | val eod gap: 0.1712
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
884 labeled samples and 4053 unlabeled samples. Total: 4937
Use 884 samples. Get 1347 labels. Ratio: 0.6562731997030438
