2023-02-12 06:03:05.419112: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.419188: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.419194: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   3.4s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t eod gap: 0.1636
  3.46% | time:   1.4s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_v acc: 0.607 (0.613, 0.602) | warm_v eod gap: 0.1208
  6.57% | time:   1.0s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_t acc: 0.682 (0.659, 0.705) | warm_t eod gap: 0.2553
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_v acc: 0.619 (0.621, 0.618) | warm_v eod gap: 0.2598
Epoch 1
 10.03% | time:   1.0s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_t acc: 0.670 (0.651, 0.689) | warm_t eod gap: 0.2627
 10.03% | time:   0.2s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_v acc: 0.640 (0.621, 0.659) | warm_v eod gap: 0.2284
 13.15% | time:   1.0s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_t acc: 0.674 (0.657, 0.691) | warm_t eod gap: 0.2697
 13.15% | time:   0.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_v acc: 0.652 (0.621, 0.683) | warm_v eod gap: 0.2163
Epoch 2
 16.61% | time:   1.0s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_t acc: 0.673 (0.655, 0.691) | warm_t eod gap: 0.2749
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_v acc: 0.648 (0.629, 0.667) | warm_v eod gap: 0.2096
 19.72% | time:   1.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_t acc: 0.673 (0.653, 0.693) | warm_t eod gap: 0.2736
 19.72% | time:   0.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eod gap: 0.2033
Epoch 3
 23.18% | time:   1.1s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_t acc: 0.668 (0.647, 0.689) | warm_t eod gap: 0.2679
 23.18% | time:   0.2s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_v acc: 0.648 (0.645, 0.650) | warm_v eod gap: 0.1939
 26.30% | time:   1.0s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_t acc: 0.666 (0.647, 0.685) | warm_t eod gap: 0.2736
 26.30% | time:   0.2s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eod gap: 0.1871
Epoch 4
 30.10% | time:   1.0s (  0.2m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_t acc: 0.665 (0.643, 0.687) | warm_t eod gap: 0.2549
 30.10% | time:   0.1s (  0.2m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eod gap: 0.1871
 33.22% | time:   1.1s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_t acc: 0.665 (0.643, 0.687) | warm_t eod gap: 0.2549
 33.22% | time:   0.2s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eod gap: 0.1871
Epoch 5
 36.68% | time:   0.9s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |test acc: 0.667 (0.647, 0.687) | test eod gap: 0.2634
 36.68% | time:   0.1s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |val acc: 0.648 (0.645, 0.650) | val eod gap: 0.1777
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
517 labeled samples and 4420 unlabeled samples. Total: 4937
Use 517 samples. Get 542 labels. Ratio: 0.9538745387453874
 39.79% | time:   2.8s (  0.3m) | step:    115 | train acc: 0.800 | train loss: 0.547 |test acc: 0.684 (0.651, 0.717) | test eod gap: 0.2726
 39.79% | time:   0.2s (  0.3m) | step:    115 | train acc: 0.800 | train loss: 0.547 |val acc: 0.652 (0.645, 0.659) | val eod gap: 0.2519
begin calculating influence
[Strategy 5] Acc of expected label: 0.6759375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
549 labeled samples and 4388 unlabeled samples. Total: 4937
Use 549 samples. Get 612 labels. Ratio: 0.8970588235294118
Epoch 6
 43.25% | time:   2.4s (  0.4m) | step:    125 | train acc: 0.719 | train loss: 0.595 |test acc: 0.679 (0.645, 0.713) | test eod gap: 0.2597
 43.25% | time:   0.2s (  0.4m) | step:    125 | train acc: 0.719 | train loss: 0.595 |val acc: 0.656 (0.653, 0.659) | val eod gap: 0.2275
begin calculating influence
[Strategy 5] Acc of expected label: 0.6653125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
581 labeled samples and 4356 unlabeled samples. Total: 4937
Use 581 samples. Get 683 labels. Ratio: 0.8506588579795022
 46.37% | time:   2.1s (  0.4m) | step:    134 | train acc: 0.715 | train loss: 0.593 |test acc: 0.682 (0.653, 0.711) | test eod gap: 0.2436
 46.37% | time:   0.2s (  0.4m) | step:    134 | train acc: 0.715 | train loss: 0.593 |val acc: 0.652 (0.661, 0.642) | val eod gap: 0.1710
begin calculating influence
[Strategy 5] Acc of expected label: 0.6640625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
613 labeled samples and 4324 unlabeled samples. Total: 4937
Use 613 samples. Get 746 labels. Ratio: 0.82171581769437
Epoch 7
 49.83% | time:   2.1s (  0.5m) | step:    144 | train acc: 0.750 | train loss: 0.580 |test acc: 0.677 (0.655, 0.699) | test eod gap: 0.2281
 49.83% | time:   0.2s (  0.5m) | step:    144 | train acc: 0.750 | train loss: 0.580 |val acc: 0.632 (0.653, 0.610) | val eod gap: 0.1843
begin calculating influence
[Strategy 5] Acc of expected label: 0.6621875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
632 labeled samples and 4305 unlabeled samples. Total: 4937
Use 632 samples. Get 777 labels. Ratio: 0.8133848133848134
 52.94% | time:   2.1s (  0.5m) | step:    153 | train acc: 0.809 | train loss: 0.515 |test acc: 0.681 (0.659, 0.703) | test eod gap: 0.2383
 52.94% | time:   0.1s (  0.5m) | step:    153 | train acc: 0.809 | train loss: 0.515 |val acc: 0.640 (0.653, 0.626) | val eod gap: 0.2163
begin calculating influence
[Strategy 5] Acc of expected label: 0.66
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
664 labeled samples and 4273 unlabeled samples. Total: 4937
Use 664 samples. Get 900 labels. Ratio: 0.7377777777777778
Epoch 8
 56.75% | time:   2.1s (  0.5m) | step:    164 | train acc: 0.777 | train loss: 0.547 |test acc: 0.677 (0.657, 0.697) | test eod gap: 0.2487
 56.75% | time:   0.2s (  0.5m) | step:    164 | train acc: 0.777 | train loss: 0.547 |val acc: 0.632 (0.645, 0.618) | val eod gap: 0.2174
begin calculating influence
[Strategy 5] Acc of expected label: 0.6459375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
693 labeled samples and 4244 unlabeled samples. Total: 4937
Use 693 samples. Get 962 labels. Ratio: 0.7203742203742204
 59.86% | time:   1.9s (  0.6m) | step:    173 | train acc: 0.797 | train loss: 0.543 |test acc: 0.678 (0.663, 0.693) | test eod gap: 0.2288
 59.86% | time:   0.3s (  0.6m) | step:    173 | train acc: 0.797 | train loss: 0.543 |val acc: 0.619 (0.637, 0.602) | val eod gap: 0.1947
begin calculating influence
[Strategy 5] Acc of expected label: 0.6440625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
710 labeled samples and 4227 unlabeled samples. Total: 4937
Use 710 samples. Get 998 labels. Ratio: 0.7114228456913828
Epoch 9
 63.32% | time:   2.2s (  0.6m) | step:    183 | train acc: 0.789 | train loss: 0.528 |test acc: 0.679 (0.665, 0.693) | test eod gap: 0.2322
 63.32% | time:   0.2s (  0.6m) | step:    183 | train acc: 0.789 | train loss: 0.528 |val acc: 0.628 (0.637, 0.618) | val eod gap: 0.2264
begin calculating influence
[Strategy 5] Acc of expected label: 0.643125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
742 labeled samples and 4195 unlabeled samples. Total: 4937
Use 742 samples. Get 1055 labels. Ratio: 0.7033175355450237
 66.44% | time:   2.0s (  0.6m) | step:    192 | train acc: 0.812 | train loss: 0.500 |test acc: 0.675 (0.665, 0.685) | test eod gap: 0.2211
 66.44% | time:   0.2s (  0.6m) | step:    192 | train acc: 0.812 | train loss: 0.500 |val acc: 0.615 (0.637, 0.593) | val eod gap: 0.1883
begin calculating influence
[Strategy 5] Acc of expected label: 0.6415625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
763 labeled samples and 4174 unlabeled samples. Total: 4937
Use 763 samples. Get 1092 labels. Ratio: 0.6987179487179487
Epoch 10
 69.90% | time:   2.1s (  0.7m) | step:    202 | train acc: 0.781 | train loss: 0.538 |test acc: 0.670 (0.657, 0.683) | test eod gap: 0.2148
 69.90% | time:   0.2s (  0.7m) | step:    202 | train acc: 0.781 | train loss: 0.538 |val acc: 0.607 (0.629, 0.585) | val eod gap: 0.1898
begin calculating influence
[Strategy 5] Acc of expected label: 0.6409375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
770 labeled samples and 4167 unlabeled samples. Total: 4937
Use 770 samples. Get 1107 labels. Ratio: 0.6955736224028907
{'feature': array([[ 1.        ,  0.        ,  0.        ,  1.        , -0.4735933 ,
         0.        ,  0.20480779, -0.3085116 ],
       [ 0.        ,  1.        ,  0.        ,  1.        , -0.2627734 ,
         1.        , -1.2040232 , -0.30231762]], dtype=float32), 'label': array([0, 0], dtype=uint8), 'group': array([1, 0], dtype=uint8), 'index': array([3635, 1091])}
 73.01% | time:   1.6s (  0.7m) | step:    211 | train acc: 0.777 | train loss: 0.505 |test acc: 0.674 (0.669, 0.679) | test eod gap: 0.2123
 73.01% | time:   0.2s (  0.7m) | step:    211 | train acc: 0.777 | train loss: 0.505 |val acc: 0.619 (0.629, 0.610) | val eod gap: 0.1789
begin calculating influence
[Strategy 5] Acc of expected label: 0.6421875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
786 labeled samples and 4151 unlabeled samples. Total: 4937
Use 786 samples. Get 1140 labels. Ratio: 0.6894736842105263
Epoch 11
 76.82% | time:   2.2s (  0.7m) | step:    222 | train acc: 0.812 | train loss: 0.474 |test acc: 0.669 (0.663, 0.675) | test eod gap: 0.1980
 76.82% | time:   0.2s (  0.8m) | step:    222 | train acc: 0.812 | train loss: 0.474 |val acc: 0.607 (0.629, 0.585) | val eod gap: 0.1898
begin calculating influence
[Strategy 5] Acc of expected label: 0.638125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
799 labeled samples and 4138 unlabeled samples. Total: 4937
Use 799 samples. Get 1161 labels. Ratio: 0.6881998277347114
 79.93% | time:   1.8s (  0.8m) | step:    231 | train acc: 0.773 | train loss: 0.503 |test acc: 0.672 (0.653, 0.691) | test eod gap: 0.1960
 79.93% | time:   0.2s (  0.8m) | step:    231 | train acc: 0.773 | train loss: 0.503 |val acc: 0.603 (0.613, 0.593) | val eod gap: 0.1347
begin calculating influence
[Strategy 5] Acc of expected label: 0.628125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
831 labeled samples and 4106 unlabeled samples. Total: 4937
Use 831 samples. Get 1240 labels. Ratio: 0.6701612903225806
Epoch 12
 83.39% | time:   2.0s (  0.8m) | step:    241 | train acc: 0.809 | train loss: 0.502 |test acc: 0.667 (0.655, 0.679) | test eod gap: 0.1986
 83.39% | time:   0.2s (  0.8m) | step:    241 | train acc: 0.809 | train loss: 0.502 |val acc: 0.583 (0.597, 0.569) | val eod gap: 0.1622
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
841 labeled samples and 4096 unlabeled samples. Total: 4937
Use 841 samples. Get 1256 labels. Ratio: 0.6695859872611465
 86.51% | time:   1.8s (  0.9m) | step:    250 | train acc: 0.793 | train loss: 0.475 |test acc: 0.666 (0.655, 0.677) | test eod gap: 0.2088
 86.51% | time:   0.2s (  0.9m) | step:    250 | train acc: 0.793 | train loss: 0.475 |val acc: 0.599 (0.621, 0.577) | val eod gap: 0.1755
begin calculating influence
[Strategy 5] Acc of expected label: 0.6259375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
851 labeled samples and 4086 unlabeled samples. Total: 4937
Use 851 samples. Get 1272 labels. Ratio: 0.6690251572327044
Epoch 13
 89.97% | time:   2.0s (  0.9m) | step:    260 | train acc: 0.789 | train loss: 0.499 |test acc: 0.668 (0.653, 0.683) | test eod gap: 0.2072
 89.97% | time:   0.2s (  0.9m) | step:    260 | train acc: 0.789 | train loss: 0.499 |val acc: 0.595 (0.613, 0.577) | val eod gap: 0.1679
begin calculating influence
[Strategy 5] Acc of expected label: 0.6275
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
853 labeled samples and 4084 unlabeled samples. Total: 4937
Use 853 samples. Get 1278 labels. Ratio: 0.6674491392801252
 93.08% | time:   1.7s (  0.9m) | step:    269 | train acc: 0.801 | train loss: 0.466 |test acc: 0.665 (0.655, 0.675) | test eod gap: 0.2041
 93.08% | time:   0.2s (  0.9m) | step:    269 | train acc: 0.801 | train loss: 0.466 |val acc: 0.583 (0.597, 0.569) | val eod gap: 0.1464
begin calculating influence
[Strategy 5] Acc of expected label: 0.615625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
861 labeled samples and 4076 unlabeled samples. Total: 4937
Use 861 samples. Get 1295 labels. Ratio: 0.6648648648648648
Epoch 14
 96.54% | time:   1.8s (  1.0m) | step:    279 | train acc: 0.789 | train loss: 0.502 |test acc: 0.665 (0.655, 0.675) | test eod gap: 0.2041
 96.54% | time:   0.2s (  1.0m) | step:    279 | train acc: 0.789 | train loss: 0.502 |val acc: 0.583 (0.597, 0.569) | val eod gap: 0.1464
begin calculating influence
[Strategy 5] Acc of expected label: 0.62
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
868 labeled samples and 4069 unlabeled samples. Total: 4937
Use 868 samples. Get 1310 labels. Ratio: 0.6625954198473283
 99.65% | time:   1.7s (  1.0m) | step:    288 | train acc: 0.789 | train loss: 0.466 |test acc: 0.661 (0.653, 0.669) | test eod gap: 0.2094
 99.65% | time:   0.2s (  1.0m) | step:    288 | train acc: 0.789 | train loss: 0.466 |val acc: 0.583 (0.605, 0.561) | val eod gap: 0.1630
begin calculating influence
[Strategy 5] Acc of expected label: 0.6115625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
875 labeled samples and 4062 unlabeled samples. Total: 4937
Use 875 samples. Get 1326 labels. Ratio: 0.6598793363499246
