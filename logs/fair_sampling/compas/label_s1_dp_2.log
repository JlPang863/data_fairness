2023-02-08 23:09:05.512261: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.512334: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.512340: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.7s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test dp gap: 0.1658
begin calculating influence
selected layers: [Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
calculating influence -- done
  5.21% | time:   3.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val dp gap: 0.1993
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 525 labels. Ratio: 1.0
  9.90% | time:   2.0s (  0.2m) | step:     19 | train acc: 0.615 | train loss: 0.782 |test acc: 0.617 (0.604, 0.631) | test dp gap: 0.1559
begin calculating influence
calculating influence -- done
  9.90% | time:   1.1s (  0.2m) | step:     19 | train acc: 0.615 | train loss: 0.782 |val acc: 0.575 (0.597, 0.553) | val dp gap: 0.1904
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
557 labeled samples and 4380 unlabeled samples. Total: 4937
Use 557 samples. Get 557 labels. Ratio: 1.0
Epoch 1
 15.10% | time:   2.7s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.598 |test acc: 0.679 (0.655, 0.703) | test dp gap: 0.2704
begin calculating influence
calculating influence -- done
 15.10% | time:   0.9s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.598 |val acc: 0.632 (0.653, 0.610) | val dp gap: 0.2231
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
589 labeled samples and 4348 unlabeled samples. Total: 4937
Use 589 samples. Get 589 labels. Ratio: 1.0
 19.79% | time:   2.4s (  0.3m) | step:     38 | train acc: 0.695 | train loss: 0.607 |test acc: 0.678 (0.661, 0.695) | test dp gap: 0.2846
begin calculating influence
calculating influence -- done
 19.79% | time:   1.2s (  0.3m) | step:     38 | train acc: 0.695 | train loss: 0.607 |val acc: 0.628 (0.645, 0.610) | val dp gap: 0.2151
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 621 labels. Ratio: 1.0
Epoch 2
 25.00% | time:   2.6s (  0.3m) | step:     48 | train acc: 0.699 | train loss: 0.604 |test acc: 0.684 (0.669, 0.699) | test dp gap: 0.3332
begin calculating influence
calculating influence -- done
 25.00% | time:   1.0s (  0.4m) | step:     48 | train acc: 0.699 | train loss: 0.604 |val acc: 0.615 (0.653, 0.577) | val dp gap: 0.2231
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
653 labeled samples and 4284 unlabeled samples. Total: 4937
Use 653 samples. Get 653 labels. Ratio: 1.0
 29.69% | time:   2.1s (  0.4m) | step:     57 | train acc: 0.707 | train loss: 0.585 |test acc: 0.692 (0.676, 0.709) | test dp gap: 0.3208
begin calculating influence
calculating influence -- done
 29.69% | time:   1.2s (  0.4m) | step:     57 | train acc: 0.707 | train loss: 0.585 |val acc: 0.611 (0.645, 0.577) | val dp gap: 0.2152
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
685 labeled samples and 4252 unlabeled samples. Total: 4937
Use 685 samples. Get 685 labels. Ratio: 1.0
Epoch 3
 34.90% | time:   2.8s (  0.5m) | step:     67 | train acc: 0.648 | train loss: 0.626 |test acc: 0.693 (0.678, 0.709) | test dp gap: 0.3187
begin calculating influence
calculating influence -- done
 34.90% | time:   1.1s (  0.5m) | step:     67 | train acc: 0.648 | train loss: 0.626 |val acc: 0.615 (0.653, 0.577) | val dp gap: 0.2071
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
717 labeled samples and 4220 unlabeled samples. Total: 4937
Use 717 samples. Get 717 labels. Ratio: 1.0
 39.58% | time:   2.4s (  0.5m) | step:     76 | train acc: 0.684 | train loss: 0.598 |test acc: 0.686 (0.671, 0.701) | test dp gap: 0.3250
begin calculating influence
calculating influence -- done
 39.58% | time:   1.2s (  0.5m) | step:     76 | train acc: 0.684 | train loss: 0.598 |val acc: 0.607 (0.653, 0.561) | val dp gap: 0.1909
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
749 labeled samples and 4188 unlabeled samples. Total: 4937
Use 749 samples. Get 749 labels. Ratio: 1.0
Epoch 4
 45.31% | time:   1.7s (  0.6m) | step:     87 | train acc: 0.703 | train loss: 0.575 |test acc: 0.686 (0.671, 0.701) | test dp gap: 0.3250
begin calculating influence
calculating influence -- done
 45.31% | time:   1.1s (  0.6m) | step:     87 | train acc: 0.703 | train loss: 0.575 |val acc: 0.607 (0.653, 0.561) | val dp gap: 0.1909
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
781 labeled samples and 4156 unlabeled samples. Total: 4937
Use 781 samples. Get 781 labels. Ratio: 1.0
 50.00% | time:   1.3s (  0.6m) | step:     96 | train acc: 0.668 | train loss: 0.618 |test acc: 0.666 (0.653, 0.679) | test dp gap: 0.2900
begin calculating influence
calculating influence -- done
 50.00% | time:   1.3s (  0.6m) | step:     96 | train acc: 0.668 | train loss: 0.618 |val acc: 0.607 (0.629, 0.585) | val dp gap: 0.1577
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
813 labeled samples and 4124 unlabeled samples. Total: 4937
Use 813 samples. Get 813 labels. Ratio: 1.0
Epoch 5
 55.21% | time:   1.5s (  0.6m) | step:    106 | train acc: 0.688 | train loss: 0.600 |test acc: 0.687 (0.669, 0.705) | test dp gap: 0.3271
begin calculating influence
calculating influence -- done
 55.21% | time:   1.2s (  0.7m) | step:    106 | train acc: 0.688 | train loss: 0.600 |val acc: 0.607 (0.661, 0.553) | val dp gap: 0.1908
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
845 labeled samples and 4092 unlabeled samples. Total: 4937
Use 845 samples. Get 845 labels. Ratio: 1.0
 59.90% | time:   1.3s (  0.7m) | step:    115 | train acc: 0.676 | train loss: 0.636 |test acc: 0.686 (0.667, 0.705) | test dp gap: 0.3373
begin calculating influence
calculating influence -- done
 59.90% | time:   1.1s (  0.7m) | step:    115 | train acc: 0.676 | train loss: 0.636 |val acc: 0.599 (0.645, 0.553) | val dp gap: 0.2069
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
877 labeled samples and 4060 unlabeled samples. Total: 4937
Use 877 samples. Get 877 labels. Ratio: 1.0
Epoch 6
 65.10% | time:   1.4s (  0.7m) | step:    125 | train acc: 0.707 | train loss: 0.615 |test acc: 0.684 (0.667, 0.701) | test dp gap: 0.3372
begin calculating influence
calculating influence -- done
 65.10% | time:   1.0s (  0.7m) | step:    125 | train acc: 0.707 | train loss: 0.615 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
909 labeled samples and 4028 unlabeled samples. Total: 4937
Use 909 samples. Get 909 labels. Ratio: 1.0
 69.79% | time:   1.2s (  0.8m) | step:    134 | train acc: 0.691 | train loss: 0.611 |test acc: 0.685 (0.669, 0.701) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 69.79% | time:   1.1s (  0.8m) | step:    134 | train acc: 0.691 | train loss: 0.611 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
941 labeled samples and 3996 unlabeled samples. Total: 4937
Use 941 samples. Get 941 labels. Ratio: 1.0
Epoch 7
 75.00% | time:   1.4s (  0.8m) | step:    144 | train acc: 0.680 | train loss: 0.600 |test acc: 0.685 (0.669, 0.701) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 75.00% | time:   1.0s (  0.8m) | step:    144 | train acc: 0.680 | train loss: 0.600 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
973 labeled samples and 3964 unlabeled samples. Total: 4937
Use 973 samples. Get 973 labels. Ratio: 1.0
 79.69% | time:   1.3s (  0.8m) | step:    153 | train acc: 0.668 | train loss: 0.635 |test acc: 0.685 (0.669, 0.701) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 79.69% | time:   1.1s (  0.9m) | step:    153 | train acc: 0.668 | train loss: 0.635 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
1005 labeled samples and 3932 unlabeled samples. Total: 4937
Use 1005 samples. Get 1005 labels. Ratio: 1.0
Epoch 8
 85.42% | time:   1.3s (  0.9m) | step:    164 | train acc: 0.715 | train loss: 0.578 |test acc: 0.685 (0.669, 0.701) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 85.42% | time:   0.9s (  0.9m) | step:    164 | train acc: 0.715 | train loss: 0.578 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
1037 labeled samples and 3900 unlabeled samples. Total: 4937
Use 1037 samples. Get 1037 labels. Ratio: 1.0
 90.10% | time:   1.0s (  0.9m) | step:    173 | train acc: 0.664 | train loss: 0.617 |test acc: 0.685 (0.669, 0.701) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 90.10% | time:   0.9s (  0.9m) | step:    173 | train acc: 0.664 | train loss: 0.617 |val acc: 0.603 (0.645, 0.561) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
1069 labeled samples and 3868 unlabeled samples. Total: 4937
Use 1069 samples. Get 1069 labels. Ratio: 1.0
Epoch 9
 95.31% | time:   0.9s (  0.9m) | step:    183 | train acc: 0.733 | train loss: 0.600 |test acc: 0.687 (0.669, 0.705) | test dp gap: 0.3352
begin calculating influence
calculating influence -- done
 95.31% | time:   0.9s (  1.0m) | step:    183 | train acc: 0.733 | train loss: 0.600 |val acc: 0.603 (0.653, 0.553) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
1101 labeled samples and 3836 unlabeled samples. Total: 4937
Use 1101 samples. Get 1101 labels. Ratio: 1.0
100.00% | time:   0.8s (  1.0m) | step:    192 | train acc: 0.637 | train loss: 0.609 |test acc: 0.686 (0.667, 0.705) | test dp gap: 0.3373
begin calculating influence
calculating influence -- done
100.00% | time:   0.7s (  1.0m) | step:    192 | train acc: 0.637 | train loss: 0.609 |val acc: 0.603 (0.653, 0.553) | val dp gap: 0.1989
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
1133 labeled samples and 3804 unlabeled samples. Total: 4937
Use 1133 samples. Get 1133 labels. Ratio: 1.0
