2023-02-12 06:03:05.415492: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.415575: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 06:03:05.415582: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   3.5s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t eop gap: 0.1548
  3.46% | time:   1.3s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_v acc: 0.607 (0.613, 0.602) | warm_v eop gap: 0.1272
  6.57% | time:   1.1s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_t acc: 0.682 (0.659, 0.705) | warm_t eop gap: 0.2506
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.703 | train loss: 0.601 |warm_v acc: 0.619 (0.621, 0.618) | warm_v eop gap: 0.2856
Epoch 1
 10.03% | time:   1.3s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_t acc: 0.670 (0.651, 0.689) | warm_t eop gap: 0.2576
 10.03% | time:   0.2s (  0.1m) | step:     29 | train acc: 0.688 | train loss: 0.590 |warm_v acc: 0.640 (0.621, 0.659) | warm_v eop gap: 0.2027
 13.15% | time:   1.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_t acc: 0.674 (0.657, 0.691) | warm_t eop gap: 0.2663
 13.15% | time:   0.2s (  0.1m) | step:     38 | train acc: 0.672 | train loss: 0.581 |warm_v acc: 0.652 (0.621, 0.683) | warm_v eop gap: 0.1612
Epoch 2
 16.61% | time:   1.2s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_t acc: 0.673 (0.655, 0.691) | warm_t eop gap: 0.2639
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.734 | train loss: 0.567 |warm_v acc: 0.648 (0.629, 0.667) | warm_v eop gap: 0.1764
 19.72% | time:   1.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_t acc: 0.673 (0.653, 0.693) | warm_t eop gap: 0.2537
 19.72% | time:   0.2s (  0.2m) | step:     57 | train acc: 0.703 | train loss: 0.560 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eop gap: 0.2067
Epoch 3
 23.18% | time:   1.0s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_t acc: 0.668 (0.647, 0.689) | warm_t eop gap: 0.2411
 23.18% | time:   0.2s (  0.2m) | step:     67 | train acc: 0.692 | train loss: 0.559 |warm_v acc: 0.648 (0.645, 0.650) | warm_v eop gap: 0.1878
 26.30% | time:   1.1s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_t acc: 0.666 (0.647, 0.685) | warm_t eop gap: 0.2537
 26.30% | time:   0.2s (  0.2m) | step:     76 | train acc: 0.695 | train loss: 0.581 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eop gap: 0.1915
Epoch 4
 30.10% | time:   1.0s (  0.3m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_t acc: 0.665 (0.643, 0.687) | warm_t eop gap: 0.2301
 30.10% | time:   0.2s (  0.3m) | step:     87 | train acc: 0.696 | train loss: 0.580 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eop gap: 0.1915
 33.22% | time:   1.0s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_t acc: 0.665 (0.643, 0.687) | warm_t eop gap: 0.2301
 33.22% | time:   0.2s (  0.3m) | step:     96 | train acc: 0.715 | train loss: 0.567 |warm_v acc: 0.644 (0.645, 0.642) | warm_v eop gap: 0.1915
Epoch 5
 36.68% | time:   1.0s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |test acc: 0.667 (0.647, 0.687) | test eop gap: 0.2451
 36.68% | time:   0.2s (  0.3m) | step:    106 | train acc: 0.738 | train loss: 0.545 |val acc: 0.648 (0.645, 0.650) | val eop gap: 0.1727
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
Use 493 samples. Get 496 labels. Ratio: 0.9939516129032258
 39.79% | time:   2.6s (  0.3m) | step:    115 | train acc: 0.672 | train loss: 0.584 |test acc: 0.665 (0.643, 0.687) | test eop gap: 0.2411
 39.79% | time:   0.2s (  0.3m) | step:    115 | train acc: 0.672 | train loss: 0.584 |val acc: 0.652 (0.645, 0.659) | val eop gap: 0.1538
begin calculating influence
[Strategy 5] Acc of expected label: 0.6609375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 498 labels. Ratio: 0.9919678714859438
Epoch 6
 43.25% | time:   2.5s (  0.4m) | step:    125 | train acc: 0.693 | train loss: 0.575 |test acc: 0.666 (0.647, 0.685) | test eop gap: 0.2490
 43.25% | time:   0.2s (  0.4m) | step:    125 | train acc: 0.693 | train loss: 0.575 |val acc: 0.652 (0.645, 0.659) | val eop gap: 0.1538
begin calculating influence
[Strategy 5] Acc of expected label: 0.6746875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
 46.37% | time:   2.0s (  0.4m) | step:    134 | train acc: 0.691 | train loss: 0.583 |test acc: 0.664 (0.643, 0.685) | test eop gap: 0.2411
 46.37% | time:   0.2s (  0.4m) | step:    134 | train acc: 0.691 | train loss: 0.583 |val acc: 0.652 (0.645, 0.659) | val eop gap: 0.1538
begin calculating influence
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
Epoch 7
 49.83% | time:   2.0s (  0.5m) | step:    144 | train acc: 0.706 | train loss: 0.574 |test acc: 0.666 (0.643, 0.689) | test eop gap: 0.2317
 49.83% | time:   0.2s (  0.5m) | step:    144 | train acc: 0.706 | train loss: 0.574 |val acc: 0.652 (0.645, 0.659) | val eop gap: 0.1727
begin calculating influence
[Strategy 5] Acc of expected label: 0.6628125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
 52.94% | time:   2.1s (  0.5m) | step:    153 | train acc: 0.652 | train loss: 0.601 |test acc: 0.667 (0.643, 0.691) | test eop gap: 0.2278
 52.94% | time:   0.2s (  0.5m) | step:    153 | train acc: 0.652 | train loss: 0.601 |val acc: 0.660 (0.645, 0.675) | val eop gap: 0.1727
begin calculating influence
[Strategy 5] Acc of expected label: 0.668125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
Epoch 8
 56.75% | time:   1.9s (  0.5m) | step:    164 | train acc: 0.702 | train loss: 0.572 |test acc: 0.665 (0.641, 0.689) | test eop gap: 0.2239
 56.75% | time:   0.2s (  0.5m) | step:    164 | train acc: 0.702 | train loss: 0.572 |val acc: 0.660 (0.653, 0.667) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.6678125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
495 labeled samples and 4442 unlabeled samples. Total: 4937
Use 495 samples. Get 501 labels. Ratio: 0.9880239520958084
 59.86% | time:   2.4s (  0.6m) | step:    173 | train acc: 0.727 | train loss: 0.543 |test acc: 0.662 (0.635, 0.689) | test eop gap: 0.2184
 59.86% | time:   0.2s (  0.6m) | step:    173 | train acc: 0.727 | train loss: 0.543 |val acc: 0.660 (0.653, 0.667) | val eop gap: 0.1690
begin calculating influence
[Strategy 5] Acc of expected label: 0.6578125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
495 labeled samples and 4442 unlabeled samples. Total: 4937
Use 495 samples. Get 501 labels. Ratio: 0.9880239520958084
Epoch 9
 63.32% | time:   2.0s (  0.6m) | step:    183 | train acc: 0.699 | train loss: 0.565 |test acc: 0.663 (0.637, 0.689) | test eop gap: 0.2129
 63.32% | time:   0.3s (  0.6m) | step:    183 | train acc: 0.699 | train loss: 0.565 |val acc: 0.664 (0.661, 0.667) | val eop gap: 0.2030
begin calculating influence
[Strategy 5] Acc of expected label: 0.66625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
495 labeled samples and 4442 unlabeled samples. Total: 4937
Use 495 samples. Get 501 labels. Ratio: 0.9880239520958084
 66.44% | time:   1.8s (  0.6m) | step:    192 | train acc: 0.703 | train loss: 0.550 |test acc: 0.671 (0.639, 0.703) | test eop gap: 0.2121
 66.44% | time:   0.2s (  0.6m) | step:    192 | train acc: 0.703 | train loss: 0.550 |val acc: 0.664 (0.653, 0.675) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 503 labels. Ratio: 0.9860834990059643
Epoch 10
 69.90% | time:   2.4s (  0.7m) | step:    202 | train acc: 0.700 | train loss: 0.573 |test acc: 0.670 (0.633, 0.707) | test eop gap: 0.2011
 69.90% | time:   0.2s (  0.7m) | step:    202 | train acc: 0.700 | train loss: 0.573 |val acc: 0.656 (0.653, 0.659) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.67125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 504 labels. Ratio: 0.9841269841269841
 73.01% | time:   2.0s (  0.7m) | step:    211 | train acc: 0.688 | train loss: 0.566 |test acc: 0.669 (0.633, 0.705) | test eop gap: 0.2011
 73.01% | time:   0.2s (  0.7m) | step:    211 | train acc: 0.688 | train loss: 0.566 |val acc: 0.660 (0.653, 0.667) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.661875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 505 labels. Ratio: 0.9821782178217822
Epoch 11
 76.82% | time:   2.2s (  0.8m) | step:    222 | train acc: 0.692 | train loss: 0.572 |test acc: 0.669 (0.633, 0.705) | test eop gap: 0.2066
 76.82% | time:   0.2s (  0.8m) | step:    222 | train acc: 0.692 | train loss: 0.572 |val acc: 0.672 (0.669, 0.675) | val eop gap: 0.1841
begin calculating influence
[Strategy 5] Acc of expected label: 0.6684375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 506 labels. Ratio: 0.9802371541501976
 79.93% | time:   2.0s (  0.8m) | step:    231 | train acc: 0.664 | train loss: 0.597 |test acc: 0.670 (0.633, 0.707) | test eop gap: 0.2066
 79.93% | time:   0.2s (  0.8m) | step:    231 | train acc: 0.664 | train loss: 0.597 |val acc: 0.676 (0.677, 0.675) | val eop gap: 0.1841
begin calculating influence
[Strategy 5] Acc of expected label: 0.665625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 506 labels. Ratio: 0.9802371541501976
Epoch 12
 83.39% | time:   2.1s (  0.8m) | step:    241 | train acc: 0.692 | train loss: 0.577 |test acc: 0.670 (0.633, 0.707) | test eop gap: 0.2066
 83.39% | time:   0.1s (  0.8m) | step:    241 | train acc: 0.692 | train loss: 0.577 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.6715625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 508 labels. Ratio: 0.9763779527559056
 86.51% | time:   2.0s (  0.9m) | step:    250 | train acc: 0.711 | train loss: 0.561 |test acc: 0.670 (0.635, 0.705) | test eop gap: 0.2066
 86.51% | time:   0.2s (  0.9m) | step:    250 | train acc: 0.711 | train loss: 0.561 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.6678125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 508 labels. Ratio: 0.9763779527559056
Epoch 13
 89.97% | time:   2.2s (  0.9m) | step:    260 | train acc: 0.721 | train loss: 0.543 |test acc: 0.671 (0.635, 0.707) | test eop gap: 0.2066
 89.97% | time:   0.2s (  0.9m) | step:    260 | train acc: 0.721 | train loss: 0.543 |val acc: 0.664 (0.661, 0.667) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.67375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 509 labels. Ratio: 0.9744597249508841
 93.08% | time:   2.0s (  0.9m) | step:    269 | train acc: 0.699 | train loss: 0.580 |test acc: 0.674 (0.639, 0.709) | test eop gap: 0.2176
 93.08% | time:   0.2s (  0.9m) | step:    269 | train acc: 0.699 | train loss: 0.580 |val acc: 0.672 (0.669, 0.675) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.6703125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 509 labels. Ratio: 0.9744597249508841
Epoch 14
 96.54% | time:   1.8s (  1.0m) | step:    279 | train acc: 0.721 | train loss: 0.542 |test acc: 0.674 (0.641, 0.707) | test eop gap: 0.2137
 96.54% | time:   0.2s (  1.0m) | step:    279 | train acc: 0.721 | train loss: 0.542 |val acc: 0.664 (0.653, 0.675) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.673125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 509 labels. Ratio: 0.9744597249508841
 99.65% | time:   1.8s (  1.0m) | step:    288 | train acc: 0.715 | train loss: 0.557 |test acc: 0.673 (0.639, 0.707) | test eop gap: 0.2176
 99.65% | time:   0.1s (  1.0m) | step:    288 | train acc: 0.715 | train loss: 0.557 |val acc: 0.664 (0.653, 0.675) | val eop gap: 0.1878
begin calculating influence
[Strategy 5] Acc of expected label: 0.6740625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
497 labeled samples and 4440 unlabeled samples. Total: 4937
Use 497 samples. Get 510 labels. Ratio: 0.9745098039215686
