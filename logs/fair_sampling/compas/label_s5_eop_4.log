2023-02-12 04:09:22.638789: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.638899: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.638908: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   7.3s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t eop gap: 0.1548
  6.57% | time:   1.3s (  0.1m) | step:     19 | train acc: 0.715 | train loss: 0.581 |warm_t acc: 0.683 (0.659, 0.707) | warm_t eop gap: 0.2506
Epoch 1
 10.03% | time:   1.2s (  0.2m) | step:     29 | train acc: 0.646 | train loss: 0.624 |warm_t acc: 0.673 (0.651, 0.695) | warm_t eop gap: 0.2631
 13.15% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.664 | train loss: 0.593 |warm_t acc: 0.674 (0.657, 0.691) | warm_t eop gap: 0.2663
Epoch 2
 16.61% | time:   1.2s (  0.2m) | step:     48 | train acc: 0.688 | train loss: 0.603 |warm_t acc: 0.673 (0.655, 0.691) | warm_t eop gap: 0.2639
 19.72% | time:   1.1s (  0.2m) | step:     57 | train acc: 0.676 | train loss: 0.605 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eop gap: 0.2717
Epoch 3
 23.18% | time:   1.3s (  0.2m) | step:     67 | train acc: 0.654 | train loss: 0.599 |warm_t acc: 0.667 (0.649, 0.685) | warm_t eop gap: 0.2631
 26.30% | time:   1.2s (  0.3m) | step:     76 | train acc: 0.676 | train loss: 0.609 |warm_t acc: 0.667 (0.649, 0.685) | warm_t eop gap: 0.2537
Epoch 4
 30.10% | time:   1.3s (  0.3m) | step:     87 | train acc: 0.641 | train loss: 0.621 |warm_t acc: 0.664 (0.643, 0.685) | warm_t eop gap: 0.2403
 33.22% | time:   1.1s (  0.3m) | step:     96 | train acc: 0.672 | train loss: 0.579 |warm_t acc: 0.668 (0.645, 0.691) | warm_t eop gap: 0.2411
Epoch 5
 36.68% | time:   1.2s (  0.3m) | step:    106 | train acc: 0.675 | train loss: 0.574 |test acc: 0.669 (0.645, 0.693) | test eop gap: 0.2411
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6625
calculating influence -- done
 36.68% | time:   4.0s (  0.4m) | step:    106 | train acc: 0.675 | train loss: 0.574 |val acc: 0.648 (0.645, 0.650) | val eop gap: 0.1915
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
Use 493 samples. Get 497 labels. Ratio: 0.9919517102615694
 39.79% | time:   1.5s (  0.4m) | step:    115 | train acc: 0.730 | train loss: 0.548 |test acc: 0.666 (0.647, 0.685) | test eop gap: 0.2451
begin calculating influence
[Strategy 5] Acc of expected label: 0.6678125
calculating influence -- done
 39.79% | time:   1.3s (  0.4m) | step:    115 | train acc: 0.730 | train loss: 0.548 |val acc: 0.648 (0.645, 0.650) | val eop gap: 0.1727
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
Use 493 samples. Get 498 labels. Ratio: 0.9899598393574297
Epoch 6
 43.25% | time:   1.5s (  0.5m) | step:    125 | train acc: 0.734 | train loss: 0.534 |test acc: 0.666 (0.647, 0.685) | test eop gap: 0.2411
begin calculating influence
[Strategy 5] Acc of expected label: 0.6609375
calculating influence -- done
 43.25% | time:   1.0s (  0.5m) | step:    125 | train acc: 0.734 | train loss: 0.534 |val acc: 0.648 (0.645, 0.650) | val eop gap: 0.1727
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
Use 493 samples. Get 498 labels. Ratio: 0.9899598393574297
 46.37% | time:   1.3s (  0.5m) | step:    134 | train acc: 0.688 | train loss: 0.584 |test acc: 0.668 (0.645, 0.691) | test eop gap: 0.2372
begin calculating influence
[Strategy 5] Acc of expected label: 0.659375
calculating influence -- done
 46.37% | time:   1.0s (  0.5m) | step:    134 | train acc: 0.688 | train loss: 0.584 |val acc: 0.648 (0.645, 0.650) | val eop gap: 0.1915
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
Epoch 7
 49.83% | time:   2.3s (  0.6m) | step:    144 | train acc: 0.693 | train loss: 0.587 |test acc: 0.667 (0.645, 0.689) | test eop gap: 0.2356
begin calculating influence
[Strategy 5] Acc of expected label: 0.661875
calculating influence -- done
 49.83% | time:   1.2s (  0.6m) | step:    144 | train acc: 0.693 | train loss: 0.587 |val acc: 0.652 (0.645, 0.659) | val eop gap: 0.1538
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
 52.94% | time:   1.6s (  0.6m) | step:    153 | train acc: 0.691 | train loss: 0.574 |test acc: 0.667 (0.641, 0.693) | test eop gap: 0.2278
begin calculating influence
[Strategy 5] Acc of expected label: 0.664375
calculating influence -- done
 52.94% | time:   1.3s (  0.6m) | step:    153 | train acc: 0.691 | train loss: 0.574 |val acc: 0.656 (0.645, 0.667) | val eop gap: 0.1538
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
Epoch 8
 56.75% | time:   1.5s (  0.7m) | step:    164 | train acc: 0.664 | train loss: 0.610 |test acc: 0.669 (0.643, 0.695) | test eop gap: 0.2278
begin calculating influence
[Strategy 5] Acc of expected label: 0.6678125
calculating influence -- done
 56.75% | time:   1.1s (  0.7m) | step:    164 | train acc: 0.664 | train loss: 0.610 |val acc: 0.660 (0.645, 0.675) | val eop gap: 0.1727
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
 59.86% | time:   1.6s (  0.7m) | step:    173 | train acc: 0.711 | train loss: 0.563 |test acc: 0.662 (0.639, 0.685) | test eop gap: 0.2301
begin calculating influence
[Strategy 5] Acc of expected label: 0.6653125
calculating influence -- done
 59.86% | time:   1.2s (  0.7m) | step:    173 | train acc: 0.711 | train loss: 0.563 |val acc: 0.652 (0.653, 0.650) | val eop gap: 0.1690
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
Epoch 9
 63.32% | time:   1.5s (  0.7m) | step:    183 | train acc: 0.761 | train loss: 0.528 |test acc: 0.661 (0.637, 0.685) | test eop gap: 0.2262
begin calculating influence
[Strategy 5] Acc of expected label: 0.6634375
calculating influence -- done
 63.32% | time:   1.2s (  0.8m) | step:    183 | train acc: 0.761 | train loss: 0.528 |val acc: 0.652 (0.661, 0.642) | val eop gap: 0.1841
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 500 labels. Ratio: 0.988
 66.44% | time:   1.6s (  0.8m) | step:    192 | train acc: 0.691 | train loss: 0.581 |test acc: 0.666 (0.637, 0.695) | test eop gap: 0.2160
begin calculating influence
[Strategy 5] Acc of expected label: 0.6659375
calculating influence -- done
 66.44% | time:   1.3s (  0.8m) | step:    192 | train acc: 0.691 | train loss: 0.581 |val acc: 0.664 (0.653, 0.675) | val eop gap: 0.1878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 501 labels. Ratio: 0.9860279441117764
Epoch 10
 69.90% | time:   1.4s (  0.8m) | step:    202 | train acc: 0.727 | train loss: 0.525 |test acc: 0.667 (0.633, 0.701) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6690625
calculating influence -- done
 69.90% | time:   1.2s (  0.9m) | step:    202 | train acc: 0.727 | train loss: 0.525 |val acc: 0.656 (0.661, 0.650) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 501 labels. Ratio: 0.9860279441117764
 73.01% | time:   1.4s (  0.9m) | step:    211 | train acc: 0.711 | train loss: 0.570 |test acc: 0.670 (0.635, 0.705) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6734375
calculating influence -- done
 73.01% | time:   1.4s (  0.9m) | step:    211 | train acc: 0.711 | train loss: 0.570 |val acc: 0.664 (0.669, 0.659) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 501 labels. Ratio: 0.9860279441117764
Epoch 11
 76.82% | time:   1.6s (  0.9m) | step:    222 | train acc: 0.714 | train loss: 0.540 |test acc: 0.669 (0.635, 0.703) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6628125
calculating influence -- done
 76.82% | time:   1.2s (  0.9m) | step:    222 | train acc: 0.714 | train loss: 0.540 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1841
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
494 labeled samples and 4443 unlabeled samples. Total: 4937
Use 494 samples. Get 501 labels. Ratio: 0.9860279441117764
 79.93% | time:   1.5s (  1.0m) | step:    231 | train acc: 0.715 | train loss: 0.554 |test acc: 0.674 (0.639, 0.709) | test eop gap: 0.2231
begin calculating influence
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
 79.93% | time:   1.1s (  1.0m) | step:    231 | train acc: 0.715 | train loss: 0.554 |val acc: 0.660 (0.653, 0.667) | val eop gap: 0.2104
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 505 labels. Ratio: 0.9821782178217822
Epoch 12
 83.39% | time:   2.2s (  1.0m) | step:    241 | train acc: 0.713 | train loss: 0.551 |test acc: 0.674 (0.637, 0.711) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6640625
calculating influence -- done
 83.39% | time:   1.2s (  1.0m) | step:    241 | train acc: 0.713 | train loss: 0.551 |val acc: 0.664 (0.669, 0.659) | val eop gap: 0.2067
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 505 labels. Ratio: 0.9821782178217822
 86.51% | time:   1.6s (  1.1m) | step:    250 | train acc: 0.676 | train loss: 0.593 |test acc: 0.672 (0.635, 0.709) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6609375
calculating influence -- done
 86.51% | time:   1.2s (  1.1m) | step:    250 | train acc: 0.676 | train loss: 0.593 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 505 labels. Ratio: 0.9821782178217822
Epoch 13
 89.97% | time:   1.5s (  1.1m) | step:    260 | train acc: 0.700 | train loss: 0.554 |test acc: 0.674 (0.637, 0.711) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.66875
calculating influence -- done
 89.97% | time:   1.3s (  1.1m) | step:    260 | train acc: 0.700 | train loss: 0.554 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 507 labels. Ratio: 0.9783037475345168
 93.08% | time:   1.4s (  1.2m) | step:    269 | train acc: 0.676 | train loss: 0.601 |test acc: 0.671 (0.635, 0.707) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.6734375
calculating influence -- done
 93.08% | time:   1.2s (  1.2m) | step:    269 | train acc: 0.676 | train loss: 0.601 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.1878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
496 labeled samples and 4441 unlabeled samples. Total: 4937
Use 496 samples. Get 508 labels. Ratio: 0.9763779527559056
Epoch 14
 96.54% | time:   1.6s (  1.2m) | step:    279 | train acc: 0.683 | train loss: 0.594 |test acc: 0.671 (0.635, 0.707) | test eop gap: 0.2066
begin calculating influence
[Strategy 5] Acc of expected label: 0.67125
calculating influence -- done
 96.54% | time:   1.2s (  1.2m) | step:    279 | train acc: 0.683 | train loss: 0.594 |val acc: 0.664 (0.661, 0.667) | val eop gap: 0.1878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
497 labeled samples and 4440 unlabeled samples. Total: 4937
Use 497 samples. Get 509 labels. Ratio: 0.9764243614931237
 99.65% | time:   2.2s (  1.3m) | step:    288 | train acc: 0.680 | train loss: 0.583 |test acc: 0.673 (0.639, 0.707) | test eop gap: 0.2153
begin calculating influence
[Strategy 5] Acc of expected label: 0.670625
calculating influence -- done
 99.65% | time:   1.3s (  1.3m) | step:    288 | train acc: 0.680 | train loss: 0.583 |val acc: 0.668 (0.669, 0.667) | val eop gap: 0.2067
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
497 labeled samples and 4440 unlabeled samples. Total: 4937
Use 497 samples. Get 514 labels. Ratio: 0.9669260700389105
