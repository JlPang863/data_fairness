2023-02-08 23:09:05.514788: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.514842: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.514847: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.9s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test eop gap: 0.1095
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[6,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   2.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val eop gap: 0.1718
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   1.9s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test eop gap: 0.0700
begin calculating influence
[Strategy 5] Acc of expected label: 0.619375
calculating influence -- done
  9.90% | time:   0.9s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val eop gap: 0.1121
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   1.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test eop gap: 0.1469
begin calculating influence
[Strategy 5] Acc of expected label: 0.621875
calculating influence -- done
 15.10% | time:   0.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2596
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test eop gap: 0.1862
begin calculating influence
[Strategy 5] Acc of expected label: 0.6221875
calculating influence -- done
 19.79% | time:   1.2s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val eop gap: 0.2293
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.6s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test eop gap: 0.2034
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
 25.00% | time:   1.0s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.2181
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.7s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test eop gap: 0.1909
begin calculating influence
[Strategy 5] Acc of expected label: 0.62625
calculating influence -- done
 29.69% | time:   1.0s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val eop gap: 0.2407
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
527 labeled samples and 4410 unlabeled samples. Total: 4937
Use 527 samples. Get 498 labels. Ratio: 1.0582329317269077
Epoch 3
 34.90% | time:   2.3s (  0.4m) | step:     67 | train acc: 0.648 | train loss: 0.604 |test acc: 0.620 (0.627, 0.614) | test eop gap: 0.1955
begin calculating influence
[Strategy 5] Acc of expected label: 0.623125
calculating influence -- done
 34.90% | time:   0.8s (  0.4m) | step:     67 | train acc: 0.648 | train loss: 0.604 |val acc: 0.615 (0.653, 0.577) | val eop gap: 0.2181
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
527 labeled samples and 4410 unlabeled samples. Total: 4937
Use 527 samples. Get 498 labels. Ratio: 1.0582329317269077
 39.58% | time:   1.5s (  0.4m) | step:     76 | train acc: 0.645 | train loss: 0.631 |test acc: 0.615 (0.618, 0.612) | test eop gap: 0.1681
begin calculating influence
[Strategy 5] Acc of expected label: 0.6103125
calculating influence -- done
 39.58% | time:   1.0s (  0.4m) | step:     76 | train acc: 0.645 | train loss: 0.631 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
527 labeled samples and 4410 unlabeled samples. Total: 4937
Use 527 samples. Get 498 labels. Ratio: 1.0582329317269077
Epoch 4
 45.31% | time:   1.5s (  0.5m) | step:     87 | train acc: 0.656 | train loss: 0.617 |test acc: 0.629 (0.633, 0.624) | test eop gap: 0.1759
begin calculating influence
[Strategy 5] Acc of expected label: 0.62
calculating influence -- done
 45.31% | time:   1.2s (  0.5m) | step:     87 | train acc: 0.656 | train loss: 0.617 |val acc: 0.611 (0.645, 0.577) | val eop gap: 0.2067
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
527 labeled samples and 4410 unlabeled samples. Total: 4937
Use 527 samples. Get 498 labels. Ratio: 1.0582329317269077
 50.00% | time:   1.3s (  0.5m) | step:     96 | train acc: 0.637 | train loss: 0.630 |test acc: 0.624 (0.624, 0.624) | test eop gap: 0.1508
begin calculating influence
[Strategy 5] Acc of expected label: 0.6175
calculating influence -- done
 50.00% | time:   1.1s (  0.5m) | step:     96 | train acc: 0.637 | train loss: 0.630 |val acc: 0.599 (0.621, 0.577) | val eop gap: 0.1652
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
527 labeled samples and 4410 unlabeled samples. Total: 4937
Use 527 samples. Get 498 labels. Ratio: 1.0582329317269077
Epoch 5
 55.21% | time:   1.6s (  0.5m) | step:    106 | train acc: 0.688 | train loss: 0.616 |test acc: 0.672 (0.657, 0.687) | test eop gap: 0.2318
begin calculating influence
[Strategy 5] Acc of expected label: 0.665625
calculating influence -- done
 55.21% | time:   1.1s (  0.6m) | step:    106 | train acc: 0.688 | train loss: 0.616 |val acc: 0.623 (0.645, 0.602) | val eop gap: 0.2479
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
 59.90% | time:   2.1s (  0.6m) | step:    115 | train acc: 0.676 | train loss: 0.589 |test acc: 0.627 (0.618, 0.635) | test eop gap: 0.1422
begin calculating influence
[Strategy 5] Acc of expected label: 0.6221875
calculating influence -- done
 59.90% | time:   1.0s (  0.6m) | step:    115 | train acc: 0.676 | train loss: 0.589 |val acc: 0.587 (0.605, 0.569) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
Epoch 6
 65.10% | time:   1.9s (  0.6m) | step:    125 | train acc: 0.719 | train loss: 0.569 |test acc: 0.636 (0.631, 0.641) | test eop gap: 0.1822
begin calculating influence
[Strategy 5] Acc of expected label: 0.6271875
calculating influence -- done
 65.10% | time:   1.1s (  0.7m) | step:    125 | train acc: 0.719 | train loss: 0.569 |val acc: 0.599 (0.629, 0.569) | val eop gap: 0.2444
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
 69.79% | time:   1.4s (  0.7m) | step:    134 | train acc: 0.711 | train loss: 0.591 |test acc: 0.667 (0.653, 0.681) | test eop gap: 0.2050
begin calculating influence
[Strategy 5] Acc of expected label: 0.6528125
calculating influence -- done
 69.79% | time:   1.2s (  0.7m) | step:    134 | train acc: 0.711 | train loss: 0.591 |val acc: 0.619 (0.653, 0.585) | val eop gap: 0.2859
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
Epoch 7
 75.00% | time:   2.0s (  0.7m) | step:    144 | train acc: 0.676 | train loss: 0.594 |test acc: 0.612 (0.616, 0.608) | test eop gap: 0.1633
begin calculating influence
[Strategy 5] Acc of expected label: 0.613125
calculating influence -- done
 75.00% | time:   1.0s (  0.8m) | step:    144 | train acc: 0.676 | train loss: 0.594 |val acc: 0.595 (0.613, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
 79.69% | time:   1.5s (  0.8m) | step:    153 | train acc: 0.652 | train loss: 0.585 |test acc: 0.619 (0.624, 0.614) | test eop gap: 0.2034
begin calculating influence
[Strategy 5] Acc of expected label: 0.6171875
calculating influence -- done
 79.69% | time:   1.1s (  0.8m) | step:    153 | train acc: 0.652 | train loss: 0.585 |val acc: 0.611 (0.645, 0.577) | val eop gap: 0.2181
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
Epoch 8
 85.42% | time:   1.7s (  0.8m) | step:    164 | train acc: 0.680 | train loss: 0.587 |test acc: 0.615 (0.616, 0.614) | test eop gap: 0.1743
begin calculating influence
[Strategy 5] Acc of expected label: 0.611875
calculating influence -- done
 85.42% | time:   1.2s (  0.8m) | step:    164 | train acc: 0.680 | train loss: 0.587 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
 90.10% | time:   1.3s (  0.9m) | step:    173 | train acc: 0.656 | train loss: 0.613 |test acc: 0.612 (0.616, 0.608) | test eop gap: 0.1633
begin calculating influence
[Strategy 5] Acc of expected label: 0.616875
calculating influence -- done
 90.10% | time:   1.1s (  0.9m) | step:    173 | train acc: 0.656 | train loss: 0.613 |val acc: 0.599 (0.621, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
Epoch 9
 95.31% | time:   1.5s (  0.9m) | step:    183 | train acc: 0.645 | train loss: 0.635 |test acc: 0.615 (0.616, 0.614) | test eop gap: 0.1743
begin calculating influence
[Strategy 5] Acc of expected label: 0.6146875
calculating influence -- done
 95.31% | time:   0.9s (  0.9m) | step:    183 | train acc: 0.645 | train loss: 0.635 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
559 labeled samples and 4378 unlabeled samples. Total: 4937
Use 559 samples. Get 498 labels. Ratio: 1.1224899598393574
100.00% | time:   1.0s (  0.9m) | step:    192 | train acc: 0.699 | train loss: 0.589 |test acc: 0.657 (0.649, 0.665) | test eop gap: 0.2333
begin calculating influence
[Strategy 5] Acc of expected label: 0.64875
calculating influence -- done
100.00% | time:   0.8s (  1.0m) | step:    192 | train acc: 0.699 | train loss: 0.589 |val acc: 0.628 (0.661, 0.593) | val eop gap: 0.2822
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
560 labeled samples and 4377 unlabeled samples. Total: 4937
Use 560 samples. Get 502 labels. Ratio: 1.1155378486055776
