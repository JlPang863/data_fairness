2023-02-08 23:09:05.512912: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.512988: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.512995: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test dp gap: 0.1658
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[6,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   3.3s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val dp gap: 0.1993
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   1.6s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test dp gap: 0.1836
begin calculating influence
[Strategy 5] Acc of expected label: 0.619375
calculating influence -- done
  9.90% | time:   0.9s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val dp gap: 0.1412
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   1.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test dp gap: 0.2182
begin calculating influence
[Strategy 5] Acc of expected label: 0.621875
calculating influence -- done
 15.10% | time:   0.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val dp gap: 0.2303
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test dp gap: 0.2485
begin calculating influence
[Strategy 5] Acc of expected label: 0.6221875
calculating influence -- done
 19.79% | time:   1.1s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val dp gap: 0.2142
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.6s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test dp gap: 0.2595
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
 25.00% | time:   1.0s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val dp gap: 0.1895
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.4s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test dp gap: 0.2465
begin calculating influence
[Strategy 5] Acc of expected label: 0.62625
calculating influence -- done
 29.69% | time:   1.0s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val dp gap: 0.2141
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
540 labeled samples and 4397 unlabeled samples. Total: 4937
Use 540 samples. Get 525 labels. Ratio: 1.0285714285714285
Epoch 3
 34.90% | time:   2.3s (  0.4m) | step:     67 | train acc: 0.742 | train loss: 0.594 |test acc: 0.642 (0.637, 0.647) | test dp gap: 0.2383
begin calculating influence
[Strategy 5] Acc of expected label: 0.61875
calculating influence -- done
 34.90% | time:   1.0s (  0.4m) | step:     67 | train acc: 0.742 | train loss: 0.594 |val acc: 0.615 (0.645, 0.585) | val dp gap: 0.2061
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
540 labeled samples and 4397 unlabeled samples. Total: 4937
Use 540 samples. Get 526 labels. Ratio: 1.026615969581749
 39.58% | time:   1.5s (  0.4m) | step:     76 | train acc: 0.637 | train loss: 0.603 |test acc: 0.626 (0.633, 0.618) | test dp gap: 0.2229
begin calculating influence
[Strategy 5] Acc of expected label: 0.619375
calculating influence -- done
 39.58% | time:   1.0s (  0.4m) | step:     76 | train acc: 0.637 | train loss: 0.603 |val acc: 0.607 (0.637, 0.577) | val dp gap: 0.1736
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
540 labeled samples and 4397 unlabeled samples. Total: 4937
Use 540 samples. Get 526 labels. Ratio: 1.026615969581749
Epoch 4
 45.31% | time:   1.7s (  0.5m) | step:     87 | train acc: 0.711 | train loss: 0.621 |test acc: 0.665 (0.649, 0.681) | test dp gap: 0.2468
begin calculating influence
[Strategy 5] Acc of expected label: 0.646875
calculating influence -- done
 45.31% | time:   1.1s (  0.5m) | step:     87 | train acc: 0.711 | train loss: 0.621 |val acc: 0.640 (0.653, 0.626) | val dp gap: 0.2714
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 536 labels. Ratio: 1.0149253731343284
 50.00% | time:   2.4s (  0.5m) | step:     96 | train acc: 0.758 | train loss: 0.564 |test acc: 0.665 (0.653, 0.677) | test dp gap: 0.2552
begin calculating influence
[Strategy 5] Acc of expected label: 0.650625
calculating influence -- done
 50.00% | time:   1.3s (  0.5m) | step:     96 | train acc: 0.758 | train loss: 0.564 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.2470
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 541 labels. Ratio: 1.0055452865064696
Epoch 5
 55.21% | time:   1.8s (  0.6m) | step:    106 | train acc: 0.660 | train loss: 0.625 |test acc: 0.631 (0.622, 0.639) | test dp gap: 0.2123
begin calculating influence
[Strategy 5] Acc of expected label: 0.614375
calculating influence -- done
 55.21% | time:   1.1s (  0.6m) | step:    106 | train acc: 0.660 | train loss: 0.625 |val acc: 0.603 (0.629, 0.577) | val dp gap: 0.1815
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
544 labeled samples and 4393 unlabeled samples. Total: 4937
Use 544 samples. Get 541 labels. Ratio: 1.0055452865064696
 59.90% | time:   1.6s (  0.6m) | step:    115 | train acc: 0.699 | train loss: 0.607 |test acc: 0.664 (0.653, 0.675) | test dp gap: 0.2532
begin calculating influence
[Strategy 5] Acc of expected label: 0.64625
calculating influence -- done
 59.90% | time:   0.9s (  0.6m) | step:    115 | train acc: 0.699 | train loss: 0.607 |val acc: 0.632 (0.661, 0.602) | val dp gap: 0.2389
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
546 labeled samples and 4391 unlabeled samples. Total: 4937
Use 546 samples. Get 553 labels. Ratio: 0.9873417721518988
Epoch 6
 65.10% | time:   2.5s (  0.7m) | step:    125 | train acc: 0.680 | train loss: 0.608 |test acc: 0.676 (0.665, 0.687) | test dp gap: 0.2640
begin calculating influence
[Strategy 5] Acc of expected label: 0.6678125
calculating influence -- done
 65.10% | time:   1.2s (  0.7m) | step:    125 | train acc: 0.680 | train loss: 0.608 |val acc: 0.644 (0.661, 0.626) | val dp gap: 0.1991
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
578 labeled samples and 4359 unlabeled samples. Total: 4937
Use 578 samples. Get 576 labels. Ratio: 1.0034722222222223
 69.79% | time:   2.2s (  0.7m) | step:    134 | train acc: 0.684 | train loss: 0.600 |test acc: 0.620 (0.624, 0.616) | test dp gap: 0.2086
begin calculating influence
[Strategy 5] Acc of expected label: 0.613125
calculating influence -- done
 69.79% | time:   1.0s (  0.7m) | step:    134 | train acc: 0.684 | train loss: 0.600 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.1572
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
578 labeled samples and 4359 unlabeled samples. Total: 4937
Use 578 samples. Get 576 labels. Ratio: 1.0034722222222223
Epoch 7
 75.00% | time:   1.5s (  0.8m) | step:    144 | train acc: 0.727 | train loss: 0.572 |test acc: 0.616 (0.620, 0.612) | test dp gap: 0.2086
begin calculating influence
[Strategy 5] Acc of expected label: 0.601875
calculating influence -- done
 75.00% | time:   1.0s (  0.8m) | step:    144 | train acc: 0.727 | train loss: 0.572 |val acc: 0.615 (0.637, 0.593) | val dp gap: 0.1572
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
579 labeled samples and 4358 unlabeled samples. Total: 4937
Use 579 samples. Get 577 labels. Ratio: 1.0034662045060658
 79.69% | time:   2.2s (  0.8m) | step:    153 | train acc: 0.680 | train loss: 0.619 |test acc: 0.654 (0.653, 0.655) | test dp gap: 0.2536
begin calculating influence
[Strategy 5] Acc of expected label: 0.6475
calculating influence -- done
 79.69% | time:   0.9s (  0.8m) | step:    153 | train acc: 0.680 | train loss: 0.619 |val acc: 0.640 (0.669, 0.610) | val dp gap: 0.2065
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
581 labeled samples and 4356 unlabeled samples. Total: 4937
Use 581 samples. Get 587 labels. Ratio: 0.989778534923339
Epoch 8
 85.42% | time:   2.3s (  0.9m) | step:    164 | train acc: 0.734 | train loss: 0.604 |test acc: 0.650 (0.645, 0.655) | test dp gap: 0.2540
begin calculating influence
[Strategy 5] Acc of expected label: 0.6315625
calculating influence -- done
 85.42% | time:   1.0s (  0.9m) | step:    164 | train acc: 0.734 | train loss: 0.604 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.1818
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
581 labeled samples and 4356 unlabeled samples. Total: 4937
Use 581 samples. Get 587 labels. Ratio: 0.989778534923339
 90.10% | time:   1.2s (  0.9m) | step:    173 | train acc: 0.734 | train loss: 0.597 |test acc: 0.655 (0.653, 0.657) | test dp gap: 0.2679
begin calculating influence
[Strategy 5] Acc of expected label: 0.6490625
calculating influence -- done
 90.10% | time:   0.9s (  0.9m) | step:    173 | train acc: 0.734 | train loss: 0.597 |val acc: 0.636 (0.669, 0.602) | val dp gap: 0.1983
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
583 labeled samples and 4354 unlabeled samples. Total: 4937
Use 583 samples. Get 592 labels. Ratio: 0.9847972972972973
Epoch 9
 95.31% | time:   1.9s (  1.0m) | step:    183 | train acc: 0.691 | train loss: 0.607 |test acc: 0.617 (0.622, 0.612) | test dp gap: 0.2229
begin calculating influence
[Strategy 5] Acc of expected label: 0.6096875
calculating influence -- done
 95.31% | time:   0.8s (  1.0m) | step:    183 | train acc: 0.691 | train loss: 0.607 |val acc: 0.615 (0.645, 0.585) | val dp gap: 0.1410
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
583 labeled samples and 4354 unlabeled samples. Total: 4937
Use 583 samples. Get 592 labels. Ratio: 0.9847972972972973
100.00% | time:   1.1s (  1.0m) | step:    192 | train acc: 0.742 | train loss: 0.560 |test acc: 0.652 (0.647, 0.657) | test dp gap: 0.2541
begin calculating influence
[Strategy 5] Acc of expected label: 0.639375
calculating influence -- done
100.00% | time:   0.7s (  1.0m) | step:    192 | train acc: 0.742 | train loss: 0.560 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.1818
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
583 labeled samples and 4354 unlabeled samples. Total: 4937
Use 583 samples. Get 592 labels. Ratio: 0.9847972972972973
