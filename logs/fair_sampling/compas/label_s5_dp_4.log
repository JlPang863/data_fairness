2023-02-12 05:48:34.236018: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.236100: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.236106: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
246 labeled samples and 4691 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   4.2s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_t acc: 0.585 (0.610, 0.560) | warm_t dp gap: 0.1710
  3.46% | time:   1.4s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_v acc: 0.599 (0.573, 0.626) | warm_v dp gap: 0.1244
  6.57% | time:   1.8s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_t acc: 0.675 (0.649, 0.701) | warm_t dp gap: 0.3033
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_v acc: 0.648 (0.637, 0.659) | warm_v dp gap: 0.2551
Epoch 1
 10.03% | time:   2.0s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_t acc: 0.669 (0.657, 0.681) | warm_t dp gap: 0.3157
 10.03% | time:   0.2s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_v acc: 0.644 (0.613, 0.675) | warm_v dp gap: 0.2469
 13.15% | time:   2.0s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_t acc: 0.671 (0.657, 0.685) | warm_t dp gap: 0.3202
 13.15% | time:   0.2s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_v acc: 0.644 (0.621, 0.667) | warm_v dp gap: 0.2306
Epoch 2
 16.61% | time:   2.1s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_t acc: 0.658 (0.649, 0.667) | warm_t dp gap: 0.3064
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_v acc: 0.644 (0.621, 0.667) | warm_v dp gap: 0.2305
 19.72% | time:   1.8s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_t acc: 0.651 (0.641, 0.661) | warm_t dp gap: 0.3004
 19.72% | time:   0.2s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_v acc: 0.640 (0.629, 0.650) | warm_v dp gap: 0.2223
Epoch 3
 23.18% | time:   2.2s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_t acc: 0.648 (0.637, 0.659) | warm_t dp gap: 0.2903
 23.18% | time:   0.2s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_v acc: 0.644 (0.637, 0.650) | warm_v dp gap: 0.2303
 26.30% | time:   1.7s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_t acc: 0.655 (0.637, 0.673) | warm_t dp gap: 0.3124
 26.30% | time:   0.2s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_v acc: 0.636 (0.629, 0.642) | warm_v dp gap: 0.2143
Epoch 4
 30.10% | time:   2.1s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_t acc: 0.657 (0.639, 0.675) | warm_t dp gap: 0.3163
 30.10% | time:   0.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_v acc: 0.636 (0.629, 0.642) | warm_v dp gap: 0.2143
 33.22% | time:   1.7s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_t acc: 0.654 (0.637, 0.671) | warm_t dp gap: 0.3142
 33.22% | time:   0.2s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_v acc: 0.640 (0.637, 0.642) | warm_v dp gap: 0.2062
Epoch 5
 36.68% | time:   2.1s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |test acc: 0.655 (0.637, 0.673) | test dp gap: 0.3162
 36.68% | time:   0.2s (  0.5m) | step:    106 | train acc: 0.732 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val dp gap: 0.2062
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
278 labeled samples and 4659 unlabeled samples. Total: 4937
Use 278 samples. Get 304 labels. Ratio: 0.9144736842105263
 39.79% | time:   3.9s (  0.5m) | step:    115 | train acc: 0.727 | train loss: 0.567 |test acc: 0.670 (0.653, 0.687) | test dp gap: 0.3092
 39.79% | time:   0.2s (  0.5m) | step:    115 | train acc: 0.727 | train loss: 0.567 |val acc: 0.644 (0.645, 0.642) | val dp gap: 0.1988
begin calculating influence
[Strategy 5] Acc of expected label: 0.666875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
310 labeled samples and 4627 unlabeled samples. Total: 4937
Use 310 samples. Get 371 labels. Ratio: 0.8355795148247979
Epoch 6
 43.25% | time:   2.5s (  0.6m) | step:    125 | train acc: 0.759 | train loss: 0.560 |test acc: 0.677 (0.657, 0.697) | test dp gap: 0.2903
 43.25% | time:   0.2s (  0.6m) | step:    125 | train acc: 0.759 | train loss: 0.560 |val acc: 0.611 (0.613, 0.610) | val dp gap: 0.1992
begin calculating influence
[Strategy 5] Acc of expected label: 0.6671875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
342 labeled samples and 4595 unlabeled samples. Total: 4937
Use 342 samples. Get 455 labels. Ratio: 0.7516483516483516
 46.37% | time:   2.3s (  0.6m) | step:    134 | train acc: 0.812 | train loss: 0.515 |test acc: 0.671 (0.655, 0.687) | test dp gap: 0.2697
 46.37% | time:   0.2s (  0.6m) | step:    134 | train acc: 0.812 | train loss: 0.515 |val acc: 0.599 (0.589, 0.610) | val dp gap: 0.1751
begin calculating influence
[Strategy 5] Acc of expected label: 0.6546875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
374 labeled samples and 4563 unlabeled samples. Total: 4937
Use 374 samples. Get 527 labels. Ratio: 0.7096774193548387
Epoch 7
 49.83% | time:   2.3s (  0.6m) | step:    144 | train acc: 0.729 | train loss: 0.580 |test acc: 0.654 (0.631, 0.677) | test dp gap: 0.2432
 49.83% | time:   0.2s (  0.6m) | step:    144 | train acc: 0.729 | train loss: 0.580 |val acc: 0.599 (0.589, 0.610) | val dp gap: 0.1914
begin calculating influence
[Strategy 5] Acc of expected label: 0.651875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
406 labeled samples and 4531 unlabeled samples. Total: 4937
Use 406 samples. Get 601 labels. Ratio: 0.6755407653910149
 52.94% | time:   2.4s (  0.7m) | step:    153 | train acc: 0.809 | train loss: 0.509 |test acc: 0.639 (0.606, 0.671) | test dp gap: 0.2142
 52.94% | time:   0.2s (  0.7m) | step:    153 | train acc: 0.809 | train loss: 0.509 |val acc: 0.603 (0.637, 0.569) | val dp gap: 0.2311
begin calculating influence
[Strategy 5] Acc of expected label: 0.63
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
438 labeled samples and 4499 unlabeled samples. Total: 4937
Use 438 samples. Get 686 labels. Ratio: 0.6384839650145773
Epoch 8
 56.75% | time:   2.4s (  0.7m) | step:    164 | train acc: 0.824 | train loss: 0.477 |test acc: 0.638 (0.612, 0.663) | test dp gap: 0.2073
 56.75% | time:   0.2s (  0.7m) | step:    164 | train acc: 0.824 | train loss: 0.477 |val acc: 0.611 (0.637, 0.585) | val dp gap: 0.2315
begin calculating influence
[Strategy 5] Acc of expected label: 0.6178125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
470 labeled samples and 4467 unlabeled samples. Total: 4937
Use 470 samples. Get 757 labels. Ratio: 0.6208718626155878
 59.86% | time:   2.5s (  0.8m) | step:    173 | train acc: 0.859 | train loss: 0.432 |test acc: 0.635 (0.610, 0.659) | test dp gap: 0.2019
 59.86% | time:   0.2s (  0.8m) | step:    173 | train acc: 0.859 | train loss: 0.432 |val acc: 0.603 (0.613, 0.593) | val dp gap: 0.2312
begin calculating influence
[Strategy 5] Acc of expected label: 0.61375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
478 labeled samples and 4459 unlabeled samples. Total: 4937
Use 478 samples. Get 787 labels. Ratio: 0.6073697585768743
Epoch 9
 63.32% | time:   2.5s (  0.8m) | step:    183 | train acc: 0.829 | train loss: 0.464 |test acc: 0.637 (0.614, 0.659) | test dp gap: 0.1898
 63.32% | time:   0.2s (  0.8m) | step:    183 | train acc: 0.829 | train loss: 0.464 |val acc: 0.599 (0.605, 0.593) | val dp gap: 0.2231
begin calculating influence
[Strategy 5] Acc of expected label: 0.611875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
480 labeled samples and 4457 unlabeled samples. Total: 4937
Use 480 samples. Get 798 labels. Ratio: 0.6015037593984962
 66.44% | time:   2.5s (  0.9m) | step:    192 | train acc: 0.824 | train loss: 0.475 |test acc: 0.631 (0.620, 0.641) | test dp gap: 0.1934
 66.44% | time:   0.2s (  0.9m) | step:    192 | train acc: 0.824 | train loss: 0.475 |val acc: 0.603 (0.605, 0.602) | val dp gap: 0.2151
begin calculating influence
[Strategy 5] Acc of expected label: 0.626875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
487 labeled samples and 4450 unlabeled samples. Total: 4937
Use 487 samples. Get 811 labels. Ratio: 0.6004932182490752
Epoch 10
 69.90% | time:   2.7s (  0.9m) | step:    202 | train acc: 0.823 | train loss: 0.482 |test acc: 0.635 (0.624, 0.645) | test dp gap: 0.2056
 69.90% | time:   0.2s (  0.9m) | step:    202 | train acc: 0.823 | train loss: 0.482 |val acc: 0.603 (0.605, 0.602) | val dp gap: 0.2151
begin calculating influence
[Strategy 5] Acc of expected label: 0.6125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
Use 493 samples. Get 825 labels. Ratio: 0.5975757575757575
 73.01% | time:   2.5s (  1.0m) | step:    211 | train acc: 0.863 | train loss: 0.430 |test acc: 0.627 (0.624, 0.629) | test dp gap: 0.2015
 73.01% | time:   0.2s (  1.0m) | step:    211 | train acc: 0.863 | train loss: 0.430 |val acc: 0.607 (0.613, 0.602) | val dp gap: 0.2232
begin calculating influence
[Strategy 5] Acc of expected label: 0.61125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
498 labeled samples and 4439 unlabeled samples. Total: 4937
Use 498 samples. Get 835 labels. Ratio: 0.5964071856287425
Epoch 11
 76.82% | time:   2.5s (  1.0m) | step:    222 | train acc: 0.839 | train loss: 0.453 |test acc: 0.628 (0.629, 0.627) | test dp gap: 0.1953
 76.82% | time:   0.2s (  1.0m) | step:    222 | train acc: 0.839 | train loss: 0.453 |val acc: 0.611 (0.621, 0.602) | val dp gap: 0.2151
begin calculating influence
[Strategy 5] Acc of expected label: 0.6115625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
507 labeled samples and 4430 unlabeled samples. Total: 4937
Use 507 samples. Get 844 labels. Ratio: 0.6007109004739336
 79.93% | time:   2.4s (  1.1m) | step:    231 | train acc: 0.859 | train loss: 0.431 |test acc: 0.629 (0.624, 0.633) | test dp gap: 0.1933
 79.93% | time:   0.1s (  1.1m) | step:    231 | train acc: 0.859 | train loss: 0.431 |val acc: 0.607 (0.613, 0.602) | val dp gap: 0.1909
begin calculating influence
[Strategy 5] Acc of expected label: 0.6071875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
509 labeled samples and 4428 unlabeled samples. Total: 4937
Use 509 samples. Get 851 labels. Ratio: 0.5981198589894242
Epoch 12
 83.39% | time:   2.4s (  1.1m) | step:    241 | train acc: 0.846 | train loss: 0.447 |test acc: 0.629 (0.629, 0.629) | test dp gap: 0.1972
 83.39% | time:   0.2s (  1.1m) | step:    241 | train acc: 0.846 | train loss: 0.447 |val acc: 0.611 (0.613, 0.610) | val dp gap: 0.1828
begin calculating influence
[Strategy 5] Acc of expected label: 0.619375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
509 labeled samples and 4428 unlabeled samples. Total: 4937
Use 509 samples. Get 852 labels. Ratio: 0.5974178403755869
 86.51% | time:   1.9s (  1.1m) | step:    250 | train acc: 0.848 | train loss: 0.449 |test acc: 0.633 (0.629, 0.637) | test dp gap: 0.1972
 86.51% | time:   0.2s (  1.1m) | step:    250 | train acc: 0.848 | train loss: 0.449 |val acc: 0.611 (0.613, 0.610) | val dp gap: 0.1828
begin calculating influence
[Strategy 5] Acc of expected label: 0.605
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
512 labeled samples and 4425 unlabeled samples. Total: 4937
Use 512 samples. Get 858 labels. Ratio: 0.5967365967365967
Epoch 13
 89.97% | time:   2.0s (  1.2m) | step:    260 | train acc: 0.867 | train loss: 0.430 |test acc: 0.634 (0.629, 0.639) | test dp gap: 0.1992
 89.97% | time:   0.2s (  1.2m) | step:    260 | train acc: 0.867 | train loss: 0.430 |val acc: 0.611 (0.613, 0.610) | val dp gap: 0.1828
begin calculating influence
[Strategy 5] Acc of expected label: 0.61125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
515 labeled samples and 4422 unlabeled samples. Total: 4937
Use 515 samples. Get 861 labels. Ratio: 0.5981416957026713
 93.08% | time:   2.0s (  1.2m) | step:    269 | train acc: 0.667 | train loss: 0.564 |test acc: 0.618 (0.624, 0.612) | test dp gap: 0.1541
 93.08% | time:   0.2s (  1.2m) | step:    269 | train acc: 0.667 | train loss: 0.564 |val acc: 0.599 (0.621, 0.577) | val dp gap: 0.1739
begin calculating influence
[Strategy 5] Acc of expected label: 0.5996875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
547 labeled samples and 4390 unlabeled samples. Total: 4937
Use 547 samples. Get 936 labels. Ratio: 0.5844017094017094
Epoch 14
 96.54% | time:   2.1s (  1.2m) | step:    279 | train acc: 0.824 | train loss: 0.458 |test acc: 0.627 (0.631, 0.622) | test dp gap: 0.1732
 96.54% | time:   0.1s (  1.2m) | step:    279 | train acc: 0.824 | train loss: 0.458 |val acc: 0.591 (0.597, 0.585) | val dp gap: 0.1583
begin calculating influence
[Strategy 5] Acc of expected label: 0.605625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
552 labeled samples and 4385 unlabeled samples. Total: 4937
Use 552 samples. Get 946 labels. Ratio: 0.5835095137420718
 99.65% | time:   1.8s (  1.3m) | step:    288 | train acc: 0.863 | train loss: 0.379 |test acc: 0.612 (0.608, 0.616) | test dp gap: 0.1802
 99.65% | time:   0.2s (  1.3m) | step:    288 | train acc: 0.863 | train loss: 0.379 |val acc: 0.571 (0.565, 0.577) | val dp gap: 0.1992
begin calculating influence
[Strategy 5] Acc of expected label: 0.6025
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
584 labeled samples and 4353 unlabeled samples. Total: 4937
Use 584 samples. Get 1003 labels. Ratio: 0.5822532402791625
