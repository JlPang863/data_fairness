2023-02-12 04:09:22.638789: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.638900: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.638908: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   7.3s (  0.1m) | step:     10 | train acc: 0.641 | train loss: 0.654 |warm_t acc: 0.609 (0.608, 0.610) | warm_t dp gap: 0.1975
  6.57% | time:   1.3s (  0.1m) | step:     19 | train acc: 0.715 | train loss: 0.581 |warm_t acc: 0.683 (0.659, 0.707) | warm_t dp gap: 0.3068
Epoch 1
 10.03% | time:   1.2s (  0.2m) | step:     29 | train acc: 0.646 | train loss: 0.624 |warm_t acc: 0.673 (0.651, 0.695) | warm_t dp gap: 0.3193
 13.15% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.664 | train loss: 0.593 |warm_t acc: 0.674 (0.657, 0.691) | warm_t dp gap: 0.3176
Epoch 2
 16.61% | time:   1.1s (  0.2m) | step:     48 | train acc: 0.688 | train loss: 0.603 |warm_t acc: 0.673 (0.655, 0.691) | warm_t dp gap: 0.3239
 19.72% | time:   1.3s (  0.2m) | step:     57 | train acc: 0.676 | train loss: 0.605 |warm_t acc: 0.671 (0.657, 0.685) | warm_t dp gap: 0.3240
Epoch 3
 23.18% | time:   1.4s (  0.2m) | step:     67 | train acc: 0.654 | train loss: 0.599 |warm_t acc: 0.667 (0.649, 0.685) | warm_t dp gap: 0.3283
 26.30% | time:   1.3s (  0.3m) | step:     76 | train acc: 0.676 | train loss: 0.609 |warm_t acc: 0.667 (0.649, 0.685) | warm_t dp gap: 0.3202
Epoch 4
 30.10% | time:   1.3s (  0.3m) | step:     87 | train acc: 0.641 | train loss: 0.621 |warm_t acc: 0.664 (0.643, 0.685) | warm_t dp gap: 0.3142
 33.22% | time:   1.3s (  0.3m) | step:     96 | train acc: 0.672 | train loss: 0.579 |warm_t acc: 0.668 (0.645, 0.691) | warm_t dp gap: 0.3139
Epoch 5
 36.68% | time:   1.2s (  0.3m) | step:    106 | train acc: 0.675 | train loss: 0.574 |test acc: 0.669 (0.645, 0.693) | test dp gap: 0.3159
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6625
calculating influence -- done
 36.68% | time:   4.5s (  0.4m) | step:    106 | train acc: 0.675 | train loss: 0.574 |val acc: 0.648 (0.645, 0.650) | val dp gap: 0.2225
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 552 labels. Ratio: 0.9510869565217391
 39.79% | time:   1.9s (  0.4m) | step:    115 | train acc: 0.615 | train loss: 0.699 |test acc: 0.682 (0.651, 0.713) | test dp gap: 0.3331
begin calculating influence
[Strategy 5] Acc of expected label: 0.68125
calculating influence -- done
 39.79% | time:   1.2s (  0.5m) | step:    115 | train acc: 0.615 | train loss: 0.699 |val acc: 0.652 (0.629, 0.675) | val dp gap: 0.2960
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
557 labeled samples and 4380 unlabeled samples. Total: 4937
Use 557 samples. Get 622 labels. Ratio: 0.8954983922829582
Epoch 6
 43.25% | time:   1.8s (  0.5m) | step:    125 | train acc: 0.723 | train loss: 0.573 |test acc: 0.674 (0.639, 0.709) | test dp gap: 0.3173
begin calculating influence
[Strategy 5] Acc of expected label: 0.6615625
calculating influence -- done
 43.25% | time:   1.0s (  0.5m) | step:    125 | train acc: 0.723 | train loss: 0.573 |val acc: 0.648 (0.637, 0.659) | val dp gap: 0.2878
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
589 labeled samples and 4348 unlabeled samples. Total: 4937
Use 589 samples. Get 701 labels. Ratio: 0.8402282453637661
 46.37% | time:   1.6s (  0.5m) | step:    134 | train acc: 0.699 | train loss: 0.611 |test acc: 0.675 (0.647, 0.703) | test dp gap: 0.3191
begin calculating influence
[Strategy 5] Acc of expected label: 0.6578125
calculating influence -- done
 46.37% | time:   1.2s (  0.6m) | step:    134 | train acc: 0.699 | train loss: 0.611 |val acc: 0.652 (0.653, 0.650) | val dp gap: 0.3123
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
621 labeled samples and 4316 unlabeled samples. Total: 4937
Use 621 samples. Get 785 labels. Ratio: 0.7910828025477707
Epoch 7
 49.83% | time:   1.9s (  0.6m) | step:    144 | train acc: 0.742 | train loss: 0.562 |test acc: 0.669 (0.637, 0.701) | test dp gap: 0.2990
begin calculating influence
[Strategy 5] Acc of expected label: 0.660625
calculating influence -- done
 49.83% | time:   1.2s (  0.6m) | step:    144 | train acc: 0.742 | train loss: 0.562 |val acc: 0.648 (0.669, 0.626) | val dp gap: 0.3042
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
653 labeled samples and 4284 unlabeled samples. Total: 4937
Use 653 samples. Get 852 labels. Ratio: 0.7664319248826291
 52.94% | time:   1.9s (  0.6m) | step:    153 | train acc: 0.727 | train loss: 0.583 |test acc: 0.671 (0.631, 0.711) | test dp gap: 0.2906
begin calculating influence
[Strategy 5] Acc of expected label: 0.65875
calculating influence -- done
 52.94% | time:   1.1s (  0.7m) | step:    153 | train acc: 0.727 | train loss: 0.583 |val acc: 0.640 (0.661, 0.618) | val dp gap: 0.2720
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
676 labeled samples and 4261 unlabeled samples. Total: 4937
Use 676 samples. Get 902 labels. Ratio: 0.7494456762749445
Epoch 8
 56.75% | time:   2.2s (  0.7m) | step:    164 | train acc: 0.770 | train loss: 0.550 |test acc: 0.668 (0.635, 0.701) | test dp gap: 0.2924
begin calculating influence
[Strategy 5] Acc of expected label: 0.6528125
calculating influence -- done
 56.75% | time:   1.2s (  0.7m) | step:    164 | train acc: 0.770 | train loss: 0.550 |val acc: 0.636 (0.653, 0.618) | val dp gap: 0.2316
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
699 labeled samples and 4238 unlabeled samples. Total: 4937
Use 699 samples. Get 949 labels. Ratio: 0.7365648050579557
 59.86% | time:   2.1s (  0.7m) | step:    173 | train acc: 0.750 | train loss: 0.548 |test acc: 0.670 (0.643, 0.697) | test dp gap: 0.2888
begin calculating influence
[Strategy 5] Acc of expected label: 0.6465625
calculating influence -- done
 59.86% | time:   1.1s (  0.8m) | step:    173 | train acc: 0.750 | train loss: 0.548 |val acc: 0.648 (0.669, 0.626) | val dp gap: 0.2234
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
731 labeled samples and 4206 unlabeled samples. Total: 4937
Use 731 samples. Get 1022 labels. Ratio: 0.7152641878669276
Epoch 9
 63.32% | time:   2.0s (  0.8m) | step:    183 | train acc: 0.770 | train loss: 0.545 |test acc: 0.674 (0.647, 0.701) | test dp gap: 0.2763
begin calculating influence
[Strategy 5] Acc of expected label: 0.6409375
calculating influence -- done
 63.32% | time:   1.3s (  0.8m) | step:    183 | train acc: 0.770 | train loss: 0.545 |val acc: 0.636 (0.653, 0.618) | val dp gap: 0.2318
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
747 labeled samples and 4190 unlabeled samples. Total: 4937
Use 747 samples. Get 1049 labels. Ratio: 0.7121067683508103
 66.44% | time:   1.8s (  0.9m) | step:    192 | train acc: 0.820 | train loss: 0.507 |test acc: 0.669 (0.639, 0.699) | test dp gap: 0.2740
begin calculating influence
[Strategy 5] Acc of expected label: 0.636875
calculating influence -- done
 66.44% | time:   1.2s (  0.9m) | step:    192 | train acc: 0.820 | train loss: 0.507 |val acc: 0.644 (0.669, 0.618) | val dp gap: 0.1995
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
754 labeled samples and 4183 unlabeled samples. Total: 4937
Use 754 samples. Get 1072 labels. Ratio: 0.7033582089552238
Epoch 10
 69.90% | time:   2.2s (  0.9m) | step:    202 | train acc: 0.785 | train loss: 0.541 |test acc: 0.671 (0.641, 0.701) | test dp gap: 0.2822
begin calculating influence
[Strategy 5] Acc of expected label: 0.6334375
calculating influence -- done
 69.90% | time:   1.2s (  0.9m) | step:    202 | train acc: 0.785 | train loss: 0.541 |val acc: 0.636 (0.645, 0.626) | val dp gap: 0.2156
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
764 labeled samples and 4173 unlabeled samples. Total: 4937
Use 764 samples. Get 1095 labels. Ratio: 0.6977168949771689
 73.01% | time:   1.9s (  1.0m) | step:    211 | train acc: 0.793 | train loss: 0.502 |test acc: 0.672 (0.639, 0.705) | test dp gap: 0.2803
begin calculating influence
[Strategy 5] Acc of expected label: 0.631875
calculating influence -- done
 73.01% | time:   1.1s (  1.0m) | step:    211 | train acc: 0.793 | train loss: 0.502 |val acc: 0.632 (0.637, 0.626) | val dp gap: 0.1913
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
782 labeled samples and 4155 unlabeled samples. Total: 4937
Use 782 samples. Get 1131 labels. Ratio: 0.6914235190097259
Epoch 11
 76.82% | time:   1.9s (  1.0m) | step:    222 | train acc: 0.805 | train loss: 0.500 |test acc: 0.664 (0.633, 0.695) | test dp gap: 0.2803
begin calculating influence
[Strategy 5] Acc of expected label: 0.6328125
calculating influence -- done
 76.82% | time:   1.2s (  1.0m) | step:    222 | train acc: 0.805 | train loss: 0.500 |val acc: 0.619 (0.637, 0.602) | val dp gap: 0.1831
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
798 labeled samples and 4139 unlabeled samples. Total: 4937
Use 798 samples. Get 1163 labels. Ratio: 0.6861564918314703
 79.93% | time:   1.5s (  1.1m) | step:    231 | train acc: 0.801 | train loss: 0.492 |test acc: 0.665 (0.639, 0.691) | test dp gap: 0.2690
begin calculating influence
[Strategy 5] Acc of expected label: 0.644375
calculating influence -- done
 79.93% | time:   1.3s (  1.1m) | step:    231 | train acc: 0.801 | train loss: 0.492 |val acc: 0.648 (0.653, 0.642) | val dp gap: 0.1918
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
801 labeled samples and 4136 unlabeled samples. Total: 4937
Use 801 samples. Get 1169 labels. Ratio: 0.6852010265183918
Epoch 12
 83.39% | time:   1.6s (  1.1m) | step:    241 | train acc: 0.789 | train loss: 0.516 |test acc: 0.671 (0.643, 0.699) | test dp gap: 0.2816
begin calculating influence
[Strategy 5] Acc of expected label: 0.6275
calculating influence -- done
 83.39% | time:   1.2s (  1.1m) | step:    241 | train acc: 0.789 | train loss: 0.516 |val acc: 0.628 (0.637, 0.618) | val dp gap: 0.1834
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
811 labeled samples and 4126 unlabeled samples. Total: 4937
Use 811 samples. Get 1195 labels. Ratio: 0.6786610878661088
 86.51% | time:   1.6s (  1.1m) | step:    250 | train acc: 0.781 | train loss: 0.518 |test acc: 0.668 (0.635, 0.701) | test dp gap: 0.2879
begin calculating influence
[Strategy 5] Acc of expected label: 0.634375
calculating influence -- done
 86.51% | time:   1.3s (  1.2m) | step:    250 | train acc: 0.781 | train loss: 0.518 |val acc: 0.623 (0.637, 0.610) | val dp gap: 0.1914
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
843 labeled samples and 4094 unlabeled samples. Total: 4937
Use 843 samples. Get 1247 labels. Ratio: 0.6760224538893344
Epoch 13
 89.97% | time:   2.0s (  1.2m) | step:    260 | train acc: 0.832 | train loss: 0.485 |test acc: 0.674 (0.643, 0.705) | test dp gap: 0.2838
begin calculating influence
[Strategy 5] Acc of expected label: 0.6290625
calculating influence -- done
 89.97% | time:   1.2s (  1.2m) | step:    260 | train acc: 0.832 | train loss: 0.485 |val acc: 0.623 (0.637, 0.610) | val dp gap: 0.1914
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
855 labeled samples and 4082 unlabeled samples. Total: 4937
Use 855 samples. Get 1274 labels. Ratio: 0.6711145996860283
 93.08% | time:   1.8s (  1.3m) | step:    269 | train acc: 0.793 | train loss: 0.509 |test acc: 0.667 (0.635, 0.699) | test dp gap: 0.2698
begin calculating influence
[Strategy 5] Acc of expected label: 0.6184375
calculating influence -- done
 93.08% | time:   1.2s (  1.3m) | step:    269 | train acc: 0.793 | train loss: 0.509 |val acc: 0.628 (0.653, 0.602) | val dp gap: 0.1994
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
859 labeled samples and 4078 unlabeled samples. Total: 4937
Use 859 samples. Get 1283 labels. Ratio: 0.6695245518316446
Epoch 14
 96.54% | time:   1.9s (  1.3m) | step:    279 | train acc: 0.875 | train loss: 0.462 |test acc: 0.664 (0.631, 0.697) | test dp gap: 0.2558
begin calculating influence
[Strategy 5] Acc of expected label: 0.6128125
calculating influence -- done
 96.54% | time:   1.2s (  1.3m) | step:    279 | train acc: 0.875 | train loss: 0.462 |val acc: 0.619 (0.637, 0.602) | val dp gap: 0.1831
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
862 labeled samples and 4075 unlabeled samples. Total: 4937
Use 862 samples. Get 1288 labels. Ratio: 0.6692546583850931
 99.65% | time:   1.7s (  1.4m) | step:    288 | train acc: 0.781 | train loss: 0.510 |test acc: 0.667 (0.631, 0.703) | test dp gap: 0.2575
begin calculating influence
[Strategy 5] Acc of expected label: 0.61875
calculating influence -- done
 99.65% | time:   1.1s (  1.4m) | step:    288 | train acc: 0.781 | train loss: 0.510 |val acc: 0.619 (0.637, 0.602) | val dp gap: 0.1833
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
868 labeled samples and 4069 unlabeled samples. Total: 4937
Use 868 samples. Get 1304 labels. Ratio: 0.6656441717791411
