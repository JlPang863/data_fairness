2023-02-08 23:09:05.529620: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.529691: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.529697: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test eod gap: 0.1273
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[6,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 2] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   2.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val eod gap: 0.1871
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   1.7s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test eod gap: 0.1404
begin calculating influence
[Strategy 2] Acc of expected label: 0.619375
calculating influence -- done
  9.90% | time:   1.0s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val eod gap: 0.1248
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   1.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test eod gap: 0.1767
begin calculating influence
[Strategy 2] Acc of expected label: 0.621875
calculating influence -- done
 15.10% | time:   0.9s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.2128
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test eod gap: 0.2080
begin calculating influence
[Strategy 2] Acc of expected label: 0.6221875
calculating influence -- done
 19.79% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val eod gap: 0.1962
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.6s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test eod gap: 0.2200
begin calculating influence
[Strategy 2] Acc of expected label: 0.624375
calculating influence -- done
 25.00% | time:   1.3s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val eod gap: 0.1706
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.4s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test eod gap: 0.2050
begin calculating influence
[Strategy 2] Acc of expected label: 0.62625
calculating influence -- done
 29.69% | time:   1.1s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val eod gap: 0.1933
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
533 labeled samples and 4404 unlabeled samples. Total: 4937
Use 533 samples. Get 511 labels. Ratio: 1.0430528375733856
Epoch 3
 34.90% | time:   2.5s (  0.4m) | step:     67 | train acc: 0.648 | train loss: 0.613 |test acc: 0.620 (0.627, 0.614) | test eod gap: 0.2097
begin calculating influence
[Strategy 2] Acc of expected label: 0.625625
calculating influence -- done
 34.90% | time:   1.1s (  0.4m) | step:     67 | train acc: 0.648 | train loss: 0.613 |val acc: 0.615 (0.653, 0.577) | val eod gap: 0.1534
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
533 labeled samples and 4404 unlabeled samples. Total: 4937
Use 533 samples. Get 511 labels. Ratio: 1.0430528375733856
 39.58% | time:   1.6s (  0.4m) | step:     76 | train acc: 0.656 | train loss: 0.615 |test acc: 0.618 (0.618, 0.618) | test eod gap: 0.1908
begin calculating influence
[Strategy 2] Acc of expected label: 0.6140625
calculating influence -- done
 39.58% | time:   1.0s (  0.4m) | step:     76 | train acc: 0.656 | train loss: 0.615 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1457
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
533 labeled samples and 4404 unlabeled samples. Total: 4937
Use 533 samples. Get 511 labels. Ratio: 1.0430528375733856
Epoch 4
 45.31% | time:   1.7s (  0.5m) | step:     87 | train acc: 0.617 | train loss: 0.647 |test acc: 0.684 (0.673, 0.695) | test eod gap: 0.2320
begin calculating influence
[Strategy 2] Acc of expected label: 0.6628125
calculating influence -- done
 45.31% | time:   1.2s (  0.5m) | step:     87 | train acc: 0.617 | train loss: 0.647 |val acc: 0.640 (0.669, 0.610) | val eod gap: 0.1678
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
565 labeled samples and 4372 unlabeled samples. Total: 4937
Use 565 samples. Get 555 labels. Ratio: 1.018018018018018
 50.00% | time:   1.9s (  0.5m) | step:     96 | train acc: 0.641 | train loss: 0.622 |test acc: 0.616 (0.618, 0.614) | test eod gap: 0.1963
begin calculating influence
[Strategy 2] Acc of expected label: 0.6109375
calculating influence -- done
 50.00% | time:   1.2s (  0.5m) | step:     96 | train acc: 0.641 | train loss: 0.622 |val acc: 0.607 (0.637, 0.577) | val eod gap: 0.1371
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
565 labeled samples and 4372 unlabeled samples. Total: 4937
Use 565 samples. Get 555 labels. Ratio: 1.018018018018018
Epoch 5
 55.21% | time:   1.8s (  0.6m) | step:    106 | train acc: 0.691 | train loss: 0.618 |test acc: 0.618 (0.629, 0.608) | test eod gap: 0.2076
begin calculating influence
[Strategy 2] Acc of expected label: 0.621875
calculating influence -- done
 55.21% | time:   1.0s (  0.6m) | step:    106 | train acc: 0.691 | train loss: 0.618 |val acc: 0.615 (0.645, 0.585) | val eod gap: 0.1530
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
568 labeled samples and 4369 unlabeled samples. Total: 4937
Use 568 samples. Get 566 labels. Ratio: 1.0035335689045937
 59.90% | time:   2.5s (  0.6m) | step:    115 | train acc: 0.688 | train loss: 0.581 |test acc: 0.611 (0.618, 0.604) | test eod gap: 0.1954
begin calculating influence
[Strategy 2] Acc of expected label: 0.6121875
calculating influence -- done
 59.90% | time:   1.2s (  0.6m) | step:    115 | train acc: 0.688 | train loss: 0.581 |val acc: 0.591 (0.637, 0.545) | val eod gap: 0.1082
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
568 labeled samples and 4369 unlabeled samples. Total: 4937
Use 568 samples. Get 566 labels. Ratio: 1.0035335689045937
Epoch 6
 65.10% | time:   1.6s (  0.7m) | step:    125 | train acc: 0.680 | train loss: 0.626 |test acc: 0.626 (0.627, 0.624) | test eod gap: 0.1753
begin calculating influence
[Strategy 2] Acc of expected label: 0.619375
calculating influence -- done
 65.10% | time:   1.1s (  0.7m) | step:    125 | train acc: 0.680 | train loss: 0.626 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
568 labeled samples and 4369 unlabeled samples. Total: 4937
Use 568 samples. Get 566 labels. Ratio: 1.0035335689045937
 69.79% | time:   1.5s (  0.7m) | step:    134 | train acc: 0.730 | train loss: 0.590 |test acc: 0.652 (0.649, 0.655) | test eod gap: 0.2086
begin calculating influence
[Strategy 2] Acc of expected label: 0.6425
calculating influence -- done
 69.79% | time:   1.0s (  0.7m) | step:    134 | train acc: 0.730 | train loss: 0.590 |val acc: 0.619 (0.629, 0.610) | val eod gap: 0.1758
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
569 labeled samples and 4368 unlabeled samples. Total: 4937
Use 569 samples. Get 569 labels. Ratio: 1.0
Epoch 7
 75.00% | time:   2.5s (  0.8m) | step:    144 | train acc: 0.695 | train loss: 0.603 |test acc: 0.623 (0.629, 0.618) | test eod gap: 0.1816
begin calculating influence
[Strategy 2] Acc of expected label: 0.61875
calculating influence -- done
 75.00% | time:   1.2s (  0.8m) | step:    144 | train acc: 0.695 | train loss: 0.603 |val acc: 0.607 (0.629, 0.585) | val eod gap: 0.1371
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 574 labels. Ratio: 0.9947735191637631
 79.69% | time:   2.1s (  0.8m) | step:    153 | train acc: 0.672 | train loss: 0.611 |test acc: 0.623 (0.629, 0.618) | test eod gap: 0.1816
begin calculating influence
[Strategy 2] Acc of expected label: 0.619375
calculating influence -- done
 79.69% | time:   1.1s (  0.8m) | step:    153 | train acc: 0.672 | train loss: 0.611 |val acc: 0.607 (0.629, 0.585) | val eod gap: 0.1371
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 574 labels. Ratio: 0.9947735191637631
Epoch 8
 85.42% | time:   1.7s (  0.9m) | step:    164 | train acc: 0.695 | train loss: 0.604 |test acc: 0.622 (0.627, 0.618) | test eod gap: 0.1797
begin calculating influence
[Strategy 2] Acc of expected label: 0.61
calculating influence -- done
 85.42% | time:   1.1s (  0.9m) | step:    164 | train acc: 0.695 | train loss: 0.604 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1284
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 577 labels. Ratio: 0.9896013864818024
 90.10% | time:   1.3s (  0.9m) | step:    173 | train acc: 0.711 | train loss: 0.582 |test acc: 0.622 (0.627, 0.618) | test eod gap: 0.1797
begin calculating influence
[Strategy 2] Acc of expected label: 0.6096875
calculating influence -- done
 90.10% | time:   0.9s (  0.9m) | step:    173 | train acc: 0.711 | train loss: 0.582 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1284
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 577 labels. Ratio: 0.9896013864818024
Epoch 9
 95.31% | time:   1.4s (  1.0m) | step:    183 | train acc: 0.715 | train loss: 0.583 |test acc: 0.621 (0.627, 0.616) | test eod gap: 0.1824
begin calculating influence
[Strategy 2] Acc of expected label: 0.6109375
calculating influence -- done
 95.31% | time:   0.8s (  1.0m) | step:    183 | train acc: 0.715 | train loss: 0.583 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1284
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
572 labeled samples and 4365 unlabeled samples. Total: 4937
Use 572 samples. Get 580 labels. Ratio: 0.9862068965517241
100.00% | time:   1.6s (  1.0m) | step:    192 | train acc: 0.664 | train loss: 0.615 |test acc: 0.618 (0.624, 0.612) | test eod gap: 0.1696
begin calculating influence
[Strategy 2] Acc of expected label: 0.611875
calculating influence -- done
100.00% | time:   0.7s (  1.0m) | step:    192 | train acc: 0.664 | train loss: 0.615 |val acc: 0.615 (0.629, 0.602) | val eod gap: 0.1351
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
572 labeled samples and 4365 unlabeled samples. Total: 4937
Use 572 samples. Get 580 labels. Ratio: 0.9862068965517241
