2023-02-12 05:48:34.300558: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.300658: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.300665: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
246 labeled samples and 4691 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   4.2s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_t acc: 0.585 (0.610, 0.560) | warm_t eop gap: 0.1485
  3.46% | time:   1.3s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_v acc: 0.599 (0.573, 0.626) | warm_v eop gap: 0.0217
  6.57% | time:   1.8s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_t acc: 0.675 (0.649, 0.701) | warm_t eop gap: 0.2302
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_v acc: 0.648 (0.637, 0.659) | warm_v eop gap: 0.2141
Epoch 1
 10.03% | time:   2.1s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_t acc: 0.669 (0.657, 0.681) | warm_t eop gap: 0.2741
 10.03% | time:   0.2s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_v acc: 0.644 (0.613, 0.675) | warm_v eop gap: 0.1612
 13.15% | time:   1.7s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eop gap: 0.2631
 13.15% | time:   0.2s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eop gap: 0.1575
Epoch 2
 16.61% | time:   2.0s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_t acc: 0.658 (0.649, 0.667) | warm_t eop gap: 0.2544
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eop gap: 0.1538
 19.72% | time:   1.8s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_t acc: 0.651 (0.641, 0.661) | warm_t eop gap: 0.2450
 19.72% | time:   0.2s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_v acc: 0.640 (0.629, 0.650) | warm_v eop gap: 0.1690
Epoch 3
 23.18% | time:   2.1s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_t acc: 0.648 (0.637, 0.659) | warm_t eop gap: 0.2317
 23.18% | time:   0.2s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_v acc: 0.644 (0.637, 0.650) | warm_v eop gap: 0.1841
 26.30% | time:   1.8s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_t acc: 0.655 (0.637, 0.673) | warm_t eop gap: 0.2427
 26.30% | time:   0.2s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eop gap: 0.1727
Epoch 4
 30.10% | time:   2.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_t acc: 0.657 (0.639, 0.675) | warm_t eop gap: 0.2498
 30.10% | time:   0.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eop gap: 0.1727
 33.22% | time:   1.8s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_t acc: 0.654 (0.637, 0.671) | warm_t eop gap: 0.2529
 33.22% | time:   0.2s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_v acc: 0.640 (0.637, 0.642) | warm_v eop gap: 0.1727
Epoch 5
 36.68% | time:   2.2s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |test acc: 0.655 (0.637, 0.673) | test eop gap: 0.2529
 36.68% | time:   0.2s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val eop gap: 0.1727
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 2] Acc of expected label: 0.6625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
254 labeled samples and 4683 unlabeled samples. Total: 4937
Use 254 samples. Get 279 labels. Ratio: 0.910394265232975
 39.79% | time:   3.5s (  0.5m) | step:    115 | train acc: 0.732 | train loss: 0.556 |test acc: 0.658 (0.641, 0.675) | test eop gap: 0.2584
 39.79% | time:   0.2s (  0.5m) | step:    115 | train acc: 0.732 | train loss: 0.556 |val acc: 0.636 (0.629, 0.642) | val eop gap: 0.1612
begin calculating influence
[Strategy 2] Acc of expected label: 0.6590625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
270 labeled samples and 4667 unlabeled samples. Total: 4937
Use 270 samples. Get 320 labels. Ratio: 0.84375
Epoch 6
 43.25% | time:   2.8s (  0.6m) | step:    125 | train acc: 0.571 | train loss: 0.757 |test acc: 0.660 (0.631, 0.689) | test eop gap: 0.2200
 43.25% | time:   0.2s (  0.6m) | step:    125 | train acc: 0.571 | train loss: 0.757 |val acc: 0.640 (0.629, 0.650) | val eop gap: 0.1950
begin calculating influence
[Strategy 2] Acc of expected label: 0.644375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
302 labeled samples and 4635 unlabeled samples. Total: 4937
Use 302 samples. Get 408 labels. Ratio: 0.7401960784313726
 46.37% | time:   2.5s (  0.6m) | step:    134 | train acc: 0.793 | train loss: 0.523 |test acc: 0.633 (0.606, 0.659) | test eop gap: 0.1752
 46.37% | time:   0.3s (  0.6m) | step:    134 | train acc: 0.793 | train loss: 0.523 |val acc: 0.640 (0.629, 0.650) | val eop gap: 0.1387
begin calculating influence
[Strategy 2] Acc of expected label: 0.6440625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
332 labeled samples and 4605 unlabeled samples. Total: 4937
Use 332 samples. Get 504 labels. Ratio: 0.6587301587301587
Epoch 7
 49.83% | time:   2.5s (  0.6m) | step:    144 | train acc: 0.842 | train loss: 0.472 |test acc: 0.617 (0.596, 0.639) | test eop gap: 0.1682
 49.83% | time:   0.2s (  0.6m) | step:    144 | train acc: 0.842 | train loss: 0.472 |val acc: 0.632 (0.629, 0.634) | val eop gap: 0.1612
begin calculating influence
[Strategy 2] Acc of expected label: 0.615
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
336 labeled samples and 4601 unlabeled samples. Total: 4937
Use 336 samples. Get 512 labels. Ratio: 0.65625
 52.94% | time:   2.5s (  0.7m) | step:    153 | train acc: 0.754 | train loss: 0.516 |test acc: 0.614 (0.598, 0.631) | test eop gap: 0.1666
 52.94% | time:   0.2s (  0.7m) | step:    153 | train acc: 0.754 | train loss: 0.516 |val acc: 0.628 (0.613, 0.642) | val eop gap: 0.1272
begin calculating influence
[Strategy 2] Acc of expected label: 0.6215625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
338 labeled samples and 4599 unlabeled samples. Total: 4937
Use 338 samples. Get 517 labels. Ratio: 0.6537717601547389
Epoch 8
 56.75% | time:   2.6s (  0.7m) | step:    164 | train acc: 0.805 | train loss: 0.453 |test acc: 0.618 (0.606, 0.631) | test eop gap: 0.1949
 56.75% | time:   0.2s (  0.7m) | step:    164 | train acc: 0.805 | train loss: 0.453 |val acc: 0.623 (0.613, 0.634) | val eop gap: 0.1461
begin calculating influence
[Strategy 2] Acc of expected label: 0.616875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
342 labeled samples and 4595 unlabeled samples. Total: 4937
Use 342 samples. Get 532 labels. Ratio: 0.6428571428571429
 59.86% | time:   2.5s (  0.8m) | step:    173 | train acc: 0.812 | train loss: 0.483 |test acc: 0.624 (0.612, 0.637) | test eop gap: 0.1964
 59.86% | time:   0.2s (  0.8m) | step:    173 | train acc: 0.812 | train loss: 0.483 |val acc: 0.628 (0.637, 0.618) | val eop gap: 0.1838
begin calculating influence
[Strategy 2] Acc of expected label: 0.6315625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
346 labeled samples and 4591 unlabeled samples. Total: 4937
Use 346 samples. Get 547 labels. Ratio: 0.6325411334552102
Epoch 9
 63.32% | time:   2.3s (  0.8m) | step:    183 | train acc: 0.778 | train loss: 0.495 |test acc: 0.627 (0.610, 0.643) | test eop gap: 0.1863
 63.32% | time:   0.2s (  0.8m) | step:    183 | train acc: 0.778 | train loss: 0.495 |val acc: 0.632 (0.629, 0.634) | val eop gap: 0.1724
begin calculating influence
[Strategy 2] Acc of expected label: 0.6253125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
347 labeled samples and 4590 unlabeled samples. Total: 4937
Use 347 samples. Get 555 labels. Ratio: 0.6252252252252253
 66.44% | time:   2.4s (  0.9m) | step:    192 | train acc: 0.770 | train loss: 0.490 |test acc: 0.623 (0.608, 0.639) | test eop gap: 0.1886
 66.44% | time:   0.3s (  0.9m) | step:    192 | train acc: 0.770 | train loss: 0.490 |val acc: 0.632 (0.637, 0.626) | val eop gap: 0.1687
begin calculating influence
[Strategy 2] Acc of expected label: 0.628125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
348 labeled samples and 4589 unlabeled samples. Total: 4937
Use 348 samples. Get 559 labels. Ratio: 0.6225402504472272
Epoch 10
 69.90% | time:   2.4s (  0.9m) | step:    202 | train acc: 0.859 | train loss: 0.411 |test acc: 0.622 (0.612, 0.633) | test eop gap: 0.1863
 69.90% | time:   0.2s (  0.9m) | step:    202 | train acc: 0.859 | train loss: 0.411 |val acc: 0.640 (0.637, 0.642) | val eop gap: 0.1535
begin calculating influence
[Strategy 2] Acc of expected label: 0.621875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
350 labeled samples and 4587 unlabeled samples. Total: 4937
Use 350 samples. Get 562 labels. Ratio: 0.6227758007117438
 73.01% | time:   2.4s (  1.0m) | step:    211 | train acc: 0.805 | train loss: 0.466 |test acc: 0.619 (0.608, 0.631) | test eop gap: 0.1910
 73.01% | time:   0.1s (  1.0m) | step:    211 | train acc: 0.805 | train loss: 0.466 |val acc: 0.636 (0.637, 0.634) | val eop gap: 0.1761
begin calculating influence
[Strategy 2] Acc of expected label: 0.625625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
366 labeled samples and 4571 unlabeled samples. Total: 4937
Use 366 samples. Get 594 labels. Ratio: 0.6161616161616161
Epoch 11
 76.82% | time:   2.4s (  1.0m) | step:    222 | train acc: 0.791 | train loss: 0.471 |test acc: 0.618 (0.604, 0.633) | test eop gap: 0.1910
 76.82% | time:   0.2s (  1.0m) | step:    222 | train acc: 0.791 | train loss: 0.471 |val acc: 0.636 (0.637, 0.634) | val eop gap: 0.1650
begin calculating influence
[Strategy 2] Acc of expected label: 0.625625
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
370 labeled samples and 4567 unlabeled samples. Total: 4937
Use 370 samples. Get 621 labels. Ratio: 0.5958132045088567
 79.93% | time:   2.2s (  1.0m) | step:    231 | train acc: 0.785 | train loss: 0.496 |test acc: 0.621 (0.610, 0.633) | test eop gap: 0.2004
 79.93% | time:   0.2s (  1.0m) | step:    231 | train acc: 0.785 | train loss: 0.496 |val acc: 0.636 (0.637, 0.634) | val eop gap: 0.1650
begin calculating influence
[Strategy 2] Acc of expected label: 0.6196875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
372 labeled samples and 4565 unlabeled samples. Total: 4937
Use 372 samples. Get 629 labels. Ratio: 0.5914149443561209
Epoch 12
 83.39% | time:   2.4s (  1.1m) | step:    241 | train acc: 0.810 | train loss: 0.438 |test acc: 0.616 (0.604, 0.629) | test eop gap: 0.1980
 83.39% | time:   0.2s (  1.1m) | step:    241 | train acc: 0.810 | train loss: 0.438 |val acc: 0.636 (0.629, 0.642) | val eop gap: 0.1346
begin calculating influence
[Strategy 2] Acc of expected label: 0.62
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
373 labeled samples and 4564 unlabeled samples. Total: 4937
Use 373 samples. Get 632 labels. Ratio: 0.5901898734177216
 86.51% | time:   2.3s (  1.1m) | step:    250 | train acc: 0.797 | train loss: 0.466 |test acc: 0.621 (0.610, 0.633) | test eop gap: 0.1878
 86.51% | time:   0.2s (  1.1m) | step:    250 | train acc: 0.797 | train loss: 0.466 |val acc: 0.644 (0.645, 0.642) | val eop gap: 0.1272
begin calculating influence
[Strategy 2] Acc of expected label: 0.6196875
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
376 labeled samples and 4561 unlabeled samples. Total: 4937
Use 376 samples. Get 637 labels. Ratio: 0.5902668759811617
Epoch 13
 89.97% | time:   2.4s (  1.2m) | step:    260 | train acc: 0.817 | train loss: 0.438 |test acc: 0.615 (0.602, 0.629) | test eop gap: 0.1847
 89.97% | time:   0.2s (  1.2m) | step:    260 | train acc: 0.817 | train loss: 0.438 |val acc: 0.632 (0.629, 0.634) | val eop gap: 0.1346
begin calculating influence
[Strategy 2] Acc of expected label: 0.6259375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
376 labeled samples and 4561 unlabeled samples. Total: 4937
Use 376 samples. Get 640 labels. Ratio: 0.5875
 93.08% | time:   1.9s (  1.2m) | step:    269 | train acc: 0.816 | train loss: 0.446 |test acc: 0.619 (0.606, 0.633) | test eop gap: 0.1705
 93.08% | time:   0.2s (  1.2m) | step:    269 | train acc: 0.816 | train loss: 0.446 |val acc: 0.636 (0.637, 0.634) | val eop gap: 0.1309
begin calculating influence
[Strategy 2] Acc of expected label: 0.6253125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
377 labeled samples and 4560 unlabeled samples. Total: 4937
Use 377 samples. Get 641 labels. Ratio: 0.5881435257410297
Epoch 14
 96.54% | time:   2.1s (  1.2m) | step:    279 | train acc: 0.802 | train loss: 0.453 |test acc: 0.621 (0.604, 0.639) | test eop gap: 0.1713
 96.54% | time:   0.2s (  1.2m) | step:    279 | train acc: 0.802 | train loss: 0.453 |val acc: 0.628 (0.629, 0.626) | val eop gap: 0.1346
begin calculating influence
[Strategy 2] Acc of expected label: 0.6253125
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
377 labeled samples and 4560 unlabeled samples. Total: 4937
Use 377 samples. Get 642 labels. Ratio: 0.5872274143302181
 99.65% | time:   1.7s (  1.3m) | step:    288 | train acc: 0.789 | train loss: 0.452 |test acc: 0.620 (0.606, 0.635) | test eop gap: 0.1784
 99.65% | time:   0.2s (  1.3m) | step:    288 | train acc: 0.789 | train loss: 0.452 |val acc: 0.636 (0.637, 0.634) | val eop gap: 0.1498
begin calculating influence
[Strategy 2] Acc of expected label: 0.6209375
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
377 labeled samples and 4560 unlabeled samples. Total: 4937
Use 377 samples. Get 642 labels. Ratio: 0.5872274143302181
