2023-02-12 04:09:22.643349: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.643429: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 04:09:22.643438: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
246 labeled samples and 4691 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   7.5s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_t acc: 0.585 (0.610, 0.560) | warm_t eod gap: 0.1419
  6.57% | time:   2.1s (  0.2m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_t acc: 0.675 (0.649, 0.701) | warm_t eod gap: 0.2527
Epoch 1
 10.03% | time:   2.1s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_t acc: 0.669 (0.657, 0.681) | warm_t eod gap: 0.2699
 13.15% | time:   1.9s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eod gap: 0.2714
Epoch 2
 16.61% | time:   2.1s (  0.3m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_t acc: 0.658 (0.649, 0.667) | warm_t eod gap: 0.2609
 19.72% | time:   1.9s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_t acc: 0.651 (0.641, 0.661) | warm_t eod gap: 0.2562
Epoch 3
 23.18% | time:   2.3s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_t acc: 0.648 (0.637, 0.659) | warm_t eod gap: 0.2464
 26.30% | time:   1.6s (  0.4m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_t acc: 0.655 (0.637, 0.673) | warm_t eod gap: 0.2661
Epoch 4
 30.10% | time:   1.8s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_t acc: 0.657 (0.639, 0.675) | warm_t eod gap: 0.2701
 33.22% | time:   1.7s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_t acc: 0.654 (0.637, 0.671) | warm_t eod gap: 0.2696
Epoch 5
 36.68% | time:   2.1s (  0.5m) | step:    106 | train acc: 0.732 | train loss: 0.559 |test acc: 0.655 (0.637, 0.673) | test eod gap: 0.2712
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
calculating influence -- done
 36.68% | time:   4.1s (  0.5m) | step:    106 | train acc: 0.732 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val eod gap: 0.1792
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
278 labeled samples and 4659 unlabeled samples. Total: 4937
Use 278 samples. Get 278 labels. Ratio: 1.0
 39.79% | time:   2.8s (  0.6m) | step:    115 | train acc: 0.734 | train loss: 0.555 |test acc: 0.654 (0.637, 0.671) | test eod gap: 0.2518
begin calculating influence
calculating influence -- done
 39.79% | time:   1.1s (  0.6m) | step:    115 | train acc: 0.734 | train loss: 0.555 |val acc: 0.644 (0.645, 0.642) | val eod gap: 0.2026
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
310 labeled samples and 4627 unlabeled samples. Total: 4937
Use 310 samples. Get 310 labels. Ratio: 1.0
Epoch 6
 43.25% | time:   2.2s (  0.6m) | step:    125 | train acc: 0.685 | train loss: 0.553 |test acc: 0.669 (0.647, 0.691) | test eod gap: 0.2635
begin calculating influence
calculating influence -- done
 43.25% | time:   1.2s (  0.6m) | step:    125 | train acc: 0.685 | train loss: 0.553 |val acc: 0.632 (0.637, 0.626) | val eod gap: 0.1992
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
342 labeled samples and 4595 unlabeled samples. Total: 4937
Use 342 samples. Get 342 labels. Ratio: 1.0
 46.37% | time:   2.3s (  0.7m) | step:    134 | train acc: 0.715 | train loss: 0.558 |test acc: 0.669 (0.645, 0.693) | test eod gap: 0.2511
begin calculating influence
calculating influence -- done
 46.37% | time:   1.3s (  0.7m) | step:    134 | train acc: 0.715 | train loss: 0.558 |val acc: 0.640 (0.653, 0.626) | val eod gap: 0.1658
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
374 labeled samples and 4563 unlabeled samples. Total: 4937
Use 374 samples. Get 374 labels. Ratio: 1.0
Epoch 7
 49.83% | time:   2.2s (  0.7m) | step:    144 | train acc: 0.686 | train loss: 0.599 |test acc: 0.670 (0.647, 0.693) | test eod gap: 0.2571
begin calculating influence
calculating influence -- done
 49.83% | time:   1.2s (  0.8m) | step:    144 | train acc: 0.686 | train loss: 0.599 |val acc: 0.640 (0.653, 0.626) | val eod gap: 0.1820
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
406 labeled samples and 4531 unlabeled samples. Total: 4937
Use 406 samples. Get 406 labels. Ratio: 1.0
 52.94% | time:   2.0s (  0.8m) | step:    153 | train acc: 0.695 | train loss: 0.601 |test acc: 0.663 (0.649, 0.677) | test eod gap: 0.2584
begin calculating influence
calculating influence -- done
 52.94% | time:   1.3s (  0.8m) | step:    153 | train acc: 0.695 | train loss: 0.601 |val acc: 0.640 (0.653, 0.626) | val eod gap: 0.1650
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
438 labeled samples and 4499 unlabeled samples. Total: 4937
Use 438 samples. Get 438 labels. Ratio: 1.0
Epoch 8
 56.75% | time:   2.1s (  0.8m) | step:    164 | train acc: 0.720 | train loss: 0.561 |test acc: 0.669 (0.657, 0.681) | test eod gap: 0.2538
begin calculating influence
calculating influence -- done
 56.75% | time:   1.2s (  0.9m) | step:    164 | train acc: 0.720 | train loss: 0.561 |val acc: 0.648 (0.669, 0.626) | val eod gap: 0.1643
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
470 labeled samples and 4467 unlabeled samples. Total: 4937
Use 470 samples. Get 470 labels. Ratio: 1.0
 59.86% | time:   2.3s (  0.9m) | step:    173 | train acc: 0.727 | train loss: 0.533 |test acc: 0.670 (0.657, 0.683) | test eod gap: 0.2600
begin calculating influence
calculating influence -- done
 59.86% | time:   1.2s (  0.9m) | step:    173 | train acc: 0.727 | train loss: 0.533 |val acc: 0.640 (0.661, 0.618) | val eod gap: 0.1662
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
502 labeled samples and 4435 unlabeled samples. Total: 4937
Use 502 samples. Get 502 labels. Ratio: 1.0
Epoch 9
 63.32% | time:   1.6s (  1.0m) | step:    183 | train acc: 0.715 | train loss: 0.569 |test acc: 0.669 (0.657, 0.681) | test eod gap: 0.2586
begin calculating influence
calculating influence -- done
 63.32% | time:   1.2s (  1.0m) | step:    183 | train acc: 0.715 | train loss: 0.569 |val acc: 0.636 (0.653, 0.618) | val eod gap: 0.1586
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
534 labeled samples and 4403 unlabeled samples. Total: 4937
Use 534 samples. Get 534 labels. Ratio: 1.0
 66.44% | time:   1.1s (  1.0m) | step:    192 | train acc: 0.682 | train loss: 0.583 |test acc: 0.670 (0.655, 0.685) | test eod gap: 0.2615
begin calculating influence
calculating influence -- done
 66.44% | time:   1.2s (  1.0m) | step:    192 | train acc: 0.682 | train loss: 0.583 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.1609
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 566 labels. Ratio: 1.0
Epoch 10
 69.90% | time:   1.4s (  1.0m) | step:    202 | train acc: 0.723 | train loss: 0.552 |test acc: 0.674 (0.655, 0.693) | test eod gap: 0.2433
begin calculating influence
calculating influence -- done
 69.90% | time:   1.2s (  1.1m) | step:    202 | train acc: 0.723 | train loss: 0.552 |val acc: 0.615 (0.629, 0.602) | val eod gap: 0.1717
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
598 labeled samples and 4339 unlabeled samples. Total: 4937
Use 598 samples. Get 598 labels. Ratio: 1.0
 73.01% | time:   1.2s (  1.1m) | step:    211 | train acc: 0.730 | train loss: 0.547 |test acc: 0.678 (0.663, 0.693) | test eod gap: 0.2589
begin calculating influence
calculating influence -- done
 73.01% | time:   1.1s (  1.1m) | step:    211 | train acc: 0.730 | train loss: 0.547 |val acc: 0.632 (0.637, 0.626) | val eod gap: 0.1510
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
630 labeled samples and 4307 unlabeled samples. Total: 4937
Use 630 samples. Get 630 labels. Ratio: 1.0
Epoch 11
 76.82% | time:   1.4s (  1.1m) | step:    222 | train acc: 0.715 | train loss: 0.553 |test acc: 0.676 (0.659, 0.693) | test eod gap: 0.2667
begin calculating influence
calculating influence -- done
 76.82% | time:   1.3s (  1.1m) | step:    222 | train acc: 0.715 | train loss: 0.553 |val acc: 0.632 (0.637, 0.626) | val eod gap: 0.1510
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
662 labeled samples and 4275 unlabeled samples. Total: 4937
Use 662 samples. Get 662 labels. Ratio: 1.0
 79.93% | time:   1.2s (  1.2m) | step:    231 | train acc: 0.723 | train loss: 0.547 |test acc: 0.678 (0.661, 0.695) | test eod gap: 0.2662
begin calculating influence
calculating influence -- done
 79.93% | time:   1.2s (  1.2m) | step:    231 | train acc: 0.723 | train loss: 0.547 |val acc: 0.632 (0.637, 0.626) | val eod gap: 0.1510
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
694 labeled samples and 4243 unlabeled samples. Total: 4937
Use 694 samples. Get 694 labels. Ratio: 1.0
Epoch 12
 83.39% | time:   1.3s (  1.2m) | step:    241 | train acc: 0.734 | train loss: 0.525 |test acc: 0.678 (0.659, 0.697) | test eod gap: 0.2653
begin calculating influence
calculating influence -- done
 83.39% | time:   1.2s (  1.2m) | step:    241 | train acc: 0.734 | train loss: 0.525 |val acc: 0.640 (0.653, 0.626) | val eod gap: 0.1823
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
726 labeled samples and 4211 unlabeled samples. Total: 4937
Use 726 samples. Get 726 labels. Ratio: 1.0
 86.51% | time:   1.2s (  1.2m) | step:    250 | train acc: 0.734 | train loss: 0.559 |test acc: 0.679 (0.663, 0.695) | test eod gap: 0.2518
begin calculating influence
calculating influence -- done
 86.51% | time:   1.2s (  1.3m) | step:    250 | train acc: 0.734 | train loss: 0.559 |val acc: 0.632 (0.645, 0.618) | val eod gap: 0.1680
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
758 labeled samples and 4179 unlabeled samples. Total: 4937
Use 758 samples. Get 758 labels. Ratio: 1.0
Epoch 13
 89.97% | time:   1.2s (  1.3m) | step:    260 | train acc: 0.711 | train loss: 0.579 |test acc: 0.679 (0.663, 0.695) | test eod gap: 0.2523
begin calculating influence
calculating influence -- done
 89.97% | time:   1.3s (  1.3m) | step:    260 | train acc: 0.711 | train loss: 0.579 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.1774
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
790 labeled samples and 4147 unlabeled samples. Total: 4937
Use 790 samples. Get 790 labels. Ratio: 1.0
 93.08% | time:   0.9s (  1.3m) | step:    269 | train acc: 0.742 | train loss: 0.529 |test acc: 0.685 (0.665, 0.705) | test eod gap: 0.2482
begin calculating influence
calculating influence -- done
 93.08% | time:   1.2s (  1.3m) | step:    269 | train acc: 0.742 | train loss: 0.529 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.1771
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
822 labeled samples and 4115 unlabeled samples. Total: 4937
Use 822 samples. Get 822 labels. Ratio: 1.0
Epoch 14
 96.54% | time:   1.0s (  1.4m) | step:    279 | train acc: 0.734 | train loss: 0.528 |test acc: 0.682 (0.659, 0.705) | test eod gap: 0.2589
begin calculating influence
calculating influence -- done
 96.54% | time:   1.1s (  1.4m) | step:    279 | train acc: 0.734 | train loss: 0.528 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.1771
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
854 labeled samples and 4083 unlabeled samples. Total: 4937
Use 854 samples. Get 854 labels. Ratio: 1.0
 99.65% | time:   0.9s (  1.4m) | step:    288 | train acc: 0.719 | train loss: 0.553 |test acc: 0.686 (0.667, 0.705) | test eod gap: 0.2725
begin calculating influence
calculating influence -- done
 99.65% | time:   1.1s (  1.4m) | step:    288 | train acc: 0.719 | train loss: 0.553 |val acc: 0.623 (0.637, 0.610) | val eod gap: 0.2026
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
886 labeled samples and 4051 unlabeled samples. Total: 4937
Use 886 samples. Get 886 labels. Ratio: 1.0
