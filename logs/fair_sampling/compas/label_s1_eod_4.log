2023-02-12 05:48:34.329354: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.329426: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-12 05:48:34.329432: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
246 labeled samples and 4691 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 8]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  3.46% | time:   4.0s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_t acc: 0.585 (0.610, 0.560) | warm_t eod gap: 0.1419
  3.46% | time:   1.3s (  0.1m) | step:     10 | train acc: 0.598 | train loss: 0.671 |warm_v acc: 0.599 (0.573, 0.626) | warm_v eod gap: 0.1013
  6.57% | time:   1.6s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_t acc: 0.675 (0.649, 0.701) | warm_t eod gap: 0.2527
  6.57% | time:   0.2s (  0.1m) | step:     19 | train acc: 0.691 | train loss: 0.599 |warm_v acc: 0.648 (0.637, 0.659) | warm_v eod gap: 0.2270
Epoch 1
 10.03% | time:   2.1s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_t acc: 0.669 (0.657, 0.681) | warm_t eod gap: 0.2699
 10.03% | time:   0.2s (  0.2m) | step:     29 | train acc: 0.707 | train loss: 0.591 |warm_v acc: 0.644 (0.613, 0.675) | warm_v eod gap: 0.2178
 13.15% | time:   1.7s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_t acc: 0.671 (0.657, 0.685) | warm_t eod gap: 0.2714
 13.15% | time:   0.2s (  0.2m) | step:     38 | train acc: 0.707 | train loss: 0.585 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eod gap: 0.2017
Epoch 2
 16.61% | time:   2.2s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_t acc: 0.658 (0.649, 0.667) | warm_t eod gap: 0.2609
 16.61% | time:   0.2s (  0.2m) | step:     48 | train acc: 0.711 | train loss: 0.578 |warm_v acc: 0.644 (0.621, 0.667) | warm_v eod gap: 0.2013
 19.72% | time:   1.8s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_t acc: 0.651 (0.641, 0.661) | warm_t eod gap: 0.2562
 19.72% | time:   0.2s (  0.3m) | step:     57 | train acc: 0.711 | train loss: 0.574 |warm_v acc: 0.640 (0.629, 0.650) | warm_v eod gap: 0.1946
Epoch 3
 23.18% | time:   2.1s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_t acc: 0.648 (0.637, 0.659) | warm_t eod gap: 0.2464
 23.18% | time:   0.2s (  0.3m) | step:     67 | train acc: 0.715 | train loss: 0.570 |warm_v acc: 0.644 (0.637, 0.650) | warm_v eod gap: 0.2022
 26.30% | time:   2.0s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_t acc: 0.655 (0.637, 0.673) | warm_t eod gap: 0.2661
 26.30% | time:   0.2s (  0.3m) | step:     76 | train acc: 0.720 | train loss: 0.567 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eod gap: 0.1878
Epoch 4
 30.10% | time:   2.1s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_t acc: 0.657 (0.639, 0.675) | warm_t eod gap: 0.2701
 30.10% | time:   0.2s (  0.4m) | step:     87 | train acc: 0.724 | train loss: 0.564 |warm_v acc: 0.636 (0.629, 0.642) | warm_v eod gap: 0.1878
 33.22% | time:   1.8s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_t acc: 0.654 (0.637, 0.671) | warm_t eod gap: 0.2696
 33.22% | time:   0.2s (  0.4m) | step:     96 | train acc: 0.724 | train loss: 0.562 |warm_v acc: 0.640 (0.637, 0.642) | warm_v eod gap: 0.1792
Epoch 5
 36.68% | time:   2.4s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |test acc: 0.655 (0.637, 0.673) | test eod gap: 0.2712
 36.68% | time:   0.2s (  0.4m) | step:    106 | train acc: 0.732 | train loss: 0.559 |val acc: 0.640 (0.637, 0.642) | val eod gap: 0.1792
begin calculating influence
selected layers: [Traced<ShapedArray(float32[64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[8,64])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
278 labeled samples and 4659 unlabeled samples. Total: 4937
Use 278 samples. Get 278 labels. Ratio: 1.0
 39.79% | time:   3.5s (  0.5m) | step:    115 | train acc: 0.707 | train loss: 0.567 |test acc: 0.665 (0.645, 0.685) | test eod gap: 0.2731
 39.79% | time:   0.2s (  0.5m) | step:    115 | train acc: 0.707 | train loss: 0.567 |val acc: 0.640 (0.621, 0.659) | val eod gap: 0.1953
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
310 labeled samples and 4627 unlabeled samples. Total: 4937
Use 310 samples. Get 310 labels. Ratio: 1.0
Epoch 6
 43.25% | time:   2.4s (  0.5m) | step:    125 | train acc: 0.759 | train loss: 0.566 |test acc: 0.659 (0.637, 0.681) | test eod gap: 0.2561
 43.25% | time:   0.2s (  0.5m) | step:    125 | train acc: 0.759 | train loss: 0.566 |val acc: 0.644 (0.653, 0.634) | val eod gap: 0.1710
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
342 labeled samples and 4595 unlabeled samples. Total: 4937
Use 342 samples. Get 342 labels. Ratio: 1.0
 46.37% | time:   2.3s (  0.6m) | step:    134 | train acc: 0.754 | train loss: 0.528 |test acc: 0.655 (0.639, 0.671) | test eod gap: 0.2679
 46.37% | time:   0.2s (  0.6m) | step:    134 | train acc: 0.754 | train loss: 0.528 |val acc: 0.644 (0.645, 0.642) | val eod gap: 0.1706
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
374 labeled samples and 4563 unlabeled samples. Total: 4937
Use 374 samples. Get 374 labels. Ratio: 1.0
Epoch 7
 49.83% | time:   2.2s (  0.6m) | step:    144 | train acc: 0.644 | train loss: 0.607 |test acc: 0.663 (0.643, 0.683) | test eod gap: 0.2830
 49.83% | time:   0.2s (  0.6m) | step:    144 | train acc: 0.644 | train loss: 0.607 |val acc: 0.644 (0.637, 0.650) | val eod gap: 0.1875
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
406 labeled samples and 4531 unlabeled samples. Total: 4937
Use 406 samples. Get 406 labels. Ratio: 1.0
 52.94% | time:   2.5s (  0.7m) | step:    153 | train acc: 0.688 | train loss: 0.572 |test acc: 0.664 (0.643, 0.685) | test eod gap: 0.2803
 52.94% | time:   0.2s (  0.7m) | step:    153 | train acc: 0.688 | train loss: 0.572 |val acc: 0.652 (0.629, 0.675) | val eod gap: 0.1844
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
438 labeled samples and 4499 unlabeled samples. Total: 4937
Use 438 samples. Get 438 labels. Ratio: 1.0
Epoch 8
 56.75% | time:   2.5s (  0.7m) | step:    164 | train acc: 0.714 | train loss: 0.544 |test acc: 0.665 (0.643, 0.687) | test eod gap: 0.2819
 56.75% | time:   0.2s (  0.7m) | step:    164 | train acc: 0.714 | train loss: 0.544 |val acc: 0.644 (0.629, 0.659) | val eod gap: 0.1867
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
470 labeled samples and 4467 unlabeled samples. Total: 4937
Use 470 samples. Get 470 labels. Ratio: 1.0
 59.86% | time:   2.4s (  0.8m) | step:    173 | train acc: 0.715 | train loss: 0.540 |test acc: 0.670 (0.647, 0.693) | test eod gap: 0.2913
 59.86% | time:   0.1s (  0.8m) | step:    173 | train acc: 0.715 | train loss: 0.540 |val acc: 0.652 (0.645, 0.659) | val eod gap: 0.1860
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
502 labeled samples and 4435 unlabeled samples. Total: 4937
Use 502 samples. Get 502 labels. Ratio: 1.0
Epoch 9
 63.32% | time:   1.9s (  0.8m) | step:    183 | train acc: 0.687 | train loss: 0.558 |test acc: 0.671 (0.651, 0.691) | test eod gap: 0.2854
 63.32% | time:   0.2s (  0.8m) | step:    183 | train acc: 0.687 | train loss: 0.558 |val acc: 0.648 (0.645, 0.650) | val eod gap: 0.1954
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
534 labeled samples and 4403 unlabeled samples. Total: 4937
Use 534 samples. Get 534 labels. Ratio: 1.0
 66.44% | time:   1.7s (  0.8m) | step:    192 | train acc: 0.636 | train loss: 0.615 |test acc: 0.676 (0.653, 0.699) | test eod gap: 0.2735
 66.44% | time:   0.2s (  0.8m) | step:    192 | train acc: 0.636 | train loss: 0.615 |val acc: 0.644 (0.637, 0.650) | val eod gap: 0.2048
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 566 labels. Ratio: 1.0
Epoch 10
 69.90% | time:   2.0s (  0.9m) | step:    202 | train acc: 0.656 | train loss: 0.584 |test acc: 0.669 (0.645, 0.693) | test eod gap: 0.2763
 69.90% | time:   0.2s (  0.9m) | step:    202 | train acc: 0.656 | train loss: 0.584 |val acc: 0.640 (0.669, 0.610) | val eod gap: 0.1666
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
598 labeled samples and 4339 unlabeled samples. Total: 4937
Use 598 samples. Get 598 labels. Ratio: 1.0
 73.01% | time:   1.7s (  0.9m) | step:    211 | train acc: 0.684 | train loss: 0.553 |test acc: 0.682 (0.657, 0.707) | test eod gap: 0.2727
 73.01% | time:   0.2s (  0.9m) | step:    211 | train acc: 0.684 | train loss: 0.553 |val acc: 0.640 (0.637, 0.642) | val eod gap: 0.2146
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
630 labeled samples and 4307 unlabeled samples. Total: 4937
Use 630 samples. Get 630 labels. Ratio: 1.0
Epoch 11
 76.82% | time:   1.8s (  0.9m) | step:    222 | train acc: 0.648 | train loss: 0.572 |test acc: 0.686 (0.661, 0.711) | test eod gap: 0.2779
 76.82% | time:   0.2s (  0.9m) | step:    222 | train acc: 0.648 | train loss: 0.572 |val acc: 0.628 (0.653, 0.602) | val eod gap: 0.1775
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
662 labeled samples and 4275 unlabeled samples. Total: 4937
Use 662 samples. Get 662 labels. Ratio: 1.0
 79.93% | time:   1.8s (  1.0m) | step:    231 | train acc: 0.656 | train loss: 0.573 |test acc: 0.684 (0.661, 0.707) | test eod gap: 0.2838
 79.93% | time:   0.2s (  1.0m) | step:    231 | train acc: 0.656 | train loss: 0.573 |val acc: 0.632 (0.645, 0.618) | val eod gap: 0.2004
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
694 labeled samples and 4243 unlabeled samples. Total: 4937
Use 694 samples. Get 694 labels. Ratio: 1.0
Epoch 12
 83.39% | time:   1.9s (  1.0m) | step:    241 | train acc: 0.715 | train loss: 0.571 |test acc: 0.686 (0.659, 0.713) | test eod gap: 0.2910
 83.39% | time:   0.2s (  1.0m) | step:    241 | train acc: 0.715 | train loss: 0.571 |val acc: 0.636 (0.637, 0.634) | val eod gap: 0.2071
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
726 labeled samples and 4211 unlabeled samples. Total: 4937
Use 726 samples. Get 726 labels. Ratio: 1.0
 86.51% | time:   1.5s (  1.0m) | step:    250 | train acc: 0.668 | train loss: 0.604 |test acc: 0.682 (0.655, 0.709) | test eod gap: 0.2961
 86.51% | time:   0.2s (  1.0m) | step:    250 | train acc: 0.668 | train loss: 0.604 |val acc: 0.636 (0.637, 0.634) | val eod gap: 0.1905
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
758 labeled samples and 4179 unlabeled samples. Total: 4937
Use 758 samples. Get 758 labels. Ratio: 1.0
Epoch 13
 89.97% | time:   1.7s (  1.1m) | step:    260 | train acc: 0.660 | train loss: 0.603 |test acc: 0.686 (0.663, 0.709) | test eod gap: 0.2876
 89.97% | time:   0.2s (  1.1m) | step:    260 | train acc: 0.660 | train loss: 0.603 |val acc: 0.628 (0.613, 0.642) | val eod gap: 0.1908
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
790 labeled samples and 4147 unlabeled samples. Total: 4937
Use 790 samples. Get 790 labels. Ratio: 1.0
 93.08% | time:   1.4s (  1.1m) | step:    269 | train acc: 0.699 | train loss: 0.558 |test acc: 0.684 (0.661, 0.707) | test eod gap: 0.2930
 93.08% | time:   0.2s (  1.1m) | step:    269 | train acc: 0.699 | train loss: 0.558 |val acc: 0.628 (0.621, 0.634) | val eod gap: 0.2081
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
822 labeled samples and 4115 unlabeled samples. Total: 4937
Use 822 samples. Get 822 labels. Ratio: 1.0
Epoch 14
 96.54% | time:   1.5s (  1.1m) | step:    279 | train acc: 0.668 | train loss: 0.586 |test acc: 0.681 (0.661, 0.701) | test eod gap: 0.2781
 96.54% | time:   0.2s (  1.1m) | step:    279 | train acc: 0.668 | train loss: 0.586 |val acc: 0.619 (0.613, 0.626) | val eod gap: 0.2085
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
854 labeled samples and 4083 unlabeled samples. Total: 4937
Use 854 samples. Get 854 labels. Ratio: 1.0
 99.65% | time:   1.4s (  1.1m) | step:    288 | train acc: 0.680 | train loss: 0.577 |test acc: 0.682 (0.663, 0.701) | test eod gap: 0.2844
 99.65% | time:   0.2s (  1.1m) | step:    288 | train acc: 0.680 | train loss: 0.577 |val acc: 0.636 (0.637, 0.634) | val eod gap: 0.1732
begin calculating influence
calculating influence -- done
dataset construction done. 
Shape of X torch.Size([4937, 8]). 
Shape of Y torch.Size([4937])
886 labeled samples and 4051 unlabeled samples. Total: 4937
Use 886 samples. Get 886 labels. Ratio: 1.0
