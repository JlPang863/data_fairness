2023-02-08 23:09:05.630856: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.630925: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.630931: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.8s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test eod gap: 0.1273
begin calculating influence
selected layers: [Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   3.2s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val eod gap: 0.1871
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   1.8s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test eod gap: 0.1404
begin calculating influence
[Strategy 5] Acc of expected label: 0.61875
calculating influence -- done
  9.90% | time:   1.2s (  0.2m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val eod gap: 0.1248
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   2.2s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test eod gap: 0.1767
begin calculating influence
[Strategy 5] Acc of expected label: 0.6203125
calculating influence -- done
 15.10% | time:   1.1s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.2128
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.5s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test eod gap: 0.2080
begin calculating influence
[Strategy 5] Acc of expected label: 0.6240625
calculating influence -- done
 19.79% | time:   1.0s (  0.3m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val eod gap: 0.1962
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.8s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test eod gap: 0.2200
begin calculating influence
[Strategy 5] Acc of expected label: 0.62625
calculating influence -- done
 25.00% | time:   1.1s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val eod gap: 0.1706
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.4s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test eod gap: 0.2050
begin calculating influence
[Strategy 5] Acc of expected label: 0.6246875
calculating influence -- done
 29.69% | time:   0.9s (  0.4m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val eod gap: 0.1933
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
534 labeled samples and 4403 unlabeled samples. Total: 4937
Use 534 samples. Get 516 labels. Ratio: 1.0348837209302326
Epoch 3
 34.90% | time:   2.3s (  0.4m) | step:     67 | train acc: 0.668 | train loss: 0.624 |test acc: 0.677 (0.669, 0.685) | test eod gap: 0.2300
begin calculating influence
[Strategy 5] Acc of expected label: 0.6615625
calculating influence -- done
 34.90% | time:   1.1s (  0.4m) | step:     67 | train acc: 0.668 | train loss: 0.624 |val acc: 0.628 (0.645, 0.610) | val eod gap: 0.1778
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
 39.58% | time:   1.9s (  0.4m) | step:     76 | train acc: 0.676 | train loss: 0.597 |test acc: 0.616 (0.618, 0.614) | test eod gap: 0.1963
begin calculating influence
[Strategy 5] Acc of expected label: 0.6146875
calculating influence -- done
 39.58% | time:   1.1s (  0.5m) | step:     76 | train acc: 0.676 | train loss: 0.597 |val acc: 0.607 (0.637, 0.577) | val eod gap: 0.1371
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
Epoch 4
 45.31% | time:   1.5s (  0.5m) | step:     87 | train acc: 0.672 | train loss: 0.589 |test acc: 0.624 (0.624, 0.624) | test eod gap: 0.1815
begin calculating influence
[Strategy 5] Acc of expected label: 0.6196875
calculating influence -- done
 45.31% | time:   1.0s (  0.5m) | step:     87 | train acc: 0.672 | train loss: 0.589 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1299
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
 50.00% | time:   1.5s (  0.5m) | step:     96 | train acc: 0.664 | train loss: 0.594 |test acc: 0.635 (0.631, 0.639) | test eod gap: 0.1847
begin calculating influence
[Strategy 5] Acc of expected label: 0.629375
calculating influence -- done
 50.00% | time:   1.2s (  0.5m) | step:     96 | train acc: 0.664 | train loss: 0.594 |val acc: 0.611 (0.645, 0.577) | val eod gap: 0.1794
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
Epoch 5
 55.21% | time:   1.7s (  0.6m) | step:    106 | train acc: 0.656 | train loss: 0.614 |test acc: 0.632 (0.622, 0.641) | test eod gap: 0.1686
begin calculating influence
[Strategy 5] Acc of expected label: 0.6078125
calculating influence -- done
 55.21% | time:   1.2s (  0.6m) | step:    106 | train acc: 0.656 | train loss: 0.614 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1631
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
 59.90% | time:   1.5s (  0.6m) | step:    115 | train acc: 0.684 | train loss: 0.594 |test acc: 0.632 (0.622, 0.641) | test eod gap: 0.1686
begin calculating influence
[Strategy 5] Acc of expected label: 0.6253125
calculating influence -- done
 59.90% | time:   1.1s (  0.6m) | step:    115 | train acc: 0.684 | train loss: 0.594 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1631
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 516 labels. Ratio: 1.0968992248062015
Epoch 6
 65.10% | time:   1.7s (  0.7m) | step:    125 | train acc: 0.734 | train loss: 0.570 |test acc: 0.632 (0.624, 0.639) | test eod gap: 0.1652
begin calculating influence
[Strategy 5] Acc of expected label: 0.6090625
calculating influence -- done
 65.10% | time:   1.1s (  0.7m) | step:    125 | train acc: 0.734 | train loss: 0.570 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1631
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
569 labeled samples and 4368 unlabeled samples. Total: 4937
Use 569 samples. Get 526 labels. Ratio: 1.0817490494296578
 69.79% | time:   2.1s (  0.7m) | step:    134 | train acc: 0.680 | train loss: 0.576 |test acc: 0.613 (0.622, 0.604) | test eod gap: 0.1584
begin calculating influence
[Strategy 5] Acc of expected label: 0.6071875
calculating influence -- done
 69.79% | time:   1.0s (  0.7m) | step:    134 | train acc: 0.680 | train loss: 0.576 |val acc: 0.591 (0.629, 0.553) | val eod gap: 0.1081
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
569 labeled samples and 4368 unlabeled samples. Total: 4937
Use 569 samples. Get 526 labels. Ratio: 1.0817490494296578
Epoch 7
 75.00% | time:   1.7s (  0.8m) | step:    144 | train acc: 0.691 | train loss: 0.600 |test acc: 0.632 (0.624, 0.639) | test eod gap: 0.1652
begin calculating influence
[Strategy 5] Acc of expected label: 0.615625
calculating influence -- done
 75.00% | time:   0.9s (  0.8m) | step:    144 | train acc: 0.691 | train loss: 0.600 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1631
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
569 labeled samples and 4368 unlabeled samples. Total: 4937
Use 569 samples. Get 526 labels. Ratio: 1.0817490494296578
 79.69% | time:   1.5s (  0.8m) | step:    153 | train acc: 0.715 | train loss: 0.566 |test acc: 0.632 (0.627, 0.637) | test eod gap: 0.1660
begin calculating influence
[Strategy 5] Acc of expected label: 0.6171875
calculating influence -- done
 79.69% | time:   1.0s (  0.8m) | step:    153 | train acc: 0.715 | train loss: 0.566 |val acc: 0.607 (0.629, 0.585) | val eod gap: 0.1702
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 533 labels. Ratio: 1.0712945590994372
Epoch 8
 85.42% | time:   2.4s (  0.9m) | step:    164 | train acc: 0.688 | train loss: 0.601 |test acc: 0.629 (0.624, 0.633) | test eod gap: 0.1517
begin calculating influence
[Strategy 5] Acc of expected label: 0.6165625
calculating influence -- done
 85.42% | time:   1.0s (  0.9m) | step:    164 | train acc: 0.688 | train loss: 0.601 |val acc: 0.599 (0.621, 0.577) | val eod gap: 0.1717
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 533 labels. Ratio: 1.0712945590994372
 90.10% | time:   1.2s (  0.9m) | step:    173 | train acc: 0.707 | train loss: 0.580 |test acc: 0.632 (0.624, 0.639) | test eod gap: 0.1652
begin calculating influence
[Strategy 5] Acc of expected label: 0.6065625
calculating influence -- done
 90.10% | time:   0.8s (  0.9m) | step:    173 | train acc: 0.707 | train loss: 0.580 |val acc: 0.603 (0.629, 0.577) | val eod gap: 0.1631
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 533 labels. Ratio: 1.0712945590994372
Epoch 9
 95.31% | time:   1.4s (  0.9m) | step:    183 | train acc: 0.723 | train loss: 0.582 |test acc: 0.631 (0.627, 0.635) | test eod gap: 0.1688
begin calculating influence
[Strategy 5] Acc of expected label: 0.6203125
calculating influence -- done
 95.31% | time:   0.9s (  1.0m) | step:    183 | train acc: 0.723 | train loss: 0.582 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1616
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
573 labeled samples and 4364 unlabeled samples. Total: 4937
Use 573 samples. Get 535 labels. Ratio: 1.0710280373831775
100.00% | time:   1.5s (  1.0m) | step:    192 | train acc: 0.691 | train loss: 0.614 |test acc: 0.630 (0.627, 0.633) | test eod gap: 0.1715
begin calculating influence
[Strategy 5] Acc of expected label: 0.62
calculating influence -- done
100.00% | time:   0.7s (  1.0m) | step:    192 | train acc: 0.691 | train loss: 0.614 |val acc: 0.611 (0.637, 0.585) | val eod gap: 0.1616
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
573 labeled samples and 4364 unlabeled samples. Total: 4937
Use 573 samples. Get 536 labels. Ratio: 1.0690298507462686
