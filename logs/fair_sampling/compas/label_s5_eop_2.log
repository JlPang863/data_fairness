2023-02-08 23:09:05.518830: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.518906: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-08 23:09:05.518912: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
493 labeled samples and 4444 unlabeled samples. Total: 4937
dataset construction done. 
Shape of X torch.Size([1235, 6]). 
Shape of Y torch.Size([1235])
247 labeled samples and 988 unlabeled samples. Total: 1235
Numer of layers 4
train net...
train with 4937 samples (with replacement) in one epoch
Epoch 0
  5.21% | time:   3.7s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |test acc: 0.642 (0.606, 0.677) | test eop gap: 0.1095
begin calculating influence
selected layers: [Traced<ShapedArray(float32[2])>with<DynamicJaxprTrace(level=0/1)>, Traced<ShapedArray(float32[64,2])>with<DynamicJaxprTrace(level=0/1)>]
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
  5.21% | time:   2.7s (  0.1m) | step:     10 | train acc: 0.595 | train loss: 0.670 |val acc: 0.571 (0.548, 0.593) | val eop gap: 0.1718
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
  9.90% | time:   1.7s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |test acc: 0.612 (0.586, 0.639) | test eop gap: 0.0700
begin calculating influence
[Strategy 5] Acc of expected label: 0.61875
calculating influence -- done
  9.90% | time:   0.7s (  0.1m) | step:     19 | train acc: 0.538 | train loss: 0.809 |val acc: 0.583 (0.581, 0.585) | val eop gap: 0.1121
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 1
 15.10% | time:   1.8s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |test acc: 0.623 (0.616, 0.631) | test eop gap: 0.1469
begin calculating influence
[Strategy 5] Acc of expected label: 0.6203125
calculating influence -- done
 15.10% | time:   0.8s (  0.2m) | step:     29 | train acc: 0.676 | train loss: 0.608 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2596
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 19.79% | time:   1.3s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |test acc: 0.627 (0.620, 0.633) | test eop gap: 0.1862
begin calculating influence
[Strategy 5] Acc of expected label: 0.6240625
calculating influence -- done
 19.79% | time:   1.0s (  0.2m) | step:     38 | train acc: 0.660 | train loss: 0.615 |val acc: 0.603 (0.621, 0.585) | val eop gap: 0.2293
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
Epoch 2
 25.00% | time:   1.5s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |test acc: 0.619 (0.624, 0.614) | test eop gap: 0.2034
begin calculating influence
[Strategy 5] Acc of expected label: 0.62625
calculating influence -- done
 25.00% | time:   0.8s (  0.3m) | step:     48 | train acc: 0.656 | train loss: 0.612 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.2181
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
525 labeled samples and 4412 unlabeled samples. Total: 4937
Use 525 samples. Get 493 labels. Ratio: 1.0649087221095335
 29.69% | time:   1.2s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |test acc: 0.632 (0.631, 0.633) | test eop gap: 0.1909
begin calculating influence
[Strategy 5] Acc of expected label: 0.6246875
calculating influence -- done
 29.69% | time:   0.9s (  0.3m) | step:     57 | train acc: 0.680 | train loss: 0.599 |val acc: 0.619 (0.645, 0.593) | val eop gap: 0.2407
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
534 labeled samples and 4403 unlabeled samples. Total: 4937
Use 534 samples. Get 515 labels. Ratio: 1.036893203883495
Epoch 3
 34.90% | time:   2.2s (  0.3m) | step:     67 | train acc: 0.668 | train loss: 0.624 |test acc: 0.677 (0.669, 0.685) | test eop gap: 0.2585
begin calculating influence
[Strategy 5] Acc of expected label: 0.6615625
calculating influence -- done
 34.90% | time:   0.7s (  0.3m) | step:     67 | train acc: 0.668 | train loss: 0.624 |val acc: 0.628 (0.645, 0.610) | val eop gap: 0.2364
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
 39.58% | time:   1.8s (  0.4m) | step:     76 | train acc: 0.676 | train loss: 0.597 |test acc: 0.616 (0.618, 0.614) | test eop gap: 0.1665
begin calculating influence
[Strategy 5] Acc of expected label: 0.6178125
calculating influence -- done
 39.58% | time:   1.0s (  0.4m) | step:     76 | train acc: 0.676 | train loss: 0.597 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.1767
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
Epoch 4
 45.31% | time:   1.2s (  0.4m) | step:     87 | train acc: 0.672 | train loss: 0.589 |test acc: 0.624 (0.624, 0.624) | test eop gap: 0.1508
begin calculating influence
[Strategy 5] Acc of expected label: 0.6140625
calculating influence -- done
 45.31% | time:   1.0s (  0.4m) | step:     87 | train acc: 0.672 | train loss: 0.589 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.1652
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
 50.00% | time:   1.0s (  0.4m) | step:     96 | train acc: 0.664 | train loss: 0.594 |test acc: 0.635 (0.631, 0.639) | test eop gap: 0.1642
begin calculating influence
[Strategy 5] Acc of expected label: 0.630625
calculating influence -- done
 50.00% | time:   0.9s (  0.5m) | step:     96 | train acc: 0.664 | train loss: 0.594 |val acc: 0.611 (0.645, 0.577) | val eop gap: 0.2444
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
Epoch 5
 55.21% | time:   1.4s (  0.5m) | step:    106 | train acc: 0.656 | train loss: 0.614 |test acc: 0.632 (0.622, 0.641) | test eop gap: 0.1296
begin calculating influence
[Strategy 5] Acc of expected label: 0.6225
calculating influence -- done
 55.21% | time:   0.9s (  0.5m) | step:    106 | train acc: 0.656 | train loss: 0.614 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
 59.90% | time:   1.5s (  0.5m) | step:    115 | train acc: 0.684 | train loss: 0.594 |test acc: 0.632 (0.622, 0.641) | test eop gap: 0.1296
begin calculating influence
[Strategy 5] Acc of expected label: 0.6165625
calculating influence -- done
 59.90% | time:   1.0s (  0.5m) | step:    115 | train acc: 0.684 | train loss: 0.594 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
566 labeled samples and 4371 unlabeled samples. Total: 4937
Use 566 samples. Get 515 labels. Ratio: 1.0990291262135923
Epoch 6
 65.10% | time:   1.3s (  0.6m) | step:    125 | train acc: 0.734 | train loss: 0.570 |test acc: 0.632 (0.624, 0.639) | test eop gap: 0.1312
begin calculating influence
[Strategy 5] Acc of expected label: 0.610625
calculating influence -- done
 65.10% | time:   1.1s (  0.6m) | step:    125 | train acc: 0.734 | train loss: 0.570 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
567 labeled samples and 4370 unlabeled samples. Total: 4937
Use 567 samples. Get 518 labels. Ratio: 1.0945945945945945
 69.79% | time:   1.7s (  0.6m) | step:    134 | train acc: 0.711 | train loss: 0.601 |test acc: 0.631 (0.624, 0.637) | test eop gap: 0.1367
begin calculating influence
[Strategy 5] Acc of expected label: 0.6203125
calculating influence -- done
 69.79% | time:   0.9s (  0.6m) | step:    134 | train acc: 0.711 | train loss: 0.601 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
568 labeled samples and 4369 unlabeled samples. Total: 4937
Use 568 samples. Get 520 labels. Ratio: 1.0923076923076922
Epoch 7
 75.00% | time:   1.9s (  0.7m) | step:    144 | train acc: 0.684 | train loss: 0.613 |test acc: 0.630 (0.627, 0.633) | test eop gap: 0.1493
begin calculating influence
[Strategy 5] Acc of expected label: 0.6190625
calculating influence -- done
 75.00% | time:   0.7s (  0.7m) | step:    144 | train acc: 0.684 | train loss: 0.613 |val acc: 0.611 (0.637, 0.585) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
570 labeled samples and 4367 unlabeled samples. Total: 4937
Use 570 samples. Get 529 labels. Ratio: 1.0775047258979207
 79.69% | time:   1.8s (  0.7m) | step:    153 | train acc: 0.723 | train loss: 0.575 |test acc: 0.631 (0.624, 0.637) | test eop gap: 0.1367
begin calculating influence
[Strategy 5] Acc of expected label: 0.624375
calculating influence -- done
 79.69% | time:   0.8s (  0.7m) | step:    153 | train acc: 0.723 | train loss: 0.575 |val acc: 0.607 (0.637, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
570 labeled samples and 4367 unlabeled samples. Total: 4937
Use 570 samples. Get 529 labels. Ratio: 1.0775047258979207
Epoch 8
 85.42% | time:   1.4s (  0.7m) | step:    164 | train acc: 0.711 | train loss: 0.594 |test acc: 0.631 (0.627, 0.635) | test eop gap: 0.1438
begin calculating influence
[Strategy 5] Acc of expected label: 0.6165625
calculating influence -- done
 85.42% | time:   0.8s (  0.7m) | step:    164 | train acc: 0.711 | train loss: 0.594 |val acc: 0.611 (0.637, 0.585) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
571 labeled samples and 4366 unlabeled samples. Total: 4937
Use 571 samples. Get 530 labels. Ratio: 1.0773584905660378
 90.10% | time:   1.8s (  0.8m) | step:    173 | train acc: 0.723 | train loss: 0.581 |test acc: 0.623 (0.618, 0.629) | test eop gap: 0.1462
begin calculating influence
[Strategy 5] Acc of expected label: 0.6090625
calculating influence -- done
 90.10% | time:   1.0s (  0.8m) | step:    173 | train acc: 0.723 | train loss: 0.581 |val acc: 0.615 (0.637, 0.593) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
573 labeled samples and 4364 unlabeled samples. Total: 4937
Use 573 samples. Get 532 labels. Ratio: 1.0770676691729324
Epoch 9
 95.31% | time:   1.8s (  0.8m) | step:    183 | train acc: 0.680 | train loss: 0.621 |test acc: 0.628 (0.624, 0.631) | test eop gap: 0.1257
begin calculating influence
[Strategy 5] Acc of expected label: 0.6184375
calculating influence -- done
 95.31% | time:   0.8s (  0.8m) | step:    183 | train acc: 0.680 | train loss: 0.621 |val acc: 0.603 (0.629, 0.577) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
573 labeled samples and 4364 unlabeled samples. Total: 4937
Use 573 samples. Get 532 labels. Ratio: 1.0770676691729324
100.00% | time:   1.2s (  0.9m) | step:    192 | train acc: 0.684 | train loss: 0.614 |test acc: 0.630 (0.627, 0.633) | test eop gap: 0.1493
begin calculating influence
[Strategy 5] Acc of expected label: 0.6190625
calculating influence -- done
100.00% | time:   0.9s (  0.9m) | step:    192 | train acc: 0.684 | train loss: 0.614 |val acc: 0.611 (0.637, 0.585) | val eop gap: 0.2030
dataset construction done. 
Shape of X torch.Size([4937, 6]). 
Shape of Y torch.Size([4937])
573 labeled samples and 4364 unlabeled samples. Total: 4937
Use 573 samples. Get 533 labels. Ratio: 1.075046904315197
